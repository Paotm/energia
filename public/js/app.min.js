'use strict';

//  Variables Globales
var scaleColorLink = d3.scaleOrdinal().range(['#ffbb42', '#f1854b', '#808080', '#f2385a']).domain('Energías Primarias', 'Energías Secundarias', 'Centros de Transformación', 'Consumo');
var fontScale = d3.scaleLinear().range([8, 16]);

//  Funciones
// const formatoNumero = (d) => {
//   let format = d3.format(',.0f');
//
//   return `${ format(d) } Twh`;
// };

/* Resta el porcentaje indicado a un color (RR, GG o BB) hexadecimal para oscurecerlo */
var subtractLight = function subtractLight(color, amount) {
  var cc = parseInt(color, 16) - amount;
  var c = cc < 0 ? 0 : cc;
  c = c.toString(16).length > 1 ? c.toString(16) : '0' + c.toString(16);

  return c;
};

/* Oscurece un color hexadecimal de 6 caracteres #RRGGBB segun el porcentaje indicado */
var darken = function darken(color, amount) {
  color = color.indexOf('#') >= 0 ? color.substring(1, color.length) : color;
  amount = parseInt(255 * amount / 100);
  color = '#' + subtractLight(color.substring(0, 2), amount) + subtractLight(color.substring(2, 4), amount) + subtractLight(color.substring(4, 6), amount);

  return color;
};

$(function () {

  var height = $('#content').height(),
      width = $('#content').width() - $('#placa').width(),

  // clavesNodos = [],
  // dataSankey  = {},
  // moveId = 0,
  nodesOri = void 0,
      linksOri = void 0,
      nodesGlo = void 0,
      linksGlo = void 0,
      sankeyChartD3 = void 0,
      path = void 0,
      svg = void 0;

  //  Funciones
  // const generarPuertas    = () => {
  //   dataSankey.nodes.filter((element) => (element.parent === false)).forEach((v, k) => {
  //     clavesNodos.push({ 'id': v.id, 'state': true });
  //   });
  // };
  var createGrafico = function createGrafico(data, container) {
    // Variables
    var margin = { top: 0, right: 0, bottom: 0, left: 0 };
    var size = { width: 300 - margin.left - margin.right, height: 50 - margin.top - margin.bottom };
    var years = ['2012', '2013', '2014', '2015', '2016', '2017'];
    var newData = [];

    data.forEach(function (v, k) {
      newData.push({ date: new Date(years[k]), value: v });
    });

    var svgGrafico = container.html('').append('svg').attr('width', size.width + margin.left + margin.right).attr('height', size.height + margin.top + margin.bottom).append('g').attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');

    // let parseTime = d3.timeParse('%d-%b-%y');

    var x = d3.scaleTime().domain(d3.extent(newData, function (d) {
      return d.date;
    })).rangeRound([0, size.width]);
    var y = d3.scaleLinear().domain(d3.extent(newData, function (d) {
      return d.value;
    })).rangeRound([size.height, 0]);

    var line = d3.line().x(function (d) {
      return x(d.date);
    }).y(function (d) {
      return y(d.value);
    });

    svgGrafico.append('g').call(d3.axisBottom(x)).style('transform', 'translate(0px, ' + (size.height - 1) + 'px)');

    svgGrafico.append('g').call(d3.axisLeft(y));
    // .append('text')
    //   .attr('fill', '#000')
    //   .attr('transform', 'rotate(-90)')
    //   .attr('y', 6)
    //   .attr('dy', '0.71em')
    //   .attr('text-anchor', 'end')
    //   .text('Price ($)');

    svgGrafico.append('path').datum(newData).attr('fill', 'none').attr('stroke', 'steelblue').attr('stroke-linejoin', 'round').attr('stroke-linecap', 'round').attr('stroke-width', 1.5).attr('d', line);
  };
  var updatePlaca = function updatePlaca(element) {
    var contenedor = d3.select('#placa');
    contenedor.select('.placa_titulo').style('text-transform', 'uppercase').text(element.name);
    contenedor.select('.placa_prod').text(element.value);
    contenedor.select('.placa_imp').text(element.value * 0.2);
    contenedor.select('.placa_exp').text(element.value * 0.1);
    contenedor.select('.placa_lost').text(element.value * 0.05);
    contenedor.select('.placa_efi').text((element.value - element.value * 0.05) * 100 / element.value);
    contenedor.select('.placa_more').text(element.value * 0.01);

    createGrafico(element.prod, contenedor.select('.placa_grafico.grafico_prod'));
    createGrafico(element.imp, contenedor.select('.placa_grafico.grafico_imp'));
    createGrafico(element.exp, contenedor.select('.placa_grafico.grafico_exp'));
  };

  var fadeIn = function fadeIn(opacity) {
    return function (g, i) {
      updatePlaca(g);

      var id_nodes = [],
          links = void 0,
          linksFilter = void 0,
          nodes = void 0,
          nodesFilter = void 0;

      // add event node
      id_nodes.push(g.id);
      // add sourceLinks
      g.sourceLinks.forEach(function (link) {
        id_nodes.push(link.target.id);
      });
      // add targetLinks
      g.targetLinks.forEach(function (link) {
        id_nodes.push(link.source.id);
      });

      // select links
      links = d3.selectAll('#sankey .link');
      //  links focusIn
      // d3.selectAll('#sankey .link')
      //   .filter((d) => (d.source.id === g.id || d.target.id === g.id))
      //   .transition().style('stroke-opacity', .75);
      // links focusOut
      linksFilter = links.filter(function (d) {
        return d.source.id !== g.id && d.target.id !== g.id;
      });
      linksFilter.transition().style('stroke-opacity', opacity);

      //  select nodes
      nodes = d3.selectAll('#sankey .node');
      // nodes focusIn
      nodesFilter = nodes.filter(function (d) {
        var statusNode = false;

        id_nodes.forEach(function (element) {
          if (element === d.id) {
            statusNode = true;
          }
        });

        return statusNode;
      });
      nodesFilter.select('rect').transition().style('fill', function (d) {
        return darken(scaleColorLink(d.category), 20);
      });
      nodesFilter.select('text').transition().attr('text-anchor', 'middle').attr('y', -10).attr('x', function (d) {
        return d.dx / 2;
      }).text(function (d) {
        return d.name;
      });
      // nodes focusOut
      nodesFilter = nodes.filter(function (d) {
        var statusNode = true;

        id_nodes.forEach(function (element) {
          if (element === d.id) {
            statusNode = false;
          }
        });

        return statusNode;
      });
      nodesFilter.transition().style('opacity', opacity);
    };
  };
  var fadeOut = function fadeOut(opacity) {
    return function (g, i) {

      var id_nodes = [],
          links = void 0,
          linksFilter = void 0,
          nodes = void 0,
          nodesFilter = void 0;

      // add event node
      id_nodes.push(g.id);
      // add sourceLinks
      g.sourceLinks.forEach(function (link) {
        id_nodes.push(link.target.id);
      });
      // add targetLinks
      g.targetLinks.forEach(function (link) {
        id_nodes.push(link.source.id);
      });

      // select links
      links = d3.selectAll('#sankey .link');
      //  links focusIn
      // d3.selectAll('#sankey .link')
      //   .filter((d) => (d.source.id === g.id || d.target.id === g.id))
      //   .transition().style('stroke-opacity', .75);
      // links focusOut
      linksFilter = links.filter(function (d) {
        return d.source.id !== g.id && d.target.id !== g.id;
      });
      linksFilter.transition().style('stroke-opacity', 0.75);

      //  select nodes
      nodes = d3.selectAll('#sankey .node');
      // nodes focusIn
      nodesFilter = nodes.filter(function (d) {
        var statusNode = false;

        id_nodes.forEach(function (element) {
          if (element === d.id) {
            statusNode = true;
          }
        });

        return statusNode;
      });
      nodesFilter.select('rect').transition().style('fill', function (d) {
        return scaleColorLink(d.category);
      });
      nodesFilter.select('text').transition().attr('text-anchor', 'end').attr('y', function (d) {
        return d.dy / 2;
      }).attr('x', -10).text(function (d) {
        return d.name.length > 8 ? d.name.substring(0, 5) + '...' : d.name;
      }).filter(function (d) {
        return d.x < width / 2;
      }).attr('x', 10 + sankeyChartD3.nodeWidth()).attr('text-anchor', 'start');
      // nodes focusOut
      nodesFilter = nodes.filter(function (d) {
        var statusNode = true;

        id_nodes.forEach(function (element) {
          if (element === d.id) {
            statusNode = false;
          }
        });

        return statusNode;
      });
      nodesFilter.transition().style('opacity', 1);
    };
  };
  // const colapsarExpandirNodo = (nodo) => {
  //
  //   nodesOri[nodo.id].group = (nodesOri[nodo.id].group) ? (false) : (true);
  //
  //   return nodesOri;
  //
  //
  //   // let oldLinks = dataSankey.links;
  //
  //   // if (nodo.parent === false) {
  //   //   console.log('Se expande nodo');
  //   //   clavesNodos.forEach((element) => { if (element.id === nodo.id + moveId) { element.state = false; } });
  //   //
  //   //   dataSankey.nodes = nodosOriginales;
  //   //   dataSankey.links = linksOriginales;
  //   //
  //   //   dataSankey.links = declareGroupLinks(dataSankey.links, true);
  //   //
  //   //   dataSankey = buscarNodes(dataSankey.nodes, dataSankey.links);
  //   //   moveId = 0;
  //   //   $('#sankey').empty();
  //   //   dibujarSankey(width, height, dataSankey);
  //   //   // actualizarSankey($('#content').width(), $('#content').height(), dataSankey, oldLinks);
  //   // } else {
  //   //   console.log('Se colapsa nodo');
  //   //   // let parent = dataSankey.nodes.filter((element) => (element.name === nodo.parent))[0];
  //   //   // clavesNodos.filter((element) => (element.id === parent.id))[0].state = true;
  //   //   //
  //   //   // dataSankey = buscarNodes(nodosOriginales, dataSankey.links = declareGroupLinks(linksOriginales));
  //   //   //
  //   //   // $('#sankey').empty();
  //   //   // dibujarSankey(width, height, dataSankey);
  //   //   // actualizarSankey($('#content').width(), $('#content').height(), dataSankey, oldLinks);
  //   // }
  // };
  var createBackButton = function createBackButton(node) {
    console.log(node);
    var button = d3.select('#placa .agrup').append('div').attr('id', function () {
      return 'node_' + node.id;
    }).attr('class', 'backButton').on('click', function (event) {
      if (nodesOri[node.id].group) {
        nodesOri[node.id].group = false;
      } else {
        nodesOri[node.id].group = true;
      }

      $('#node_' + node.id).remove();

      preSankey();
    });

    button.append('span').attr('class', 'backButton_text').text(node.name);
    button.append('span').append('i').attr('class', 'fa fa-times').attr('aria-hidden', 'true').style('margin-left', '10px');
  };
  var dibujarSankey = function dibujarSankey(width, heigth, data) {

    // Variables
    var margin = { top: 50, right: 50, bottom: 50, left: 50 };
    var size = { width: width - margin.left - margin.right, height: heigth - margin.top - margin.bottom };

    $('#sankey').empty();

    // Creación SVG
    svg = d3.select('#sankey').append('svg').attr('width', size.width + margin.left + margin.right).attr('height', size.height + margin.top + margin.bottom).append('g').attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');

    // Creación Sankey
    sankeyChartD3 = d3.sankey().nodeWidth(20) // Ancho nodo
    .size([size.width, size.height]).nodes(data.nodes).links(data.links).layout();

    // Creación de Links
    path = sankeyChartD3.link();

    fontScale.domain(d3.extent(data.nodes, function (d) {
      return d.value;
    }));

    //  Se crean links
    var link = svg.append('g').attr('id', 'links').selectAll('.link').data(data.links).enter().append('path').attr('class', 'link').attr('d', path).style('stroke-width', function (d) {
      return Math.max(1, d.dy);
    }).style('stroke', 'silver').style('stroke-opacity', 0.75).on('mouseover', function (d) {
      d3.select(d3.event.target).style('stroke-opacity', 1);
    }).on('mouseout', function (d) {
      d3.select(d3.event.target).style('stroke-opacity', 0.75);
    }).sort(function (a, b) {
      return b.dy - a.dy;
    });

    link.filter(function (element) {
      return element.target.name === 'EXPORTACIONES' || element.target.name === 'CONSUMO PROPIO' || element.target.name === 'TRANSPORTE' || element.target.name === 'PERDIDA';
    }).style('stroke', '#BA3F1D');
    link.filter(function (element) {
      return element.source.name === 'IMPORTACIONES';
    }).style('stroke', 'green');

    // Se crean nodos
    var node = svg.append('g').attr('id', 'nodes').selectAll('.node').data(data.nodes.filter(function (element) {
      return element.sourceLinks.length !== 0 || element.targetLinks.length !== 0;
    })).enter().append('g').attr('id', function (d) {
      return d.id;
    }).attr('class', 'node').attr('transform', function (d) {
      return 'translate(' + d.x + ', ' + d.y + ')';
    }).call(d3.drag().on('drag', dragmove));
    // Se crean rectangulos nodos
    node.append('rect').attr('width', sankeyChartD3.nodeWidth()).attr('height', function (d) {
      return Math.max(10, d.dy);
    }).style('fill', function (d) {
      return scaleColorLink(d.category);
    }).on('mouseover', fadeIn(0.025)).on('mouseout', fadeOut()).on('dblclick', function (e) {

      if (nodesOri[e.id].group) {
        nodesOri[e.id].group = false;
      } else {
        nodesOri[e.id].group = true;
      }
      createBackButton(e);
      preSankey();
    });

    // Se crean textos nodos
    node.append('text').attr('x', -10).attr('text-anchor', 'end').attr('y', function (d) {
      return d.dy / 2;
    }).attr('dy', '.35em').style('fill', function (d) {
      return scaleColorLink(d.category);
    })
    // .style('font-size', '8px')
    .style('font-size', function (d) {
      return Math.floor(fontScale(d.value)) + 'px';
    })
    // .text((d) => (d.name))
    .text(function (d) {
      return d.name.length > 8 ? d.name.substring(0, 5) + '...' : d.name;
    }).filter(function (d) {
      return d.x < width / 2;
    }).attr('x', 10 + sankeyChartD3.nodeWidth()).attr('text-anchor', 'start');
    // Se agrega texto referencia hover link
    link.append('title').text(function (d) {
      return d.source.name + ' (' + d.source.id + ') \u2192 ' + d.target.name + ' (' + d.target.id + ') \u2192 ' + d.value;
    });
    // Se agrega texto referencia hover node
    node.append('title').text(function (d) {
      return d.name + ' (' + d.id + ')';
    });

    // the function for moving the nodes
    function dragmove(d) {
      d3.select(this).attr('transform', 'translate(' + (d.x = Math.max(0, Math.min(size.width - d.dx, d3.event.x))) + ', ' + (d.y = Math.max(0, Math.min(size.height - d.dy, d3.event.y))) + ')');
      sankeyChartD3.relayout();
      link.attr('d', path);
    }
  };

  var actualizarSankey = function actualizarSankey(width, heigth, data, oldLinks) {
    var linksDiff = function linksDiff(links_old, links_new) {
      console.log(links_old);
      console.log(links_new);
      var links = [],
          source = void 0,
          target = void 0;

      links_new.forEach(function (v, k) {
        source = v.source;
        target = v.target;

        links_old.forEach(function (v, k) {
          if (source !== v.source.id || target !== v.target.id) {
            links.push(v);
          }
        });
      });

      return links;
    };

    // let newNodes = nodesDiff(data, sankeyData);
    // let newLinks = linksDiff(oldLinks, data.links);

    // Parametros
    var margin = {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
    var size = {
      width: width - margin.left - margin.right,
      height: heigth - margin.top - margin.bottom
    };

    // Creación Sankey
    sankeyChartD3 = d3.sankey().nodeWidth(20) // Ancho nodo
    .size([size.width, size.height]).nodes(data.nodes).links(data.links).layout(32);

    sankeyChartD3.relayout();

    // Creación de Links
    path = sankeyChartD3.link();
    $('#links').empty();

    var links = d3.select('#links').selectAll('.link').data(data.links).enter();

    links.append('path').attr('class', 'link').attr('d', function (d) {
      return path(d);
    }).style('stroke-width', function (d) {
      return d.dy;
    }).style('stroke', 'gray').on('mouseover', function (d) {
      // console.log(d3.event);
      d3.select(d3.event.target).style('stroke', 'red');
    }).on('mouseout', function (d) {
      d3.select(d3.event.target).style('stroke', 'gray');
    });

    // d3.selectAll('.link')
    //   .data(data.links)
    //   .attr('d', (d) => path(d));
    d3.selectAll('.node').data(data.nodes)
    // .transition()
    .attr('transform', function (d) {
      return 'translate(' + d.x + ', ' + d.y + ')';
    });
    d3.selectAll('rect').data(data.nodes).style('opacity', 0).attr('width', sankeyChartD3.nodeWidth()).attr('height', function (d) {
      return d.dy;
    }).transition().style('opacity', 1);

    // Create Diference
    // newLinks.forEach((v, k) => {
    //   let link = d3.select('#links')
    //     .append('path')
    //       .attr('class', 'link')
    //       .attr('d', () => path(v))
    //       .style('stroke-width', () => Math.max(1, v.dy))
    //       .style('stroke', () => scaleColor(v.source.name.replace(' ', '')))
    //       .sort((a, b) => (b.dy - a.dy));
    //
    //   link.append('title').text(() => `${ v.source.name } → ${ v.target.name } \n ${ formatoNumero(v.value) }`);
    // });
  };
  var maxParent = function maxParent(nodo) {
    // console.log(nodo);
    var parentNode = nodesGlo.filter(function (element) {
      return element.id === nodo.parent;
    })[0];

    if (nodo.parent !== false) {
      if (typeof parentNode !== 'undefined' && parentNode.group === true) {
        return maxParent(nodesGlo.filter(function (element) {
          return element.id === nodo.parent;
        })[0]);
      } else {
        return nodo;
      }
    } else {
      return nodo;
    }
  };
  var deleteEmptyNodes = function deleteEmptyNodes() {
    var del = 0,
        nodesDelete = [],
        status = void 0;

    // moveId = 0;

    nodesGlo.forEach(function (node, nodeI) {
      // console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')');
      status = false;

      // Consulto si el nodo se utiliza en algun link
      linksGlo.forEach(function (link, linkI) {
        if (node.id === link.source) {
          status = true;
          link.source = link.source - del;
        }
        if (node.id === link.target) {
          status = true;
          link.target = link.target - del;
        }
      });

      // // Modificar el ID restando la cantidad de elementos borrados
      // node.id = node.id - del;

      if (!status) {
        // console.log('Borrar');
        nodesDelete.push(nodeI);
        del++;
      }
      // else {
      //   // console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')<-');
      // }
    });

    nodesDelete.reverse().forEach(function (node) {
      nodesGlo.splice(node, 1);
    });

    // moveId = del;
    // nodes.forEach((node, nodeI) => {
    //   console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')');
    // });

    // console.log(links);
    return nodesGlo;
  };

  var declareGroupLinks = function declareGroupLinks() {
    var desarrollo = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

    var links = [],
        source = void 0,
        parentSource = void 0,
        stateSource = void 0,
        target = void 0,
        parentTarget = void 0,
        stateTarget = void 0,
        nodoExistente = void 0,
        addSource = void 0,
        addTarget = void 0,
        addValue = void 0;

    linksGlo.forEach(function (v, k) {
      //Se obtiene source y target del elemento
      source = nodesGlo.filter(function (element) {
        return element.id === parseInt(v.source);
      })[0];
      target = nodesGlo.filter(function (element) {
        return element.id === parseInt(v.target);
      })[0];
      //Se guarda source-padre y target-padre
      parentSource = maxParent(source);
      parentTarget = maxParent(target);
      //Se guarda source-state y target-state
      stateSource = parentSource.group;
      stateTarget = parentTarget.group;
      //Se guarda source y link a crear
      addSource = stateSource ? parentSource : source;
      addTarget = stateTarget ? parentTarget : target;
      addValue = parseInt(v.value);
      //Se consulta si el nodo existe
      nodoExistente = links.filter(function (element) {
        return element.source === addSource.id && element.target === addTarget.id;
      });

      if (nodoExistente.length !== 0) {
        //Se suma valor a duplicado
        nodoExistente[0].value += addValue;
      } else {
        //Se creo nuevo link
        links.push({
          'source': addSource.id,
          'target': addTarget.id,
          'value': addValue
        });
      }
    });
    return links;
  };

  var preSankey = function preSankey() {
    linksGlo = $.extend(true, [], linksOri);
    nodesGlo = $.extend(true, [], nodesOri);
    linksGlo = declareGroupLinks();
    nodesGlo = deleteEmptyNodes();

    dibujarSankey(width, height, { 'nodes': nodesGlo, 'links': linksGlo });
  };

  var init = function init() {

    var downloadFile = function downloadFile() {
      console.log('Se solicitan archivos'); // Borrar

      var formatoSankey = function formatoSankey(elemento, data) {
        var processData = [];

        switch (elemento) {
          case 'nodos':
            data.forEach(function (v, k) {

              processData.push({
                'id': parseInt(v.id),
                'name': v.name,
                'parent': v.parent === 'null' ? false : parseInt(v.parent),
                'category': v.category,
                'pos': parseInt(v.position),
                'group': true,
                'imp': v.importation.split(';').map(function (element) {
                  return parseInt(element);
                }),
                'exp': v.exportation.split(';').map(function (element) {
                  return parseInt(element);
                }),
                'prod': v.production.split(';').map(function (element) {
                  return parseInt(element);
                })
              });
            });
            break;
          case 'links':
            data.forEach(function (v, k) {
              processData.push({
                'source': parseInt(v.source),
                'target': parseInt(v.target),
                'value': parseInt(v.value)
              });
            });
            break;
        }

        return processData;
      };

      var promise = new Promise(function (success) {
        d3.csv('public/src/nodes.csv', function (nodos) {
          nodesOri = formatoSankey('nodos', nodos);

          d3.csv('public/src/links.csv', function (links) {
            linksOri = formatoSankey('links', links);

            success();
          });
        });
      });

      return promise;
    };

    downloadFile().then(function () {
      preSankey();
    });
  };

  init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzY2FsZUNvbG9yTGluayIsImQzIiwic2NhbGVPcmRpbmFsIiwicmFuZ2UiLCJkb21haW4iLCJmb250U2NhbGUiLCJzY2FsZUxpbmVhciIsInN1YnRyYWN0TGlnaHQiLCJjb2xvciIsImFtb3VudCIsImNjIiwicGFyc2VJbnQiLCJjIiwidG9TdHJpbmciLCJsZW5ndGgiLCJkYXJrZW4iLCJpbmRleE9mIiwic3Vic3RyaW5nIiwiJCIsImhlaWdodCIsIndpZHRoIiwibm9kZXNPcmkiLCJsaW5rc09yaSIsIm5vZGVzR2xvIiwibGlua3NHbG8iLCJzYW5rZXlDaGFydEQzIiwicGF0aCIsInN2ZyIsImNyZWF0ZUdyYWZpY28iLCJkYXRhIiwiY29udGFpbmVyIiwibWFyZ2luIiwidG9wIiwicmlnaHQiLCJib3R0b20iLCJsZWZ0Iiwic2l6ZSIsInllYXJzIiwibmV3RGF0YSIsImZvckVhY2giLCJ2IiwiayIsInB1c2giLCJkYXRlIiwiRGF0ZSIsInZhbHVlIiwic3ZnR3JhZmljbyIsImh0bWwiLCJhcHBlbmQiLCJhdHRyIiwieCIsInNjYWxlVGltZSIsImV4dGVudCIsImQiLCJyYW5nZVJvdW5kIiwieSIsImxpbmUiLCJjYWxsIiwiYXhpc0JvdHRvbSIsInN0eWxlIiwiYXhpc0xlZnQiLCJkYXR1bSIsInVwZGF0ZVBsYWNhIiwiZWxlbWVudCIsImNvbnRlbmVkb3IiLCJzZWxlY3QiLCJ0ZXh0IiwibmFtZSIsInByb2QiLCJpbXAiLCJleHAiLCJmYWRlSW4iLCJvcGFjaXR5IiwiZyIsImkiLCJpZF9ub2RlcyIsImxpbmtzIiwibGlua3NGaWx0ZXIiLCJub2RlcyIsIm5vZGVzRmlsdGVyIiwiaWQiLCJzb3VyY2VMaW5rcyIsImxpbmsiLCJ0YXJnZXQiLCJ0YXJnZXRMaW5rcyIsInNvdXJjZSIsInNlbGVjdEFsbCIsImZpbHRlciIsInRyYW5zaXRpb24iLCJzdGF0dXNOb2RlIiwiY2F0ZWdvcnkiLCJkeCIsImZhZGVPdXQiLCJkeSIsIm5vZGVXaWR0aCIsImNyZWF0ZUJhY2tCdXR0b24iLCJub2RlIiwiY29uc29sZSIsImxvZyIsImJ1dHRvbiIsIm9uIiwiZXZlbnQiLCJncm91cCIsInJlbW92ZSIsInByZVNhbmtleSIsImRpYnVqYXJTYW5rZXkiLCJoZWlndGgiLCJlbXB0eSIsInNhbmtleSIsImxheW91dCIsImVudGVyIiwiTWF0aCIsIm1heCIsInNvcnQiLCJhIiwiYiIsImRyYWciLCJkcmFnbW92ZSIsImUiLCJmbG9vciIsIm1pbiIsInJlbGF5b3V0IiwiYWN0dWFsaXphclNhbmtleSIsIm9sZExpbmtzIiwibGlua3NEaWZmIiwibGlua3Nfb2xkIiwibGlua3NfbmV3IiwibWF4UGFyZW50Iiwibm9kbyIsInBhcmVudE5vZGUiLCJwYXJlbnQiLCJkZWxldGVFbXB0eU5vZGVzIiwiZGVsIiwibm9kZXNEZWxldGUiLCJzdGF0dXMiLCJub2RlSSIsImxpbmtJIiwicmV2ZXJzZSIsInNwbGljZSIsImRlY2xhcmVHcm91cExpbmtzIiwiZGVzYXJyb2xsbyIsInBhcmVudFNvdXJjZSIsInN0YXRlU291cmNlIiwicGFyZW50VGFyZ2V0Iiwic3RhdGVUYXJnZXQiLCJub2RvRXhpc3RlbnRlIiwiYWRkU291cmNlIiwiYWRkVGFyZ2V0IiwiYWRkVmFsdWUiLCJleHRlbmQiLCJpbml0IiwiZG93bmxvYWRGaWxlIiwiZm9ybWF0b1NhbmtleSIsImVsZW1lbnRvIiwicHJvY2Vzc0RhdGEiLCJwb3NpdGlvbiIsImltcG9ydGF0aW9uIiwic3BsaXQiLCJtYXAiLCJleHBvcnRhdGlvbiIsInByb2R1Y3Rpb24iLCJwcm9taXNlIiwiUHJvbWlzZSIsInN1Y2Nlc3MiLCJjc3YiLCJub2RvcyIsInRoZW4iXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQSxJQUFJQSxpQkFBa0JDLEdBQUdDLFlBQUgsR0FBa0JDLEtBQWxCLENBQXdCLENBQUMsU0FBRCxFQUFXLFNBQVgsRUFBcUIsU0FBckIsRUFBK0IsU0FBL0IsQ0FBeEIsRUFBbUVDLE1BQW5FLENBQTBFLG9C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LENBRks7QUFHZix5QkFBVXhFLFNBQVM2QixFQUFFSyxLQUFYO0FBSEssZUFBakI7QUFLRCxhQU5EO0FBT0E7QUF6Qko7O0FBNEJBLGVBQU82RyxXQUFQO0FBQ0QsT0FoQ0Q7O0FBa0NBLFVBQUlPLFVBQVUsSUFBSUMsT0FBSixDQUFZLFVBQUNDLE9BQUQsRUFBYTtBQUNyQ2xLLFdBQUdtSyxHQUFILENBQU8sc0JBQVAsRUFDRSxVQUFDQyxLQUFELEVBQVc7QUFDVGhKLHFCQUFXbUksY0FBYyxPQUFkLEVBQXVCYSxLQUF2QixDQUFYOztBQUVBcEssYUFBR21LLEdBQUgsQ0FBTyxzQkFBUCxFQUNFLFVBQUN4RixLQUFELEVBQVc7QUFDVHRELHVCQUFXa0ksY0FBYyxPQUFkLEVBQXVCNUUsS0FBdkIsQ0FBWDs7QUFFQXVGO0FBQ0QsV0FMSDtBQU9ELFNBWEg7QUFhRCxPQWRhLENBQWQ7O0FBZ0JBLGFBQU9GLE9BQVA7QUFDRCxLQXRERDs7QUF3REFWLG1CQUFlZSxJQUFmLENBQW9CLFlBQU07QUFDeEI5RDtBQUNELEtBRkQ7QUFHRCxHQTdERDs7QUErREo4QztBQUNELENBOW1CRCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyAgVmFyaWFibGVzIEdsb2JhbGVzXG5sZXQgc2NhbGVDb2xvckxpbmsgID0gZDMuc2NhbGVPcmRpbmFsKCkucmFuZ2UoWycjZmZiYjQyJywnI2YxODU0YicsJyM4MDgwODAnLCcjZjIzODVhJ10pLmRvbWFpbignRW5lcmfDrWFzIFByaW1hcmlhcycsICdFbmVyZ8OtYXMgU2VjdW5kYXJpYXMnLCAnQ2VudHJvcyBkZSBUcmFuc2Zvcm1hY2nDs24nLCAnQ29uc3VtbycpO1xubGV0IGZvbnRTY2FsZSAgICAgICA9IGQzLnNjYWxlTGluZWFyKCkucmFuZ2UoWzgsIDE2XSk7XG5cbi8vICBGdW5jaW9uZXNcbi8vIGNvbnN0IGZvcm1hdG9OdW1lcm8gPSAoZCkgPT4ge1xuLy8gICBsZXQgZm9ybWF0ID0gZDMuZm9ybWF0KCcsLjBmJyk7XG4vL1xuLy8gICByZXR1cm4gYCR7IGZvcm1hdChkKSB9IFR3aGA7XG4vLyB9O1xuXG4vKiBSZXN0YSBlbCBwb3JjZW50YWplIGluZGljYWRvIGEgdW4gY29sb3IgKFJSLCBHRyBvIEJCKSBoZXhhZGVjaW1hbCBwYXJhIG9zY3VyZWNlcmxvICovXG5jb25zdCBzdWJ0cmFjdExpZ2h0ID0gZnVuY3Rpb24oY29sb3IsIGFtb3VudCl7XG4gIGxldCBjYyA9IHBhcnNlSW50KGNvbG9yLDE2KSAtIGFtb3VudDtcbiAgbGV0IGMgPSAoY2MgPCAwKSA/IDAgOiAoY2MpO1xuICBjID0gKGMudG9TdHJpbmcoMTYpLmxlbmd0aCA+IDEgKSA/IGMudG9TdHJpbmcoMTYpIDogYDAke2MudG9TdHJpbmcoMTYpfWA7XG5cbiAgcmV0dXJuIGM7XG59O1xuXG4vKiBPc2N1cmVjZSB1biBjb2xvciBoZXhhZGVjaW1hbCBkZSA2IGNhcmFjdGVyZXMgI1JSR0dCQiBzZWd1biBlbCBwb3JjZW50YWplIGluZGljYWRvICovXG5jb25zdCBkYXJrZW4gPSAoY29sb3IsIGFtb3VudCkgPT57XG4gIGNvbG9yID0gKGNvbG9yLmluZGV4T2YoJyMnKT49MCkgPyBjb2xvci5zdWJzdHJpbmcoMSxjb2xvci5sZW5ndGgpIDogY29sb3I7XG4gIGFtb3VudCA9IHBhcnNlSW50KCgyNTUqYW1vdW50KS8xMDApO1xuICBjb2xvciA9IGAjJHtzdWJ0cmFjdExpZ2h0KGNvbG9yLnN1YnN0cmluZygwLDIpLCBhbW91bnQpfSR7c3VidHJhY3RMaWdodChjb2xvci5zdWJzdHJpbmcoMiw0KSwgYW1vdW50KX0ke3N1YnRyYWN0TGlnaHQoY29sb3Iuc3Vic3RyaW5nKDQsNiksIGFtb3VudCl9YDtcblxuICByZXR1cm4gY29sb3I7XG59O1xuXG4kKCgpID0+IHtcblxuICBsZXQgaGVpZ2h0ICAgICAgPSAkKCcjY29udGVudCcpLmhlaWdodCgpLFxuICAgICAgd2lkdGggICAgICAgPSAkKCcjY29udGVudCcpLndpZHRoKCkgLSAkKCcjcGxhY2EnKS53aWR0aCgpLFxuICAgICAgLy8gY2xhdmVzTm9kb3MgPSBbXSxcbiAgICAgIC8vIGRhdGFTYW5rZXkgID0ge30sXG4gICAgICAvLyBtb3ZlSWQgPSAwLFxuICAgICAgbm9kZXNPcmksIGxpbmtzT3JpLFxuICAgICAgbm9kZXNHbG8sIGxpbmtzR2xvLFxuICAgICAgc2Fua2V5Q2hhcnREMywgcGF0aCwgc3ZnO1xuXG4gIC8vICBGdW5jaW9uZXNcbiAgICAgIC8vIGNvbnN0IGdlbmVyYXJQdWVydGFzICAgID0gKCkgPT4ge1xuICAgICAgLy8gICBkYXRhU2Fua2V5Lm5vZGVzLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQucGFyZW50ID09PSBmYWxzZSkpLmZvckVhY2goKHYsIGspID0+IHtcbiAgICAgIC8vICAgICBjbGF2ZXNOb2Rvcy5wdXNoKHsgJ2lkJzogdi5pZCwgJ3N0YXRlJzogdHJ1ZSB9KTtcbiAgICAgIC8vICAgfSk7XG4gICAgICAvLyB9O1xuICAgICAgY29uc3QgY3JlYXRlR3JhZmljbyA9IChkYXRhLCBjb250YWluZXIpID0+IHtcbiAgICAgICAgLy8gVmFyaWFibGVzXG4gICAgICAgIGxldCBtYXJnaW4gPSB7IHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCwgbGVmdDogMCB9O1xuICAgICAgICBsZXQgc2l6ZSA9IHsgd2lkdGg6ICgzMDAgLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodCksIGhlaWdodDogKDUwIC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b20pIH07XG4gICAgICAgIGxldCB5ZWFycyA9IFsnMjAxMicsICcyMDEzJywgJzIwMTQnLCAnMjAxNScsICcyMDE2JywgJzIwMTcnXTtcbiAgICAgICAgbGV0IG5ld0RhdGEgPSBbXTtcblxuICAgICAgICBkYXRhLmZvckVhY2goKHYsIGspID0+IHsgbmV3RGF0YS5wdXNoKHsgZGF0ZTogbmV3IERhdGUoeWVhcnNba10pLCB2YWx1ZTogdiB9KTsgfSk7XG5cbiAgICAgICAgbGV0IHN2Z0dyYWZpY28gPSBjb250YWluZXIuaHRtbCgnJykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHNpemUud2lkdGggKyBtYXJnaW4ubGVmdCArIG1hcmdpbi5yaWdodClcbiAgICAgICAgICAuYXR0cignaGVpZ2h0Jywgc2l6ZS5oZWlnaHQgKyBtYXJnaW4udG9wICsgbWFyZ2luLmJvdHRvbSlcbiAgICAgICAgICAuYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7IG1hcmdpbi5sZWZ0IH0sICR7IG1hcmdpbi50b3AgfSlgKTtcblxuICAgICAgICAvLyBsZXQgcGFyc2VUaW1lID0gZDMudGltZVBhcnNlKCclZC0lYi0leScpO1xuXG4gICAgICAgIGxldCB4ID0gZDMuc2NhbGVUaW1lKClcbiAgICAgICAgICAuZG9tYWluKGQzLmV4dGVudChuZXdEYXRhLCAoZCkgPT4gZC5kYXRlKSlcbiAgICAgICAgICAucmFuZ2VSb3VuZChbMCwgc2l6ZS53aWR0aF0pO1xuICAgICAgICBsZXQgeSA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAgICAgICAuZG9tYWluKGQzLmV4dGVudChuZXdEYXRhLCAoZCkgPT4gZC52YWx1ZSkpXG4gICAgICAgICAgLnJhbmdlUm91bmQoW3NpemUuaGVpZ2h0LCAwXSk7XG5cblxuICAgICAgICBsZXQgbGluZSA9IGQzLmxpbmUoKS54KChkKSA9PiB4KGQuZGF0ZSkpLnkoKGQpID0+IHkoZC52YWx1ZSkpO1xuXG4gICAgICAgIHN2Z0dyYWZpY28uYXBwZW5kKCdnJylcbiAgICAgICAgICAuY2FsbChkMy5heGlzQm90dG9tKHgpKVxuICAgICAgICAgIC5zdHlsZSgndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgwcHgsICR7IHNpemUuaGVpZ2h0IC0gMSB9cHgpYCk7XG5cbiAgICAgICAgc3ZnR3JhZmljby5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5jYWxsKGQzLmF4aXNMZWZ0KHkpKTtcbiAgICAgICAgLy8gLmFwcGVuZCgndGV4dCcpXG4gICAgICAgIC8vICAgLmF0dHIoJ2ZpbGwnLCAnIzAwMCcpXG4gICAgICAgIC8vICAgLmF0dHIoJ3RyYW5zZm9ybScsICdyb3RhdGUoLTkwKScpXG4gICAgICAgIC8vICAgLmF0dHIoJ3knLCA2KVxuICAgICAgICAvLyAgIC5hdHRyKCdkeScsICcwLjcxZW0nKVxuICAgICAgICAvLyAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdlbmQnKVxuICAgICAgICAvLyAgIC50ZXh0KCdQcmljZSAoJCknKTtcblxuICAgICAgICBzdmdHcmFmaWNvLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgLmRhdHVtKG5ld0RhdGEpXG4gICAgICAgICAgLmF0dHIoJ2ZpbGwnLCAnbm9uZScpXG4gICAgICAgICAgLmF0dHIoJ3N0cm9rZScsICdzdGVlbGJsdWUnKVxuICAgICAgICAgIC5hdHRyKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKVxuICAgICAgICAgIC5hdHRyKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpXG4gICAgICAgICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDEuNSlcbiAgICAgICAgICAuYXR0cignZCcsIGxpbmUpO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZVBsYWNhID0gKGVsZW1lbnQpID0+IHtcbiAgICAgICAgbGV0IGNvbnRlbmVkb3IgPSBkMy5zZWxlY3QoJyNwbGFjYScpO1xuICAgICAgICAgICAgY29udGVuZWRvci5zZWxlY3QoJy5wbGFjYV90aXR1bG8nKS5zdHlsZSgndGV4dC10cmFuc2Zvcm0nLCAndXBwZXJjYXNlJykudGV4dChlbGVtZW50Lm5hbWUpO1xuICAgICAgICAgICAgY29udGVuZWRvci5zZWxlY3QoJy5wbGFjYV9wcm9kJykudGV4dChlbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgIGNvbnRlbmVkb3Iuc2VsZWN0KCcucGxhY2FfaW1wJykudGV4dChlbGVtZW50LnZhbHVlICogMC4yKTtcbiAgICAgICAgICAgIGNvbnRlbmVkb3Iuc2VsZWN0KCcucGxhY2FfZXhwJykudGV4dChlbGVtZW50LnZhbHVlICogMC4xKTtcbiAgICAgICAgICAgIGNvbnRlbmVkb3Iuc2VsZWN0KCcucGxhY2FfbG9zdCcpLnRleHQoZWxlbWVudC52YWx1ZSAqIDAuMDUpO1xuICAgICAgICAgICAgY29udGVuZWRvci5zZWxlY3QoJy5wbGFjYV9lZmknKS50ZXh0KCgoZWxlbWVudC52YWx1ZSAtICAoZWxlbWVudC52YWx1ZSAqIDAuMDUpKSAqIDEwMCkgLyBlbGVtZW50LnZhbHVlKTtcbiAgICAgICAgICAgIGNvbnRlbmVkb3Iuc2VsZWN0KCcucGxhY2FfbW9yZScpLnRleHQoZWxlbWVudC52YWx1ZSAgKiAwLjAxKTtcblxuICAgICAgICBjcmVhdGVHcmFmaWNvKGVsZW1lbnQucHJvZCwgY29udGVuZWRvci5zZWxlY3QoJy5wbGFjYV9ncmFmaWNvLmdyYWZpY29fcHJvZCcpKTtcbiAgICAgICAgY3JlYXRlR3JhZmljbyhlbGVtZW50LmltcCwgY29udGVuZWRvci5zZWxlY3QoJy5wbGFjYV9ncmFmaWNvLmdyYWZpY29faW1wJykpO1xuICAgICAgICBjcmVhdGVHcmFmaWNvKGVsZW1lbnQuZXhwLCBjb250ZW5lZG9yLnNlbGVjdCgnLnBsYWNhX2dyYWZpY28uZ3JhZmljb19leHAnKSk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBmYWRlSW4gPSAob3BhY2l0eSkgPT4gKGcsIGkpID0+IHtcbiAgICAgICAgdXBkYXRlUGxhY2EoZyk7XG5cbiAgICAgICAgbGV0IGlkX25vZGVzID0gW10sXG4gICAgICAgICAgICBsaW5rcyxcbiAgICAgICAgICAgIGxpbmtzRmlsdGVyLFxuICAgICAgICAgICAgbm9kZXMsXG4gICAgICAgICAgICBub2Rlc0ZpbHRlcjtcblxuICAgICAgICAvLyBhZGQgZXZlbnQgbm9kZVxuICAgICAgICBpZF9ub2Rlcy5wdXNoKGcuaWQpO1xuICAgICAgICAvLyBhZGQgc291cmNlTGlua3NcbiAgICAgICAgZy5zb3VyY2VMaW5rcy5mb3JFYWNoKChsaW5rKSA9PiB7IGlkX25vZGVzLnB1c2gobGluay50YXJnZXQuaWQpOyB9KTtcbiAgICAgICAgLy8gYWRkIHRhcmdldExpbmtzXG4gICAgICAgIGcudGFyZ2V0TGlua3MuZm9yRWFjaCgobGluaykgPT4geyBpZF9ub2Rlcy5wdXNoKGxpbmsuc291cmNlLmlkKTsgfSk7XG5cbiAgICAgICAgLy8gc2VsZWN0IGxpbmtzXG4gICAgICAgIGxpbmtzID0gZDMuc2VsZWN0QWxsKCcjc2Fua2V5IC5saW5rJyk7XG4gICAgICAgIC8vICBsaW5rcyBmb2N1c0luXG4gICAgICAgIC8vIGQzLnNlbGVjdEFsbCgnI3NhbmtleSAubGluaycpXG4gICAgICAgIC8vICAgLmZpbHRlcigoZCkgPT4gKGQuc291cmNlLmlkID09PSBnLmlkIHx8IGQudGFyZ2V0LmlkID09PSBnLmlkKSlcbiAgICAgICAgLy8gICAudHJhbnNpdGlvbigpLnN0eWxlKCdzdHJva2Utb3BhY2l0eScsIC43NSk7XG4gICAgICAgIC8vIGxpbmtzIGZvY3VzT3V0XG4gICAgICAgIGxpbmtzRmlsdGVyID0gbGlua3MuZmlsdGVyKChkKSA9PiAoZC5zb3VyY2UuaWQgIT09IGcuaWQgJiYgZC50YXJnZXQuaWQgIT09IGcuaWQpKTtcbiAgICAgICAgbGlua3NGaWx0ZXIudHJhbnNpdGlvbigpLnN0eWxlKCdzdHJva2Utb3BhY2l0eScsIG9wYWNpdHkpO1xuXG4gICAgICAgIC8vICBzZWxlY3Qgbm9kZXNcbiAgICAgICAgbm9kZXMgPSBkMy5zZWxlY3RBbGwoJyNzYW5rZXkgLm5vZGUnKTtcbiAgICAgICAgLy8gbm9kZXMgZm9jdXNJblxuICAgICAgICBub2Rlc0ZpbHRlciA9IG5vZGVzLmZpbHRlcigoZCkgPT4ge1xuICAgICAgICAgIGxldCBzdGF0dXNOb2RlID0gZmFsc2U7XG5cbiAgICAgICAgICBpZF9ub2Rlcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7IGlmIChlbGVtZW50ID09PSBkLmlkKSB7IHN0YXR1c05vZGUgPSB0cnVlOyB9IH0pO1xuXG4gICAgICAgICAgcmV0dXJuIHN0YXR1c05vZGU7XG4gICAgICAgIH0pO1xuICAgICAgICBub2Rlc0ZpbHRlci5zZWxlY3QoJ3JlY3QnKS50cmFuc2l0aW9uKCkuc3R5bGUoJ2ZpbGwnLCAoZCkgPT4gZGFya2VuKHNjYWxlQ29sb3JMaW5rKGQuY2F0ZWdvcnkpLCAyMCkpO1xuICAgICAgICBub2Rlc0ZpbHRlci5zZWxlY3QoJ3RleHQnKS50cmFuc2l0aW9uKCkuYXR0cigndGV4dC1hbmNob3InLCAnbWlkZGxlJykuYXR0cigneScsIC0xMCkuYXR0cigneCcsIChkKSA9PiAoZC5keCAvIDIpKS50ZXh0KChkKSA9PiAoZC5uYW1lKSk7XG4gICAgICAgIC8vIG5vZGVzIGZvY3VzT3V0XG4gICAgICAgIG5vZGVzRmlsdGVyID0gbm9kZXMuZmlsdGVyKChkKSA9PiB7XG4gICAgICAgICAgbGV0IHN0YXR1c05vZGUgPSB0cnVlO1xuXG4gICAgICAgICAgaWRfbm9kZXMuZm9yRWFjaCgoZWxlbWVudCkgPT4geyBpZiAoZWxlbWVudCA9PT0gZC5pZCkgeyBzdGF0dXNOb2RlID0gZmFsc2U7IH0gfSk7XG5cbiAgICAgICAgICByZXR1cm4gc3RhdHVzTm9kZTtcbiAgICAgICAgfSk7XG4gICAgICAgIG5vZGVzRmlsdGVyLnRyYW5zaXRpb24oKS5zdHlsZSgnb3BhY2l0eScsIG9wYWNpdHkpO1xuICAgICAgICB9O1xuICAgICAgY29uc3QgZmFkZU91dCA9IChvcGFjaXR5KSA9PiAoZywgaSkgPT4ge1xuXG4gICAgICAgIGxldCBpZF9ub2RlcyA9IFtdLFxuICAgICAgICAgICAgbGlua3MsXG4gICAgICAgICAgICBsaW5rc0ZpbHRlcixcbiAgICAgICAgICAgIG5vZGVzLFxuICAgICAgICAgICAgbm9kZXNGaWx0ZXI7XG5cbiAgICAgICAgLy8gYWRkIGV2ZW50IG5vZGVcbiAgICAgICAgaWRfbm9kZXMucHVzaChnLmlkKTtcbiAgICAgICAgLy8gYWRkIHNvdXJjZUxpbmtzXG4gICAgICAgIGcuc291cmNlTGlua3MuZm9yRWFjaCgobGluaykgPT4geyBpZF9ub2Rlcy5wdXNoKGxpbmsudGFyZ2V0LmlkKTsgfSk7XG4gICAgICAgIC8vIGFkZCB0YXJnZXRMaW5rc1xuICAgICAgICBnLnRhcmdldExpbmtzLmZvckVhY2goKGxpbmspID0+IHsgaWRfbm9kZXMucHVzaChsaW5rLnNvdXJjZS5pZCk7IH0pO1xuXG4gICAgICAgIC8vIHNlbGVjdCBsaW5rc1xuICAgICAgICBsaW5rcyA9IGQzLnNlbGVjdEFsbCgnI3NhbmtleSAubGluaycpO1xuICAgICAgICAvLyAgbGlua3MgZm9jdXNJblxuICAgICAgICAvLyBkMy5zZWxlY3RBbGwoJyNzYW5rZXkgLmxpbmsnKVxuICAgICAgICAvLyAgIC5maWx0ZXIoKGQpID0+IChkLnNvdXJjZS5pZCA9PT0gZy5pZCB8fCBkLnRhcmdldC5pZCA9PT0gZy5pZCkpXG4gICAgICAgIC8vICAgLnRyYW5zaXRpb24oKS5zdHlsZSgnc3Ryb2tlLW9wYWNpdHknLCAuNzUpO1xuICAgICAgICAvLyBsaW5rcyBmb2N1c091dFxuICAgICAgICBsaW5rc0ZpbHRlciA9IGxpbmtzLmZpbHRlcigoZCkgPT4gKGQuc291cmNlLmlkICE9PSBnLmlkICYmIGQudGFyZ2V0LmlkICE9PSBnLmlkKSk7XG4gICAgICAgIGxpbmtzRmlsdGVyLnRyYW5zaXRpb24oKS5zdHlsZSgnc3Ryb2tlLW9wYWNpdHknLCAwLjc1KTtcblxuICAgICAgICAvLyAgc2VsZWN0IG5vZGVzXG4gICAgICAgIG5vZGVzID0gZDMuc2VsZWN0QWxsKCcjc2Fua2V5IC5ub2RlJyk7XG4gICAgICAgIC8vIG5vZGVzIGZvY3VzSW5cbiAgICAgICAgbm9kZXNGaWx0ZXIgPSBub2Rlcy5maWx0ZXIoKGQpID0+IHtcbiAgICAgICAgICBsZXQgc3RhdHVzTm9kZSA9IGZhbHNlO1xuXG4gICAgICAgICAgaWRfbm9kZXMuZm9yRWFjaCgoZWxlbWVudCkgPT4geyBpZiAoZWxlbWVudCA9PT0gZC5pZCkgeyBzdGF0dXNOb2RlID0gdHJ1ZTsgfSB9KTtcblxuICAgICAgICAgIHJldHVybiBzdGF0dXNOb2RlO1xuICAgICAgICB9KTtcbiAgICAgICAgbm9kZXNGaWx0ZXIuc2VsZWN0KCdyZWN0JylcbiAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLnN0eWxlKCdmaWxsJywgKGQpID0+IHNjYWxlQ29sb3JMaW5rKGQuY2F0ZWdvcnkpKTtcbiAgICAgICAgbm9kZXNGaWx0ZXIuc2VsZWN0KCd0ZXh0JylcbiAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ2VuZCcpXG4gICAgICAgICAgLmF0dHIoJ3knLCAoZCkgPT4gKGQuZHkgLyAyKSkuYXR0cigneCcsIC0xMClcbiAgICAgICAgICAudGV4dCgoZCkgPT4gKGQubmFtZS5sZW5ndGggPiA4KSA/IChkLm5hbWUuc3Vic3RyaW5nKDAsIDUpICsgJy4uLicpIDogKGQubmFtZSkpXG4gICAgICAgICAgLmZpbHRlcigoZCkgPT4gKGQueCA8IHdpZHRoIC8gMikpXG4gICAgICAgICAgICAuYXR0cigneCcsIDEwICsgc2Fua2V5Q2hhcnREMy5ub2RlV2lkdGgoKSlcbiAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdzdGFydCcpO1xuICAgICAgICAvLyBub2RlcyBmb2N1c091dFxuICAgICAgICBub2Rlc0ZpbHRlciA9IG5vZGVzLmZpbHRlcigoZCkgPT4ge1xuICAgICAgICAgIGxldCBzdGF0dXNOb2RlID0gdHJ1ZTtcblxuICAgICAgICAgIGlkX25vZGVzLmZvckVhY2goKGVsZW1lbnQpID0+IHsgaWYgKGVsZW1lbnQgPT09IGQuaWQpIHsgc3RhdHVzTm9kZSA9IGZhbHNlOyB9IH0pO1xuXG4gICAgICAgICAgcmV0dXJuIHN0YXR1c05vZGU7XG4gICAgICAgIH0pO1xuICAgICAgICBub2Rlc0ZpbHRlci50cmFuc2l0aW9uKCkuc3R5bGUoJ29wYWNpdHknLCAxKTtcbiAgICAgIH07XG4gICAgICAvLyBjb25zdCBjb2xhcHNhckV4cGFuZGlyTm9kbyA9IChub2RvKSA9PiB7XG4gICAgICAvL1xuICAgICAgLy8gICBub2Rlc09yaVtub2RvLmlkXS5ncm91cCA9IChub2Rlc09yaVtub2RvLmlkXS5ncm91cCkgPyAoZmFsc2UpIDogKHRydWUpO1xuICAgICAgLy9cbiAgICAgIC8vICAgcmV0dXJuIG5vZGVzT3JpO1xuICAgICAgLy9cbiAgICAgIC8vXG4gICAgICAvLyAgIC8vIGxldCBvbGRMaW5rcyA9IGRhdGFTYW5rZXkubGlua3M7XG4gICAgICAvL1xuICAgICAgLy8gICAvLyBpZiAobm9kby5wYXJlbnQgPT09IGZhbHNlKSB7XG4gICAgICAvLyAgIC8vICAgY29uc29sZS5sb2coJ1NlIGV4cGFuZGUgbm9kbycpO1xuICAgICAgLy8gICAvLyAgIGNsYXZlc05vZG9zLmZvckVhY2goKGVsZW1lbnQpID0+IHsgaWYgKGVsZW1lbnQuaWQgPT09IG5vZG8uaWQgKyBtb3ZlSWQpIHsgZWxlbWVudC5zdGF0ZSA9IGZhbHNlOyB9IH0pO1xuICAgICAgLy8gICAvL1xuICAgICAgLy8gICAvLyAgIGRhdGFTYW5rZXkubm9kZXMgPSBub2Rvc09yaWdpbmFsZXM7XG4gICAgICAvLyAgIC8vICAgZGF0YVNhbmtleS5saW5rcyA9IGxpbmtzT3JpZ2luYWxlcztcbiAgICAgIC8vICAgLy9cbiAgICAgIC8vICAgLy8gICBkYXRhU2Fua2V5LmxpbmtzID0gZGVjbGFyZUdyb3VwTGlua3MoZGF0YVNhbmtleS5saW5rcywgdHJ1ZSk7XG4gICAgICAvLyAgIC8vXG4gICAgICAvLyAgIC8vICAgZGF0YVNhbmtleSA9IGJ1c2Nhck5vZGVzKGRhdGFTYW5rZXkubm9kZXMsIGRhdGFTYW5rZXkubGlua3MpO1xuICAgICAgLy8gICAvLyAgIG1vdmVJZCA9IDA7XG4gICAgICAvLyAgIC8vICAgJCgnI3NhbmtleScpLmVtcHR5KCk7XG4gICAgICAvLyAgIC8vICAgZGlidWphclNhbmtleSh3aWR0aCwgaGVpZ2h0LCBkYXRhU2Fua2V5KTtcbiAgICAgIC8vICAgLy8gICAvLyBhY3R1YWxpemFyU2Fua2V5KCQoJyNjb250ZW50Jykud2lkdGgoKSwgJCgnI2NvbnRlbnQnKS5oZWlnaHQoKSwgZGF0YVNhbmtleSwgb2xkTGlua3MpO1xuICAgICAgLy8gICAvLyB9IGVsc2Uge1xuICAgICAgLy8gICAvLyAgIGNvbnNvbGUubG9nKCdTZSBjb2xhcHNhIG5vZG8nKTtcbiAgICAgIC8vICAgLy8gICAvLyBsZXQgcGFyZW50ID0gZGF0YVNhbmtleS5ub2Rlcy5maWx0ZXIoKGVsZW1lbnQpID0+IChlbGVtZW50Lm5hbWUgPT09IG5vZG8ucGFyZW50KSlbMF07XG4gICAgICAvLyAgIC8vICAgLy8gY2xhdmVzTm9kb3MuZmlsdGVyKChlbGVtZW50KSA9PiAoZWxlbWVudC5pZCA9PT0gcGFyZW50LmlkKSlbMF0uc3RhdGUgPSB0cnVlO1xuICAgICAgLy8gICAvLyAgIC8vXG4gICAgICAvLyAgIC8vICAgLy8gZGF0YVNhbmtleSA9IGJ1c2Nhck5vZGVzKG5vZG9zT3JpZ2luYWxlcywgZGF0YVNhbmtleS5saW5rcyA9IGRlY2xhcmVHcm91cExpbmtzKGxpbmtzT3JpZ2luYWxlcykpO1xuICAgICAgLy8gICAvLyAgIC8vXG4gICAgICAvLyAgIC8vICAgLy8gJCgnI3NhbmtleScpLmVtcHR5KCk7XG4gICAgICAvLyAgIC8vICAgLy8gZGlidWphclNhbmtleSh3aWR0aCwgaGVpZ2h0LCBkYXRhU2Fua2V5KTtcbiAgICAgIC8vICAgLy8gICAvLyBhY3R1YWxpemFyU2Fua2V5KCQoJyNjb250ZW50Jykud2lkdGgoKSwgJCgnI2NvbnRlbnQnKS5oZWlnaHQoKSwgZGF0YVNhbmtleSwgb2xkTGlua3MpO1xuICAgICAgLy8gICAvLyB9XG4gICAgICAvLyB9O1xuICAgICAgY29uc3QgY3JlYXRlQmFja0J1dHRvbiA9IChub2RlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKG5vZGUpO1xuICAgICAgICBsZXQgYnV0dG9uID0gZDMuc2VsZWN0KCcjcGxhY2EgLmFncnVwJylcbiAgICAgICAgICAuYXBwZW5kKCdkaXYnKVxuICAgICAgICAgICAgLmF0dHIoJ2lkJywgKCkgPT4gKGBub2RlXyR7IG5vZGUuaWQgfWApKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2JhY2tCdXR0b24nKVxuICAgICAgICAgICAgLm9uKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICBpZiAobm9kZXNPcmlbbm9kZS5pZF0uZ3JvdXApIHtcbiAgICAgICAgICAgICAgICBub2Rlc09yaVtub2RlLmlkXS5ncm91cCA9IGZhbHNlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGVzT3JpW25vZGUuaWRdLmdyb3VwID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICQoYCNub2RlXyR7IG5vZGUuaWQgfWApLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgIHByZVNhbmtleSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgYnV0dG9uLmFwcGVuZCgnc3BhbicpLmF0dHIoJ2NsYXNzJywgJ2JhY2tCdXR0b25fdGV4dCcpLnRleHQobm9kZS5uYW1lKTtcbiAgICAgICAgYnV0dG9uLmFwcGVuZCgnc3BhbicpXG4gICAgICAgICAgLmFwcGVuZCgnaScpXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2ZhIGZhLXRpbWVzJylcbiAgICAgICAgICAuYXR0cignYXJpYS1oaWRkZW4nLCAndHJ1ZScpXG4gICAgICAgICAgLnN0eWxlKCdtYXJnaW4tbGVmdCcsICcxMHB4Jyk7XG4gICAgICB9O1xuICAgICAgY29uc3QgZGlidWphclNhbmtleSA9ICh3aWR0aCwgaGVpZ3RoLCBkYXRhKSA9PiB7XG5cbiAgICAgICAgLy8gVmFyaWFibGVzXG4gICAgICAgIGxldCBtYXJnaW4gPSB7IHRvcDogNTAsIHJpZ2h0OiA1MCwgYm90dG9tOiA1MCwgbGVmdDogNTAgfTtcbiAgICAgICAgbGV0IHNpemUgPSB7IHdpZHRoOiAod2lkdGggLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodCksIGhlaWdodDogKGhlaWd0aCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tKSB9O1xuXG4gICAgICAgICQoJyNzYW5rZXknKS5lbXB0eSgpO1xuXG4gICAgICAgIC8vIENyZWFjacOzbiBTVkdcbiAgICAgICAgc3ZnID0gZDMuc2VsZWN0KCcjc2Fua2V5JylcbiAgICAgICAgICAuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgc2l6ZS53aWR0aCArIG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIHNpemUuaGVpZ2h0ICsgbWFyZ2luLnRvcCArIG1hcmdpbi5ib3R0b20pXG4gICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgkeyBtYXJnaW4ubGVmdCB9LCAkeyBtYXJnaW4udG9wIH0pYCk7XG5cbiAgICAgICAgLy8gQ3JlYWNpw7NuIFNhbmtleVxuICAgICAgICBzYW5rZXlDaGFydEQzID0gZDMuc2Fua2V5KClcbiAgICAgICAgICAubm9kZVdpZHRoKDIwKSAvLyBBbmNobyBub2RvXG4gICAgICAgICAgLnNpemUoW3NpemUud2lkdGgsIHNpemUuaGVpZ2h0XSlcbiAgICAgICAgICAubm9kZXMoZGF0YS5ub2RlcylcbiAgICAgICAgICAubGlua3MoZGF0YS5saW5rcylcbiAgICAgICAgICAubGF5b3V0KCk7XG5cbiAgICAgICAgLy8gQ3JlYWNpw7NuIGRlIExpbmtzXG4gICAgICAgIHBhdGggPSBzYW5rZXlDaGFydEQzLmxpbmsoKTtcblxuICAgICAgICBmb250U2NhbGUuZG9tYWluKGQzLmV4dGVudChkYXRhLm5vZGVzLCAoZCkgPT4gZC52YWx1ZSkpO1xuXG4gICAgICAgIC8vICBTZSBjcmVhbiBsaW5rc1xuICAgICAgICBsZXQgbGluayA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdpZCcsICdsaW5rcycpXG4gICAgICAgICAgLnNlbGVjdEFsbCgnLmxpbmsnKVxuICAgICAgICAgIC5kYXRhKGRhdGEubGlua3MpXG4gICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdsaW5rJylcbiAgICAgICAgICAgIC5hdHRyKCdkJywgcGF0aClcbiAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgKGQpID0+IE1hdGgubWF4KDEsIGQuZHkpKVxuICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCAnc2lsdmVyJylcbiAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLW9wYWNpdHknLCAwLjc1KVxuICAgICAgICAgICAgLm9uKCdtb3VzZW92ZXInLCAoZCkgPT4geyBkMy5zZWxlY3QoZDMuZXZlbnQudGFyZ2V0KS5zdHlsZSgnc3Ryb2tlLW9wYWNpdHknLCAxKTsgfSlcbiAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCAoZCkgPT4geyBkMy5zZWxlY3QoZDMuZXZlbnQudGFyZ2V0KS5zdHlsZSgnc3Ryb2tlLW9wYWNpdHknLCAwLjc1KTsgfSlcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiAoYi5keSAtIGEuZHkpKTtcblxuICAgICAgICBsaW5rLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQudGFyZ2V0Lm5hbWUgPT09ICdFWFBPUlRBQ0lPTkVTJyB8fCBlbGVtZW50LnRhcmdldC5uYW1lID09PSAnQ09OU1VNTyBQUk9QSU8nIHx8IGVsZW1lbnQudGFyZ2V0Lm5hbWUgPT09ICdUUkFOU1BPUlRFJyB8fCBlbGVtZW50LnRhcmdldC5uYW1lID09PSAnUEVSRElEQScpKVxuICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJyNCQTNGMUQnKTtcbiAgICAgICAgbGluay5maWx0ZXIoKGVsZW1lbnQpID0+IChlbGVtZW50LnNvdXJjZS5uYW1lID09PSAnSU1QT1JUQUNJT05FUycpKVxuICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJ2dyZWVuJyk7XG5cbiAgICAgICAgLy8gU2UgY3JlYW4gbm9kb3NcbiAgICAgICAgbGV0IG5vZGUgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAuYXR0cignaWQnLCAnbm9kZXMnKVxuICAgICAgICAgIC5zZWxlY3RBbGwoJy5ub2RlJylcbiAgICAgICAgICAuZGF0YShkYXRhLm5vZGVzLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQuc291cmNlTGlua3MubGVuZ3RoICE9PSAwIHx8IGVsZW1lbnQudGFyZ2V0TGlua3MubGVuZ3RoICE9PSAwKSkpXG4gICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAuYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCdpZCcsIChkKSA9PiBkLmlkKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ25vZGUnKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIChkKSA9PiBgdHJhbnNsYXRlKCR7IGQueCB9LCAkeyBkLnkgfSlgKVxuICAgICAgICAgICAgLmNhbGwoZDMuZHJhZygpLm9uKCdkcmFnJywgZHJhZ21vdmUpKTtcbiAgICAgICAgLy8gU2UgY3JlYW4gcmVjdGFuZ3Vsb3Mgbm9kb3NcbiAgICAgICAgbm9kZS5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgc2Fua2V5Q2hhcnREMy5ub2RlV2lkdGgoKSlcbiAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCAoZCkgPT4gTWF0aC5tYXgoMTAsIGQuZHkpKVxuICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgKGQpID0+IHNjYWxlQ29sb3JMaW5rKGQuY2F0ZWdvcnkpKVxuICAgICAgICAgICAgLm9uKCdtb3VzZW92ZXInLCBmYWRlSW4oMC4wMjUpKVxuICAgICAgICAgICAgLm9uKCdtb3VzZW91dCcsIGZhZGVPdXQoKSlcbiAgICAgICAgICAgIC5vbignZGJsY2xpY2snLCAoZSkgPT4ge1xuXG4gICAgICAgICAgICAgIGlmIChub2Rlc09yaVtlLmlkXS5ncm91cCkge1xuICAgICAgICAgICAgICAgIG5vZGVzT3JpW2UuaWRdLmdyb3VwID0gZmFsc2U7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbm9kZXNPcmlbZS5pZF0uZ3JvdXAgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNyZWF0ZUJhY2tCdXR0b24oZSk7XG4gICAgICAgICAgICAgIHByZVNhbmtleSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2UgY3JlYW4gdGV4dG9zIG5vZG9zXG4gICAgICAgIG5vZGUuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgIC5hdHRyKCd4JywgLTEwKVxuICAgICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ2VuZCcpXG4gICAgICAgICAgICAuYXR0cigneScsIChkKSA9PiAoZC5keSAvIDIpKVxuICAgICAgICAgICAgLmF0dHIoJ2R5JywgJy4zNWVtJylcbiAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIChkKSA9PiBzY2FsZUNvbG9yTGluayhkLmNhdGVnb3J5KSlcbiAgICAgICAgICAgIC8vIC5zdHlsZSgnZm9udC1zaXplJywgJzhweCcpXG4gICAgICAgICAgICAuc3R5bGUoJ2ZvbnQtc2l6ZScsIChkKSA9PiBgJHsgTWF0aC5mbG9vcihmb250U2NhbGUoZC52YWx1ZSkpIH1weGApXG4gICAgICAgICAgICAvLyAudGV4dCgoZCkgPT4gKGQubmFtZSkpXG4gICAgICAgICAgICAudGV4dCgoZCkgPT4gKGQubmFtZS5sZW5ndGggPiA4KSA/IChkLm5hbWUuc3Vic3RyaW5nKDAsIDUpICsgJy4uLicpIDogKGQubmFtZSkpXG4gICAgICAgICAgICAuZmlsdGVyKChkKSA9PiAoZC54IDwgd2lkdGggLyAyKSlcbiAgICAgICAgICAgICAgLmF0dHIoJ3gnLCAxMCArIHNhbmtleUNoYXJ0RDMubm9kZVdpZHRoKCkpXG4gICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdzdGFydCcpO1xuICAgICAgICAvLyBTZSBhZ3JlZ2EgdGV4dG8gcmVmZXJlbmNpYSBob3ZlciBsaW5rXG4gICAgICAgIGxpbmsuYXBwZW5kKCd0aXRsZScpLnRleHQoKGQpID0+IGAkeyBkLnNvdXJjZS5uYW1lIH0gKCR7IGQuc291cmNlLmlkIH0pIOKGkiAkeyBkLnRhcmdldC5uYW1lIH0gKCR7IGQudGFyZ2V0LmlkIH0pIOKGkiAkeyBkLnZhbHVlIH1gKTtcbiAgICAgICAgLy8gU2UgYWdyZWdhIHRleHRvIHJlZmVyZW5jaWEgaG92ZXIgbm9kZVxuICAgICAgICBub2RlLmFwcGVuZCgndGl0bGUnKS50ZXh0KChkKSA9PiBgJHsgZC5uYW1lIH0gKCR7IGQuaWQgfSlgKTtcblxuICAgICAgICAvLyB0aGUgZnVuY3Rpb24gZm9yIG1vdmluZyB0aGUgbm9kZXNcbiAgICAgICAgZnVuY3Rpb24gZHJhZ21vdmUoZCkge1xuICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7IGQueCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHNpemUud2lkdGggLSBkLmR4LCBkMy5ldmVudC54KSkgfSwgJHsgZC55ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2l6ZS5oZWlnaHQgLSBkLmR5LCBkMy5ldmVudC55KSkgfSlgKTtcbiAgICAgICAgICBzYW5rZXlDaGFydEQzLnJlbGF5b3V0KCk7XG4gICAgICAgICAgbGluay5hdHRyKCdkJywgcGF0aCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGFjdHVhbGl6YXJTYW5rZXkgPSAod2lkdGgsIGhlaWd0aCwgZGF0YSwgb2xkTGlua3MpID0+IHtcbiAgICAgICAgY29uc3QgbGlua3NEaWZmID0gKGxpbmtzX29sZCwgbGlua3NfbmV3KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2cobGlua3Nfb2xkKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhsaW5rc19uZXcpO1xuICAgICAgICAgIGxldCBsaW5rcyA9IFtdLFxuICAgICAgICAgICAgICBzb3VyY2UsXG4gICAgICAgICAgICAgIHRhcmdldDtcblxuICAgICAgICAgIGxpbmtzX25ldy5mb3JFYWNoKCh2LCBrKSA9PiB7XG4gICAgICAgICAgICBzb3VyY2UgID0gdi5zb3VyY2U7XG4gICAgICAgICAgICB0YXJnZXQgID0gdi50YXJnZXQ7XG5cbiAgICAgICAgICAgIGxpbmtzX29sZC5mb3JFYWNoKCh2LCBrKSA9PiB7IGlmICgoc291cmNlICE9PSB2LnNvdXJjZS5pZCkgfHwgKHRhcmdldCAhPT0gdi50YXJnZXQuaWQpKSB7IGxpbmtzLnB1c2godik7IH0gfSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm4gbGlua3M7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gbGV0IG5ld05vZGVzID0gbm9kZXNEaWZmKGRhdGEsIHNhbmtleURhdGEpO1xuICAgICAgICAvLyBsZXQgbmV3TGlua3MgPSBsaW5rc0RpZmYob2xkTGlua3MsIGRhdGEubGlua3MpO1xuXG4gICAgICAgIC8vIFBhcmFtZXRyb3NcbiAgICAgICAgbGV0IG1hcmdpbiA9IHtcbiAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgcmlnaHQ6IDAsXG4gICAgICAgICAgYm90dG9tOiAwLFxuICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IHNpemUgPSB7XG4gICAgICAgICAgd2lkdGg6IHdpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQsXG4gICAgICAgICAgaGVpZ2h0OiBoZWlndGggLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIENyZWFjacOzbiBTYW5rZXlcbiAgICAgICAgc2Fua2V5Q2hhcnREMyA9IGQzLnNhbmtleSgpXG4gICAgICAgICAgLm5vZGVXaWR0aCgyMCkgLy8gQW5jaG8gbm9kb1xuICAgICAgICAgIC5zaXplKFtzaXplLndpZHRoLCBzaXplLmhlaWdodF0pXG4gICAgICAgICAgLm5vZGVzKGRhdGEubm9kZXMpXG4gICAgICAgICAgLmxpbmtzKGRhdGEubGlua3MpXG4gICAgICAgICAgLmxheW91dCgzMik7XG5cbiAgICAgICAgc2Fua2V5Q2hhcnREMy5yZWxheW91dCgpO1xuXG4gICAgICAgIC8vIENyZWFjacOzbiBkZSBMaW5rc1xuICAgICAgICBwYXRoID0gc2Fua2V5Q2hhcnREMy5saW5rKCk7XG4gICAgICAgICQoJyNsaW5rcycpLmVtcHR5KCk7XG5cbiAgICAgICAgbGV0IGxpbmtzID0gZDMuc2VsZWN0KCcjbGlua3MnKVxuICAgICAgICAgIC5zZWxlY3RBbGwoJy5saW5rJylcbiAgICAgICAgICAuZGF0YShkYXRhLmxpbmtzKVxuICAgICAgICAgIC5lbnRlcigpO1xuXG4gICAgICAgIGxpbmtzLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnbGluaycpXG4gICAgICAgICAgICAuYXR0cignZCcsIChkKSA9PiBwYXRoKGQpKVxuICAgICAgICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAoZCkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gZC5keTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsICdncmF5JylcbiAgICAgICAgICAgIC5vbignbW91c2VvdmVyJywgKGQpID0+IHtcbiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZDMuZXZlbnQpO1xuICAgICAgICAgICAgICBkMy5zZWxlY3QoZDMuZXZlbnQudGFyZ2V0KS5zdHlsZSgnc3Ryb2tlJywgJ3JlZCcpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCAoZCkgPT4ge1xuICAgICAgICAgICAgICBkMy5zZWxlY3QoZDMuZXZlbnQudGFyZ2V0KS5zdHlsZSgnc3Ryb2tlJywgJ2dyYXknKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGQzLnNlbGVjdEFsbCgnLmxpbmsnKVxuICAgICAgICAvLyAgIC5kYXRhKGRhdGEubGlua3MpXG4gICAgICAgIC8vICAgLmF0dHIoJ2QnLCAoZCkgPT4gcGF0aChkKSk7XG4gICAgICAgIGQzLnNlbGVjdEFsbCgnLm5vZGUnKVxuICAgICAgICAgIC5kYXRhKGRhdGEubm9kZXMpXG4gICAgICAgICAgLy8gLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAoZCkgPT4gYHRyYW5zbGF0ZSgkeyBkLnggfSwgJHsgZC55IH0pYCk7XG4gICAgICAgIGQzLnNlbGVjdEFsbCgncmVjdCcpXG4gICAgICAgICAgLmRhdGEoZGF0YS5ub2RlcylcbiAgICAgICAgICAuc3R5bGUoJ29wYWNpdHknLCAwKVxuICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHNhbmtleUNoYXJ0RDMubm9kZVdpZHRoKCkpXG4gICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIChkKSA9PiBkLmR5KVxuICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuc3R5bGUoJ29wYWNpdHknLCAxKTtcblxuICAgICAgICAvLyBDcmVhdGUgRGlmZXJlbmNlXG4gICAgICAgIC8vIG5ld0xpbmtzLmZvckVhY2goKHYsIGspID0+IHtcbiAgICAgICAgLy8gICBsZXQgbGluayA9IGQzLnNlbGVjdCgnI2xpbmtzJylcbiAgICAgICAgLy8gICAgIC5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAvLyAgICAgICAuYXR0cignY2xhc3MnLCAnbGluaycpXG4gICAgICAgIC8vICAgICAgIC5hdHRyKCdkJywgKCkgPT4gcGF0aCh2KSlcbiAgICAgICAgLy8gICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAoKSA9PiBNYXRoLm1heCgxLCB2LmR5KSlcbiAgICAgICAgLy8gICAgICAgLnN0eWxlKCdzdHJva2UnLCAoKSA9PiBzY2FsZUNvbG9yKHYuc291cmNlLm5hbWUucmVwbGFjZSgnICcsICcnKSkpXG4gICAgICAgIC8vICAgICAgIC5zb3J0KChhLCBiKSA9PiAoYi5keSAtIGEuZHkpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICBsaW5rLmFwcGVuZCgndGl0bGUnKS50ZXh0KCgpID0+IGAkeyB2LnNvdXJjZS5uYW1lIH0g4oaSICR7IHYudGFyZ2V0Lm5hbWUgfSBcXG4gJHsgZm9ybWF0b051bWVybyh2LnZhbHVlKSB9YCk7XG4gICAgICAgIC8vIH0pO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IG1heFBhcmVudCA9IChub2RvKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKG5vZG8pO1xuICAgICAgICBsZXQgcGFyZW50Tm9kZSA9IG5vZGVzR2xvLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQuaWQgPT09IG5vZG8ucGFyZW50KSlbMF07XG5cbiAgICAgICAgaWYgKG5vZG8ucGFyZW50ICE9PSBmYWxzZSkge1xuICAgICAgICAgIGlmICh0eXBlb2YocGFyZW50Tm9kZSkgIT09ICd1bmRlZmluZWQnICYmIHBhcmVudE5vZGUuZ3JvdXAgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXhQYXJlbnQobm9kZXNHbG8uZmlsdGVyKChlbGVtZW50KSA9PiAoZWxlbWVudC5pZCA9PT0gbm9kby5wYXJlbnQpKVswXSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBub2RvO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gbm9kbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGRlbGV0ZUVtcHR5Tm9kZXMgPSAoKSA9PiB7XG4gICAgICAgIGxldCBkZWwgPSAwLFxuICAgICAgICAgICAgbm9kZXNEZWxldGUgPSBbXSxcbiAgICAgICAgICAgIHN0YXR1cztcblxuICAgICAgICAvLyBtb3ZlSWQgPSAwO1xuXG4gICAgICAgIG5vZGVzR2xvLmZvckVhY2goKG5vZGUsIG5vZGVJKSA9PiB7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ25vZG86ICcgKyBub2RlSSArICcgKCBpZDogJyArIG5vZGUuaWQgKyAnKScpO1xuICAgICAgICAgIHN0YXR1cyA9IGZhbHNlO1xuXG4gICAgICAgICAgLy8gQ29uc3VsdG8gc2kgZWwgbm9kbyBzZSB1dGlsaXphIGVuIGFsZ3VuIGxpbmtcbiAgICAgICAgICBsaW5rc0dsby5mb3JFYWNoKChsaW5rLCBsaW5rSSkgPT4ge1xuICAgICAgICAgICAgaWYgKG5vZGUuaWQgPT09IGxpbmsuc291cmNlKSB7XG4gICAgICAgICAgICAgIHN0YXR1cyA9IHRydWU7XG4gICAgICAgICAgICAgIGxpbmsuc291cmNlID0gbGluay5zb3VyY2UgLSBkZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9kZS5pZCA9PT0gbGluay50YXJnZXQpIHtcbiAgICAgICAgICAgICAgc3RhdHVzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgbGluay50YXJnZXQgPSBsaW5rLnRhcmdldCAtIGRlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIC8vIE1vZGlmaWNhciBlbCBJRCByZXN0YW5kbyBsYSBjYW50aWRhZCBkZSBlbGVtZW50b3MgYm9ycmFkb3NcbiAgICAgICAgICAvLyBub2RlLmlkID0gbm9kZS5pZCAtIGRlbDtcblxuICAgICAgICAgIGlmICghc3RhdHVzKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQm9ycmFyJyk7XG4gICAgICAgICAgICBub2Rlc0RlbGV0ZS5wdXNoKG5vZGVJKTtcbiAgICAgICAgICAgIGRlbCsrO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAvLyAgIC8vIGNvbnNvbGUubG9nKCdub2RvOiAnICsgbm9kZUkgKyAnICggaWQ6ICcgKyBub2RlLmlkICsgJyk8LScpO1xuICAgICAgICAgIC8vIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbm9kZXNEZWxldGUucmV2ZXJzZSgpLmZvckVhY2goKG5vZGUpID0+IHsgbm9kZXNHbG8uc3BsaWNlKG5vZGUsIDEpOyB9KTtcblxuICAgICAgICAvLyBtb3ZlSWQgPSBkZWw7XG4gICAgICAgIC8vIG5vZGVzLmZvckVhY2goKG5vZGUsIG5vZGVJKSA9PiB7XG4gICAgICAgIC8vICAgY29uc29sZS5sb2coJ25vZG86ICcgKyBub2RlSSArICcgKCBpZDogJyArIG5vZGUuaWQgKyAnKScpO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICAvLyBjb25zb2xlLmxvZyhsaW5rcyk7XG4gICAgICAgIHJldHVybiBub2Rlc0dsbztcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRlY2xhcmVHcm91cExpbmtzID0gKGRlc2Fycm9sbG8gPSBmYWxzZSkgPT4ge1xuICAgICAgICBsZXQgbGlua3MgPSBbXSxcbiAgICAgICAgICAgIHNvdXJjZSwgcGFyZW50U291cmNlLCBzdGF0ZVNvdXJjZSxcbiAgICAgICAgICAgIHRhcmdldCwgcGFyZW50VGFyZ2V0LCBzdGF0ZVRhcmdldCxcbiAgICAgICAgICAgIG5vZG9FeGlzdGVudGUsXG4gICAgICAgICAgICBhZGRTb3VyY2UsXG4gICAgICAgICAgICBhZGRUYXJnZXQsXG4gICAgICAgICAgICBhZGRWYWx1ZTtcblxuICAgICAgICBsaW5rc0dsby5mb3JFYWNoKCh2LCBrKSA9PiB7XG4gICAgICAgICAgLy9TZSBvYnRpZW5lIHNvdXJjZSB5IHRhcmdldCBkZWwgZWxlbWVudG9cbiAgICAgICAgICBzb3VyY2UgPSBub2Rlc0dsby5maWx0ZXIoKGVsZW1lbnQpID0+IChlbGVtZW50LmlkID09PSBwYXJzZUludCh2LnNvdXJjZSkpKVswXTtcbiAgICAgICAgICB0YXJnZXQgPSBub2Rlc0dsby5maWx0ZXIoKGVsZW1lbnQpID0+IChlbGVtZW50LmlkID09PSBwYXJzZUludCh2LnRhcmdldCkpKVswXTtcbiAgICAgICAgICAvL1NlIGd1YXJkYSBzb3VyY2UtcGFkcmUgeSB0YXJnZXQtcGFkcmVcbiAgICAgICAgICBwYXJlbnRTb3VyY2UgPSBtYXhQYXJlbnQoc291cmNlKTtcbiAgICAgICAgICBwYXJlbnRUYXJnZXQgPSBtYXhQYXJlbnQodGFyZ2V0KTtcbiAgICAgICAgICAvL1NlIGd1YXJkYSBzb3VyY2Utc3RhdGUgeSB0YXJnZXQtc3RhdGVcbiAgICAgICAgICBzdGF0ZVNvdXJjZSA9IHBhcmVudFNvdXJjZS5ncm91cDtcbiAgICAgICAgICBzdGF0ZVRhcmdldCA9IHBhcmVudFRhcmdldC5ncm91cDtcbiAgICAgICAgICAvL1NlIGd1YXJkYSBzb3VyY2UgeSBsaW5rIGEgY3JlYXJcbiAgICAgICAgICBhZGRTb3VyY2UgPSAoc3RhdGVTb3VyY2UpID8gKHBhcmVudFNvdXJjZSkgOiAoc291cmNlKTtcbiAgICAgICAgICBhZGRUYXJnZXQgPSAoc3RhdGVUYXJnZXQpID8gKHBhcmVudFRhcmdldCkgOiAodGFyZ2V0KTtcbiAgICAgICAgICBhZGRWYWx1ZSAgPSBwYXJzZUludCh2LnZhbHVlKTtcbiAgICAgICAgICAvL1NlIGNvbnN1bHRhIHNpIGVsIG5vZG8gZXhpc3RlXG4gICAgICAgICAgbm9kb0V4aXN0ZW50ZSA9IGxpbmtzLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQuc291cmNlID09PSBhZGRTb3VyY2UuaWQgJiYgZWxlbWVudC50YXJnZXQgPT09IGFkZFRhcmdldC5pZCkpO1xuXG4gICAgICAgICAgaWYgIChub2RvRXhpc3RlbnRlLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgLy9TZSBzdW1hIHZhbG9yIGEgZHVwbGljYWRvXG4gICAgICAgICAgICBub2RvRXhpc3RlbnRlWzBdLnZhbHVlICs9IGFkZFZhbHVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL1NlIGNyZW8gbnVldm8gbGlua1xuICAgICAgICAgICAgbGlua3MucHVzaCh7XG4gICAgICAgICAgICAgICdzb3VyY2UnOiBhZGRTb3VyY2UuaWQsXG4gICAgICAgICAgICAgICd0YXJnZXQnOiBhZGRUYXJnZXQuaWQsXG4gICAgICAgICAgICAgICd2YWx1ZSc6ICBhZGRWYWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxpbmtzO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcHJlU2Fua2V5ID0gKCkgPT4ge1xuICAgICAgICBsaW5rc0dsbyA9ICQuZXh0ZW5kKHRydWUsIFtdLCBsaW5rc09yaSk7XG4gICAgICAgIG5vZGVzR2xvID0gJC5leHRlbmQodHJ1ZSwgW10sIG5vZGVzT3JpKTtcbiAgICAgICAgbGlua3NHbG8gPSBkZWNsYXJlR3JvdXBMaW5rcygpO1xuICAgICAgICBub2Rlc0dsbyA9IGRlbGV0ZUVtcHR5Tm9kZXMoKTtcblxuICAgICAgICBkaWJ1amFyU2Fua2V5KHdpZHRoLCBoZWlnaHQsIHsgJ25vZGVzJzogbm9kZXNHbG8sICdsaW5rcyc6IGxpbmtzR2xvIH0pO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgaW5pdCA9ICgpID0+IHtcblxuICAgICAgICBjb25zdCBkb3dubG9hZEZpbGUgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1NlIHNvbGljaXRhbiBhcmNoaXZvcycpOyAvLyBCb3JyYXJcblxuICAgICAgICAgIGNvbnN0IGZvcm1hdG9TYW5rZXkgICAgID0gKGVsZW1lbnRvLCBkYXRhKSA9PiB7XG4gICAgICAgICAgICBsZXQgcHJvY2Vzc0RhdGEgPSBbXTtcblxuICAgICAgICAgICAgc3dpdGNoIChlbGVtZW50bykge1xuICAgICAgICAgICAgICBjYXNlICdub2Rvcyc6XG4gICAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKCh2LCBrKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgIHByb2Nlc3NEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnaWQnICAgICAgOiBwYXJzZUludCh2LmlkKSxcbiAgICAgICAgICAgICAgICAgICAgJ25hbWUnICAgIDogdi5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAncGFyZW50JyAgOiAodi5wYXJlbnQgPT09ICdudWxsJyk/KGZhbHNlKToocGFyc2VJbnQodi5wYXJlbnQpKSxcbiAgICAgICAgICAgICAgICAgICAgJ2NhdGVnb3J5Jzogdi5jYXRlZ29yeSxcbiAgICAgICAgICAgICAgICAgICAgJ3BvcycgICAgIDogcGFyc2VJbnQodi5wb3NpdGlvbiksXG4gICAgICAgICAgICAgICAgICAgICdncm91cCcgICA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICdpbXAnICAgICA6IHYuaW1wb3J0YXRpb24uc3BsaXQoJzsnKS5tYXAoKGVsZW1lbnQpID0+IChwYXJzZUludChlbGVtZW50KSkpLFxuICAgICAgICAgICAgICAgICAgICAnZXhwJyAgICAgOiB2LmV4cG9ydGF0aW9uLnNwbGl0KCc7JykubWFwKChlbGVtZW50KSA9PiAocGFyc2VJbnQoZWxlbWVudCkpKSxcbiAgICAgICAgICAgICAgICAgICAgJ3Byb2QnICAgIDogdi5wcm9kdWN0aW9uLnNwbGl0KCc7JykubWFwKChlbGVtZW50KSA9PiAocGFyc2VJbnQoZWxlbWVudCkpKVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgJ2xpbmtzJzpcbiAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goKHYsIGspID0+IHtcbiAgICAgICAgICAgICAgICAgIHByb2Nlc3NEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnc291cmNlJzogcGFyc2VJbnQodi5zb3VyY2UpLFxuICAgICAgICAgICAgICAgICAgICAndGFyZ2V0JzogcGFyc2VJbnQodi50YXJnZXQpLFxuICAgICAgICAgICAgICAgICAgICAndmFsdWUnIDogcGFyc2VJbnQodi52YWx1ZSksXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NEYXRhO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChzdWNjZXNzKSA9PiB7XG4gICAgICAgICAgICBkMy5jc3YoJ3B1YmxpYy9zcmMvbm9kZXMuY3N2JyxcbiAgICAgICAgICAgICAgKG5vZG9zKSA9PiB7XG4gICAgICAgICAgICAgICAgbm9kZXNPcmkgPSBmb3JtYXRvU2Fua2V5KCdub2RvcycsIG5vZG9zKTtcblxuICAgICAgICAgICAgICAgIGQzLmNzdigncHVibGljL3NyYy9saW5rcy5jc3YnLFxuICAgICAgICAgICAgICAgICAgKGxpbmtzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmtzT3JpID0gZm9ybWF0b1NhbmtleSgnbGlua3MnLCBsaW5rcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcygpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICBkb3dubG9hZEZpbGUoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICBwcmVTYW5rZXkoKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gIGluaXQoKTtcbn0pO1xuIl19
