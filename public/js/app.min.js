'use strict';

// VARIABLES GLOBALES
var colores = ['#0075C9', '#009DDA', '#00B5E4'];

//  Funciones
// const formatoNumero = (d) => {
//   let format = d3.format(',.0f');
//
//   return `${ format(d) } Twh`;
// };

/* Resta el porcentaje indicado a un color (RR, GG o BB) hexadecimal para oscurecerlo */
var subtractLight = function subtractLight(color, amount) {
  var cc = parseInt(color, 16) - amount;
  var c = cc < 0 ? 0 : cc;
  c = c.toString(16).length > 1 ? c.toString(16) : '0' + c.toString(16);

  return c;
};

/* Oscurece un color hexadecimal de 6 caracteres #RRGGBB segun el porcentaje indicado */
var darken = function darken(color, amount) {
  color = color.indexOf('#') >= 0 ? color.substring(1, color.length) : color;
  amount = parseInt(255 * amount / 100);
  color = '#' + subtractLight(color.substring(0, 2), amount) + subtractLight(color.substring(2, 4), amount) + subtractLight(color.substring(4, 6), amount);

  return color;
};

$(function () {

  var height = $('#sankey').height(),
      width = $('#sankey').width(),

  // clavesNodos = [],
  // dataSankey  = {},
  // moveId = 0,
  nodesOri = void 0,
      linksOri = void 0,
      nodesGlo = void 0,
      linksGlo = void 0,
      sankeyChartD3 = void 0,
      path = void 0,
      svg = void 0;

  //  Funciones
  // const generarPuertas    = () => {
  //   dataSankey.nodes.filter((element) => (element.parent === false)).forEach((v, k) => {
  //     clavesNodos.push({ 'id': v.id, 'state': true });
  //   });
  // };
  var createGrafico = function createGrafico(data, container) {
    // Variables
    var margin = { top: 0, right: 0, bottom: 0, left: 0 };
    var size = { width: 300 - margin.left - margin.right, height: 50 - margin.top - margin.bottom };
    var years = ['2012', '2013', '2014', '2015', '2016', '2017'];
    var newData = [];

    data.forEach(function (v, k) {
      newData.push({ date: new Date(years[k]), value: v });
    });

    var svgGrafico = container.html('').append('svg').attr('width', size.width + margin.left + margin.right).attr('height', size.height + margin.top + margin.bottom).append('g').attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');

    // let parseTime = d3.timeParse('%d-%b-%y');

    var x = d3.scaleTime().domain(d3.extent(newData, function (d) {
      return d.date;
    })).rangeRound([0, size.width]);
    var y = d3.scaleLinear().domain(d3.extent(newData, function (d) {
      return d.value;
    })).rangeRound([size.height, 0]);

    var line = d3.line().x(function (d) {
      return x(d.date);
    }).y(function (d) {
      return y(d.value);
    });

    svgGrafico.append('g').call(d3.axisBottom(x)).style('transform', 'translate(0px, ' + (size.height - 1) + 'px)');

    svgGrafico.append('g').call(d3.axisLeft(y));
    // .append('text')
    //   .attr('fill', '#000')
    //   .attr('transform', 'rotate(-90)')
    //   .attr('y', 6)
    //   .attr('dy', '0.71em')
    //   .attr('text-anchor', 'end')
    //   .text('Price ($)');

    svgGrafico.append('path').datum(newData).attr('fill', 'none').attr('stroke', 'steelblue').attr('stroke-linejoin', 'round').attr('stroke-linecap', 'round').attr('stroke-width', 1.5).attr('d', line);
  };

  var fadeIn = function fadeIn() {
    return function (g, i) {
      var all_links = d3.selectAll('#sankey .link'),
          all_nodes = d3.selectAll('#sankey .node'),
          nodes_id = [];

      var event_node = all_nodes.filter(function (d) {
        return d.id === g.id;
      });
      event_node.select('rect').transition().style('fill', 'black').style('stroke', 'black');
      event_node.select('text').transition().style('fill', 'black');

      var filter_nodes = all_nodes.filter(function (d) {
        var state = false;

        nodes_id.forEach(function (element) {
          if (d.id === element) {
            state = true;
          }
        });

        return state;
      });
      filter_nodes.select('rect').transition().style('fill', 'black').style('stroke', 'black');
      filter_nodes.select('text').transition().style('fill', 'black');

      var filter_links = all_links.filter(function (d) {
        var state = true;

        if (d.source.id === g.id) {
          nodes_id.push(d.target.id);
        } else if (d.target.id === g.id) {
          nodes_id.push(d.source.id);
        } else {
          state = false;
        }

        return state;
      });
      filter_links.transition().style('stroke', '#0075C9').style('stroke-opacity', 0.5);
    };
  };
  var fadeOut = function fadeOut(opacity) {
    return function (g, i) {

      var id_nodes = [],
          links = void 0,
          linksFilter = void 0,
          nodes = void 0,
          nodesFilter = void 0;

      // add event node
      id_nodes.push(g.id);
      // add sourceLinks
      g.sourceLinks.forEach(function (link) {
        id_nodes.push(link.target.id);
      });
      // add targetLinks
      g.targetLinks.forEach(function (link) {
        id_nodes.push(link.source.id);
      });

      // select links
      links = d3.selectAll('#sankey .link');
      //  links focusIn
      // d3.selectAll('#sankey .link')
      //   .filter((d) => (d.source.id === g.id || d.target.id === g.id))
      //   .transition().style('stroke-opacity', .75);
      // links focusOut
      linksFilter = links.filter(function (d) {
        return d.source.id !== g.id && d.target.id !== g.id;
      });
      linksFilter.transition().style('stroke-opacity', 0.25);

      //  select nodes
      nodes = d3.selectAll('#sankey .node');
      // nodes focusIn
      nodesFilter = nodes.filter(function (d) {
        var statusNode = false;

        id_nodes.forEach(function (element) {
          if (element === d.id) {
            statusNode = true;
          }
        });

        return statusNode;
      });
      nodesFilter.select('rect').transition().style('fill', function (d) {
        return 'white';
      });
      // .style('fill', (d) => colores[d.pos - 1]);
      nodesFilter.select('text').transition().attr('text-anchor', 'end').attr('y', function (d) {
        return d.dy / 2;
      }).attr('x', -10)
      // .text((d) => (d.name.length > 8) ? (d.name.substring(0, 5) + '...') : (d.name))
      .filter(function (d) {
        return d.x < width / 2;
      }).attr('x', 10 + sankeyChartD3.nodeWidth()).attr('text-anchor', 'start');
      // nodes focusOut
      nodesFilter = nodes.filter(function (d) {
        var statusNode = true;

        id_nodes.forEach(function (element) {
          if (element === d.id) {
            statusNode = false;
          }
        });

        return statusNode;
      });
      nodesFilter.transition().style('opacity', 1);
    };
  };
  // const colapsarExpandirNodo = (nodo) => {
  //
  //   nodesOri[nodo.id].group = (nodesOri[nodo.id].group) ? (false) : (true);
  //
  //   return nodesOri;
  //
  //
  //   // let oldLinks = dataSankey.links;
  //
  //   // if (nodo.parent === false) {
  //   //   console.log('Se expande nodo');
  //   //   clavesNodos.forEach((element) => { if (element.id === nodo.id + moveId) { element.state = false; } });
  //   //
  //   //   dataSankey.nodes = nodosOriginales;
  //   //   dataSankey.links = linksOriginales;
  //   //
  //   //   dataSankey.links = declareGroupLinks(dataSankey.links, true);
  //   //
  //   //   dataSankey = buscarNodes(dataSankey.nodes, dataSankey.links);
  //   //   moveId = 0;
  //   //   $('#sankey').empty();
  //   //   dibujarSankey(width, height, dataSankey);
  //   //   // actualizarSankey($('#content').width(), $('#content').height(), dataSankey, oldLinks);
  //   // } else {
  //   //   console.log('Se colapsa nodo');
  //   //   // let parent = dataSankey.nodes.filter((element) => (element.name === nodo.parent))[0];
  //   //   // clavesNodos.filter((element) => (element.id === parent.id))[0].state = true;
  //   //   //
  //   //   // dataSankey = buscarNodes(nodosOriginales, dataSankey.links = declareGroupLinks(linksOriginales));
  //   //   //
  //   //   // $('#sankey').empty();
  //   //   // dibujarSankey(width, height, dataSankey);
  //   //   // actualizarSankey($('#content').width(), $('#content').height(), dataSankey, oldLinks);
  //   // }
  // };

  var dibujarSankey = function dibujarSankey(width, heigth, data) {

    // Se vacia contenedor
    $('#sankey').empty();

    // Se definen variables
    var margin = {
      top: 40,
      right: 200,
      bottom: 40,
      left: 200,
      header: 20
    },
        headerSize = 19,
        size = {
      width: (width < 1400 ? width : 1400) - margin.left - margin.right,
      height: heigth - margin.top - margin.bottom - margin.header - headerSize
    },
        secciones = ['ENERGÍAS PRIMARIAS', 'PLANTAS DE TRATAMIENTO', 'ENERGÍAS SECUNDARIAS', 'CONSUMOS'],
        anchoNodo = 20,
        separacionNodo = 20;

    // Creación SVG
    svg = d3.select('#sankey').append('svg').attr('width', size.width + margin.right + margin.left).attr('height', size.height + margin.top + margin.bottom + margin.header + headerSize);

    // Borrar
    // svg.append('g')
    //   .attr('transform', `translate(${ 0 }, ${ 0 })`)
    //   .append('rect')
    //   .attr('width', `${ size.width + margin.right + margin.left }px`)
    //   .attr('height', `${ margin.top }px`)
    //   .style('fill', 'silver');
    // Borrar
    // svg.append('g')
    //   .attr('transform', `translate(${ 0 }, ${ height - margin.bottom })`)
    //   .append('rect')
    //   .attr('width', `${ size.width + margin.right + margin.left }px`)
    //   .attr('height', `${ margin.top }px`)
    //   .style('fill', 'silver');
    // Borrar
    // svg.append('g')
    //   .attr('transform', `translate(${ 0 }, ${ margin.top + headerSize })`)
    //   .append('rect')
    //   .attr('width', `${ size.width + margin.right + margin.left }px`)
    //   .attr('height', `${ margin.header }px`)
    //   .style('fill', 'silver');

    // Se agregan encabezados
    var encabezado = svg.append('g').attr('id', 'chart-encabezado').attr('transform', 'translate(' + margin.left + ', ' + (margin.top + 15) + ')');
    secciones.forEach(function (v, k) {
      var anchoTotal = size.width + margin.right;

      encabezado.append('text').attr('class', 'chart-encabezado-right').attr('x', function (d) {
        return anchoTotal / 4 * k + anchoNodo / 2 * k + anchoNodo + 10;
      }).text(v).filter(function (d) {
        return k === 0;
      }).attr('x', function (d) {
        return anchoTotal / 4 * k + anchoNodo / 2 * k - 10;
      }).attr('class', 'chart-encabezado-left');
    });

    // Se crea grafico
    var chart = svg.append('g').attr('transform', 'translate(' + margin.left + ', ' + (margin.top + $('#chart-encabezado')[0].getBBox().height + margin.header) + ')');

    // Creación Sankey
    sankeyChartD3 = d3.sankey().nodeWidth(anchoNodo).nodePadding(separacionNodo).size([size.width, size.height]).nodes(data.nodes).links(data.links).layout();

    // Creación de Links
    path = sankeyChartD3.link();

    //  Se crean links
    var link = chart.append('g').attr('id', 'links').selectAll('.link').data(data.links).enter().append('path').attr('d', path).attr('class', 'link').style('stroke-width', function (d) {
      return Math.max(1, d.dy);
    })
    // .on('mouseover', (d) => { d3.select(d3.event.target).style('stroke-opacity', 1); })
    // .on('mouseout', (d) => { d3.select(d3.event.target).style('stroke-opacity', 0.75); })
    .sort(function (a, b) {
      return b.dy - a.dy;
    });

    // link.filter((element) => (element.target.name === 'EXPORTACIONES' || element.target.name === 'CONSUMO PROPIO' || element.target.name === 'TRANSPORTE' || element.target.name === 'PERDIDA'))
    //   .style('stroke', '#BA3F1D');

    // Se crean nodos
    var node = chart.append('g').attr('id', 'nodes').selectAll('.node').data(data.nodes).enter().append('g').attr('id', function (d) {
      return d.id;
    }).attr('class', 'node').attr('transform', function (d) {
      return 'translate(' + d.x + ', ' + d.y + ')';
    }); // error compatibilidad
    // .call(d3.drag().on('drag', dragmove));

    // Se crean rectangulos nodos
    node.append('rect').attr('width', sankeyChartD3.nodeWidth()).attr('height', function (d) {
      return Math.max(5, d.dy);
    }).on('mouseover', fadeIn()).on('mouseout', fadeOut());

    // Se crean textos nodos
    node.append('text').attr('class', 'node-text').attr('x', 10 + sankeyChartD3.nodeWidth()).attr('y', function (d) {
      return d.dy / 2;
    }).attr('dy', '0.35em').text(function (d) {
      return d.name;
    }).filter(function (d) {
      return d.targetLinks.length === 0;
    }).attr('class', 'node-text-start').attr('x', -10);

    // Se agrega texto referencia hover link
    link.append('title').text(function (d) {
      return d.source.name + ' (' + d.source.id + ') \u2192 ' + d.target.name + ' (' + d.target.id + ') \u2192 ' + d.value;
    });
    // Se agrega texto referencia hover node
    // node.append('title').text((d) => `${ d.name } (${ d.id })`);

    // the function for moving the nodes
    function dragmove(d) {
      d3.select(this).attr('transform', 'translate(' + (d.x = Math.max(0, Math.min(size.width - d.dx, d3.event.x))) + ', ' + (d.y = Math.max(0, Math.min(size.height - d.dy, d3.event.y))) + ')');
      sankeyChartD3.relayout();
      link.attr('d', path);
    }
  };

  var actualizarSankey = function actualizarSankey(width, heigth, data, oldLinks) {
    var linksDiff = function linksDiff(links_old, links_new) {
      console.log(links_old);
      console.log(links_new);
      var links = [],
          source = void 0,
          target = void 0;

      links_new.forEach(function (v, k) {
        source = v.source;
        target = v.target;

        links_old.forEach(function (v, k) {
          if (source !== v.source.id || target !== v.target.id) {
            links.push(v);
          }
        });
      });

      return links;
    };

    // let newNodes = nodesDiff(data, sankeyData);
    // let newLinks = linksDiff(oldLinks, data.links);

    // Parametros
    var margin = {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
    var size = {
      width: width - margin.left - margin.right,
      height: heigth - margin.top - margin.bottom
    };

    // Creación Sankey
    sankeyChartD3 = d3.sankey().nodeWidth(20) // Ancho nodo
    .size([size.width, size.height]).nodes(data.nodes).links(data.links).layout(32);

    sankeyChartD3.relayout();

    // Creación de Links
    path = sankeyChartD3.link();
    $('#links').empty();

    var links = d3.select('#links').selectAll('.link').data(data.links).enter();

    links.append('path').attr('class', 'link').attr('d', function (d) {
      return path(d);
    }).style('stroke-width', function (d) {
      return d.dy;
    }).style('stroke', 'gray').on('mouseover', function (d) {
      // console.log(d3.event);
      d3.select(d3.event.target).style('stroke', 'red');
    }).on('mouseout', function (d) {
      d3.select(d3.event.target).style('stroke', 'gray');
    });

    // d3.selectAll('.link')
    //   .data(data.links)
    //   .attr('d', (d) => path(d));
    d3.selectAll('.node').data(data.nodes)
    // .transition()
    .attr('transform', function (d) {
      return 'translate(' + d.x + ', ' + d.y + ')';
    });
    d3.selectAll('rect').data(data.nodes).style('opacity', 0).attr('width', sankeyChartD3.nodeWidth()).attr('height', function (d) {
      return d.dy;
    }).transition().style('opacity', 1);

    // Create Diference
    // newLinks.forEach((v, k) => {
    //   let link = d3.select('#links')
    //     .append('path')
    //       .attr('class', 'link')
    //       .attr('d', () => path(v))
    //       .style('stroke-width', () => Math.max(1, v.dy))
    //       .style('stroke', () => scaleColor(v.source.name.replace(' ', '')))
    //       .sort((a, b) => (b.dy - a.dy));
    //
    //   link.append('title').text(() => `${ v.source.name } → ${ v.target.name } \n ${ formatoNumero(v.value) }`);
    // });
  };
  var maxParent = function maxParent(nodo) {
    // console.log(nodo);
    var parentNode = nodesGlo.filter(function (element) {
      return element.id === nodo.parent;
    })[0];

    if (nodo.parent !== false) {
      if (typeof parentNode !== 'undefined' && parentNode.group === true) {
        return maxParent(nodesGlo.filter(function (element) {
          return element.id === nodo.parent;
        })[0]);
      } else {
        return nodo;
      }
    } else {
      return nodo;
    }
  };
  var deleteEmptyNodes = function deleteEmptyNodes() {
    var del = 0,
        nodesDelete = [],
        status = void 0;

    // moveId = 0;

    nodesGlo.forEach(function (node, nodeI) {
      // console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')');
      status = false;

      // Consulto si el nodo se utiliza en algun link
      linksGlo.forEach(function (link, linkI) {
        if (node.id === link.source) {
          status = true;
          link.source = link.source - del;
        }
        if (node.id === link.target) {
          status = true;
          link.target = link.target - del;
        }
      });

      // // Modificar el ID restando la cantidad de elementos borrados
      // node.id = node.id - del;

      if (!status) {
        // console.log('Borrar');
        nodesDelete.push(nodeI);
        del++;
      }
      // else {
      //   // console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')<-');
      // }
    });

    nodesDelete.reverse().forEach(function (node) {
      nodesGlo.splice(node, 1);
    });

    // moveId = del;
    // nodes.forEach((node, nodeI) => {
    //   console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')');
    // });

    // console.log(links);
    return nodesGlo;
  };

  var declareGroupLinks = function declareGroupLinks() {
    var desarrollo = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

    var links = [],
        source = void 0,
        parentSource = void 0,
        stateSource = void 0,
        target = void 0,
        parentTarget = void 0,
        stateTarget = void 0,
        nodoExistente = void 0,
        addSource = void 0,
        addTarget = void 0,
        addValue = void 0;

    linksGlo.forEach(function (v, k) {
      //Se obtiene source y target del elemento
      source = nodesGlo.filter(function (element) {
        return element.id === parseInt(v.source);
      })[0];
      target = nodesGlo.filter(function (element) {
        return element.id === parseInt(v.target);
      })[0];
      //Se guarda source-padre y target-padre
      parentSource = maxParent(source);
      parentTarget = maxParent(target);
      //Se guarda source-state y target-state
      stateSource = parentSource.group;
      stateTarget = parentTarget.group;
      //Se guarda source y link a crear
      addSource = stateSource ? parentSource : source;
      addTarget = stateTarget ? parentTarget : target;
      addValue = parseInt(v.value);
      //Se consulta si el nodo existe
      nodoExistente = links.filter(function (element) {
        return element.source === addSource.id && element.target === addTarget.id;
      });

      if (nodoExistente.length !== 0) {
        //Se suma valor a duplicado
        nodoExistente[0].value += addValue;
      } else {
        //Se creo nuevo link
        links.push({
          'source': addSource.id,
          'target': addTarget.id,
          'value': addValue
        });
      }
    });
    return links;
  };

  var preSankey = function preSankey() {
    linksGlo = $.extend(true, [], linksOri);
    nodesGlo = $.extend(true, [], nodesOri);
    linksGlo = declareGroupLinks();
    nodesGlo = deleteEmptyNodes();

    dibujarSankey(width, height, { 'nodes': nodesGlo, 'links': linksGlo });
  };

  var init = function init() {

    var downloadFile = function downloadFile() {
      console.log('Se solicitan archivos'); // Borrar

      var formatoSankey = function formatoSankey(elemento, data) {
        var processData = [];

        switch (elemento) {
          case 'nodos':
            data.forEach(function (v, k) {
              processData.push({
                'id': parseInt(v.id),
                'name': v.name,
                'parent': v.parent === 'null' ? false : parseInt(v.parent),
                'category': v.category,
                'pos': parseInt(v.position),
                'group': v.group === 'true' ? true : false,
                'imp': v.importation.split(';').map(function (element) {
                  return parseInt(element);
                }),
                'exp': v.exportation.split(';').map(function (element) {
                  return parseInt(element);
                }),
                'prod': v.production.split(';').map(function (element) {
                  return parseInt(element);
                })
              });
            });
            break;
          case 'links':
            data.forEach(function (v, k) {
              processData.push({
                'source': parseInt(v.source),
                'target': parseInt(v.target),
                'value': parseInt(v.value)
              });
            });
            break;
        }

        return processData;
      };

      var promise = new Promise(function (success) {
        d3.csv('public/src/nodes.csv', function (nodos) {
          nodesOri = formatoSankey('nodos', nodos);

          d3.csv('public/src/links.csv', function (links) {
            linksOri = formatoSankey('links', links);

            success();
          });
        });
      });

      return promise;
    };

    downloadFile().then(function () {
      preSankey();
    });
  };

  init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJjb2xvcmVzIiwic3VidHJhY3RMaWdodCIsImNvbG9yIiwiYW1vdW50IiwiY2MiLCJwYXJzZUludCIsImMiLCJ0b1N0cmluZyIsImxlbmd0aCIsImRhcmtlbiIsImluZGV4T2YiLCJzdWJzdHJpbmciLCIkIiwiaGVpZ2h0Iiwid2lkdGgiLCJub2Rlc09yaSIsImxpbmtzT3JpIiwibm9kZXNHbG8iLCJsaW5rc0dsbyIsInNhbmtleUNoYXJ0RDMiLCJwYXRoIiwic3ZnIiwiY3JlYXRlR3JhZmljbyIsImRhdGEiLCJjb250YWluZXIiLCJtYXJnaW4iLCJ0b3AiLCJyaWdodCIsImJvdHRvbSIsImxlZnQiLCJzaXplIiwieWVhcnMiLCJuZXdEYXRhIiwiZm9yRWFjaCIsInYiLCJrIiwicHVzaCIsImRhdGUiLCJEYXRlIiwidmFsdWUiLCJzdmdHcmFmaWNvIiwiaHRtbCIsImFwcGVuZCIsImF0dHIiLCJ4IiwiZDMiLCJzY2FsZVRpbWUiLCJkb21haW4iLCJleHRlbnQiLCJkIiwicmFuZ2VSb3VuZCIsInkiLCJzY2FsZUxpbmVhciIsImxpbmUiLCJjYWxsIiwiYXhpc0JvdHRvbSIsInN0eWxlIiwiYXhpc0xlZnQiLCJkYXR1bSIsImZhZGVJbiIsImciLCJpIiwiYWxsX2xpbmtzIiwic2VsZWN0QWxsIiwiYWxsX25vZGVzIiwibm9kZXNfaWQiLCJldmVudF9ub2RlIiwiZmlsdGVyIiwiaWQiLCJzZWxlY3QiLCJ0cmFuc2l0aW9uIiwiZmlsdGVyX25vZGVzIiwic3RhdGUiLCJlbGVtZW50IiwiZmlsdGVyX2xpbmtzIiwic291cmNlIiwidGFyZ2V0IiwiZmFkZU91dCIsIm9wYWNpdHkiLCJpZF9ub2RlcyIsImxpbmtzIiwibGlua3NGaWx0ZXIiLCJub2RlcyIsIm5vZGVzRmlsdGVyIiwic291cmNlTGlua3MiLCJsaW5rIiwidGFyZ2V0TGlua3MiLCJzdGF0dXNOb2RlIiwiZHkiLCJub2RlV2lkdGgiLCJkaWJ1amFyU2Fua2V5IiwiaGVpZ3RoIiwiZW1wdHkiLCJoZWFkZXIiLCJoZWFkZXJTaXplIiwic2VjY2lvbmVzIiwiYW5jaG9Ob2RvIiwic2VwYXJhY2lvbk5vZG8iLCJlbmNhYmV6YWRvIiwiYW5jaG9Ub3RhbCIsInRleHQiLCJjaGFydCIsImdldEJCb3giLCJzYW5rZXkiLCJub2RlUGFkZGluZyIsImxheW91dCIsImVudGVyIiwiTWF0aCIsIm1heCIsInNvcnQiLCJhIiwiYiIsIm5vZGUiLCJvbiIsIm5hbWUiLCJkcmFnbW92ZSIsIm1pbiIsImR4IiwiZXZlbnQiLCJyZWxheW91dCIsImFjdHVhbGl6YXJTYW5rZXkiLCJvbGRMaW5rcyIsImxpbmtzRGlmZiIsImxpbmtzX29sZCIsImxpbmtzX25ldyIsImNvbnNvbGUiLCJsb2ciLCJtYXhQYXJlbnQiLCJub2RvIiwicGFyZW50Tm9kZSIsInBhcmVudCIsImdyb3VwIiwiZGVsZXRlRW1wdHlOb2RlcyIsImRlbCIsIm5vZGVzRGVsZXRlIiwic3RhdHVzIiwibm9kZUkiLCJsaW5rSSIsInJldmVyc2UiLCJzcGxpY2UiLCJkZWNsYXJlR3JvdXBMaW5rcyIsImRlc2Fycm9sbG8iLCJwYXJlbnRTb3VyY2UiLCJzdGF0ZVNvdXJjZSIsInBhcmVudFRhcmdldCIsInN0YXRlVGFyZ2V0Iiwibm9kb0V4aXN0ZW50ZSIsImFkZFNvdXJjZSIsImFkZFRhcmdldCIsImFkZFZhbHVlIiwicHJlU2Fua2V5IiwiZXh0ZW5kIiwiaW5pdCIsImRvd25sb2FkRmlsZSIsImZvcm1hdG9TYW5rZXkiLCJlbGVtZW50byIsInByb2Nlc3NEYXRhIiwiY2F0ZWdvcnkiLCJwb3NpdGlvbiIsImltcG9ydGF0aW9uIiwic3BsaXQiLCJtYXAiLCJleHBvcnRhdGlvbiIsInByb2R1Y3Rpb24iLCJwcm9taXNlIiwiUHJvbWlzZSIsInN1Y2Nlc3MiLCJjc3YiLCJub2RvcyIsInRoZW4iXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQSxJQUFNQSxVQUFVLENBQ2QsU0FEYyxFQUVkLFNBRmMsRUFHZCxTQUhjLENBQWhCOztBQU1B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QUFQLEVBQ0UsVUFBQ3ZGLEtBQUQsRUFBVztBQUNUaEUsdUJBQVcwSSxjQUFjLE9BQWQsRUFBdUIxRSxLQUF2QixDQUFYOztBQUVBc0Y7QUFDRCxXQUxIO0FBT0QsU0FYSDtBQWFELE9BZGEsQ0FBZDs7QUFnQkEsYUFBT0YsT0FBUDtBQUNELEtBckREOztBQXVEQVgsbUJBQWVnQixJQUFmLENBQW9CLFlBQU07QUFDeEJuQjtBQUNELEtBRkQ7QUFHRCxHQTVERDs7QUE4REpFO0FBQ0QsQ0EvbUJEIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFZBUklBQkxFUyBHTE9CQUxFU1xuY29uc3QgY29sb3JlcyA9IFtcbiAgJyMwMDc1QzknLFxuICAnIzAwOUREQScsXG4gICcjMDBCNUU0J1xuXTtcblxuLy8gIEZ1bmNpb25lc1xuLy8gY29uc3QgZm9ybWF0b051bWVybyA9IChkKSA9PiB7XG4vLyAgIGxldCBmb3JtYXQgPSBkMy5mb3JtYXQoJywuMGYnKTtcbi8vXG4vLyAgIHJldHVybiBgJHsgZm9ybWF0KGQpIH0gVHdoYDtcbi8vIH07XG5cbi8qIFJlc3RhIGVsIHBvcmNlbnRhamUgaW5kaWNhZG8gYSB1biBjb2xvciAoUlIsIEdHIG8gQkIpIGhleGFkZWNpbWFsIHBhcmEgb3NjdXJlY2VybG8gKi9cbmNvbnN0IHN1YnRyYWN0TGlnaHQgPSBmdW5jdGlvbihjb2xvciwgYW1vdW50KXtcbiAgbGV0IGNjID0gcGFyc2VJbnQoY29sb3IsMTYpIC0gYW1vdW50O1xuICBsZXQgYyA9IChjYyA8IDApID8gMCA6IChjYyk7XG4gIGMgPSAoYy50b1N0cmluZygxNikubGVuZ3RoID4gMSApID8gYy50b1N0cmluZygxNikgOiBgMCR7Yy50b1N0cmluZygxNil9YDtcblxuICByZXR1cm4gYztcbn07XG5cbi8qIE9zY3VyZWNlIHVuIGNvbG9yIGhleGFkZWNpbWFsIGRlIDYgY2FyYWN0ZXJlcyAjUlJHR0JCIHNlZ3VuIGVsIHBvcmNlbnRhamUgaW5kaWNhZG8gKi9cbmNvbnN0IGRhcmtlbiA9IChjb2xvciwgYW1vdW50KSA9PntcbiAgY29sb3IgPSAoY29sb3IuaW5kZXhPZignIycpPj0wKSA/IGNvbG9yLnN1YnN0cmluZygxLGNvbG9yLmxlbmd0aCkgOiBjb2xvcjtcbiAgYW1vdW50ID0gcGFyc2VJbnQoKDI1NSphbW91bnQpLzEwMCk7XG4gIGNvbG9yID0gYCMke3N1YnRyYWN0TGlnaHQoY29sb3Iuc3Vic3RyaW5nKDAsMiksIGFtb3VudCl9JHtzdWJ0cmFjdExpZ2h0KGNvbG9yLnN1YnN0cmluZygyLDQpLCBhbW91bnQpfSR7c3VidHJhY3RMaWdodChjb2xvci5zdWJzdHJpbmcoNCw2KSwgYW1vdW50KX1gO1xuXG4gIHJldHVybiBjb2xvcjtcbn07XG5cbiQoKCkgPT4ge1xuXG4gIGxldCBoZWlnaHQgICAgICA9ICQoJyNzYW5rZXknKS5oZWlnaHQoKSxcbiAgICAgIHdpZHRoICAgICAgID0gJCgnI3NhbmtleScpLndpZHRoKCksXG4gICAgICAvLyBjbGF2ZXNOb2RvcyA9IFtdLFxuICAgICAgLy8gZGF0YVNhbmtleSAgPSB7fSxcbiAgICAgIC8vIG1vdmVJZCA9IDAsXG4gICAgICBub2Rlc09yaSwgbGlua3NPcmksXG4gICAgICBub2Rlc0dsbywgbGlua3NHbG8sXG4gICAgICBzYW5rZXlDaGFydEQzLCBwYXRoLCBzdmc7XG5cbiAgLy8gIEZ1bmNpb25lc1xuICAgICAgLy8gY29uc3QgZ2VuZXJhclB1ZXJ0YXMgICAgPSAoKSA9PiB7XG4gICAgICAvLyAgIGRhdGFTYW5rZXkubm9kZXMuZmlsdGVyKChlbGVtZW50KSA9PiAoZWxlbWVudC5wYXJlbnQgPT09IGZhbHNlKSkuZm9yRWFjaCgodiwgaykgPT4ge1xuICAgICAgLy8gICAgIGNsYXZlc05vZG9zLnB1c2goeyAnaWQnOiB2LmlkLCAnc3RhdGUnOiB0cnVlIH0pO1xuICAgICAgLy8gICB9KTtcbiAgICAgIC8vIH07XG4gICAgICBjb25zdCBjcmVhdGVHcmFmaWNvID0gKGRhdGEsIGNvbnRhaW5lcikgPT4ge1xuICAgICAgICAvLyBWYXJpYWJsZXNcbiAgICAgICAgbGV0IG1hcmdpbiA9IHsgdG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwLCBsZWZ0OiAwIH07XG4gICAgICAgIGxldCBzaXplID0geyB3aWR0aDogKDMwMCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0KSwgaGVpZ2h0OiAoNTAgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbSkgfTtcbiAgICAgICAgbGV0IHllYXJzID0gWycyMDEyJywgJzIwMTMnLCAnMjAxNCcsICcyMDE1JywgJzIwMTYnLCAnMjAxNyddO1xuICAgICAgICBsZXQgbmV3RGF0YSA9IFtdO1xuXG4gICAgICAgIGRhdGEuZm9yRWFjaCgodiwgaykgPT4geyBuZXdEYXRhLnB1c2goeyBkYXRlOiBuZXcgRGF0ZSh5ZWFyc1trXSksIHZhbHVlOiB2IH0pOyB9KTtcblxuICAgICAgICBsZXQgc3ZnR3JhZmljbyA9IGNvbnRhaW5lci5odG1sKCcnKS5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgLmF0dHIoJ3dpZHRoJywgc2l6ZS53aWR0aCArIG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBzaXplLmhlaWdodCArIG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKVxuICAgICAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHsgbWFyZ2luLmxlZnQgfSwgJHsgbWFyZ2luLnRvcCB9KWApO1xuXG4gICAgICAgIC8vIGxldCBwYXJzZVRpbWUgPSBkMy50aW1lUGFyc2UoJyVkLSViLSV5Jyk7XG5cbiAgICAgICAgbGV0IHggPSBkMy5zY2FsZVRpbWUoKVxuICAgICAgICAgIC5kb21haW4oZDMuZXh0ZW50KG5ld0RhdGEsIChkKSA9PiBkLmRhdGUpKVxuICAgICAgICAgIC5yYW5nZVJvdW5kKFswLCBzaXplLndpZHRoXSk7XG4gICAgICAgIGxldCB5ID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgICAgICAgIC5kb21haW4oZDMuZXh0ZW50KG5ld0RhdGEsIChkKSA9PiBkLnZhbHVlKSlcbiAgICAgICAgICAucmFuZ2VSb3VuZChbc2l6ZS5oZWlnaHQsIDBdKTtcblxuXG4gICAgICAgIGxldCBsaW5lID0gZDMubGluZSgpLngoKGQpID0+IHgoZC5kYXRlKSkueSgoZCkgPT4geShkLnZhbHVlKSk7XG5cbiAgICAgICAgc3ZnR3JhZmljby5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5jYWxsKGQzLmF4aXNCb3R0b20oeCkpXG4gICAgICAgICAgLnN0eWxlKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDBweCwgJHsgc2l6ZS5oZWlnaHQgLSAxIH1weClgKTtcblxuICAgICAgICBzdmdHcmFmaWNvLmFwcGVuZCgnZycpXG4gICAgICAgICAgLmNhbGwoZDMuYXhpc0xlZnQoeSkpO1xuICAgICAgICAvLyAuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgLy8gICAuYXR0cignZmlsbCcsICcjMDAwJylcbiAgICAgICAgLy8gICAuYXR0cigndHJhbnNmb3JtJywgJ3JvdGF0ZSgtOTApJylcbiAgICAgICAgLy8gICAuYXR0cigneScsIDYpXG4gICAgICAgIC8vICAgLmF0dHIoJ2R5JywgJzAuNzFlbScpXG4gICAgICAgIC8vICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ2VuZCcpXG4gICAgICAgIC8vICAgLnRleHQoJ1ByaWNlICgkKScpO1xuXG4gICAgICAgIHN2Z0dyYWZpY28uYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAuZGF0dW0obmV3RGF0YSlcbiAgICAgICAgICAuYXR0cignZmlsbCcsICdub25lJylcbiAgICAgICAgICAuYXR0cignc3Ryb2tlJywgJ3N0ZWVsYmx1ZScpXG4gICAgICAgICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgICAgICAgLmF0dHIoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJylcbiAgICAgICAgICAuYXR0cignc3Ryb2tlLXdpZHRoJywgMS41KVxuICAgICAgICAgIC5hdHRyKCdkJywgbGluZSk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBmYWRlSW4gPSAoKSA9PiAoZywgaSkgPT4ge1xuICAgICAgICBsZXQgYWxsX2xpbmtzID0gZDMuc2VsZWN0QWxsKCcjc2Fua2V5IC5saW5rJyksXG4gICAgICAgICAgICBhbGxfbm9kZXMgPSBkMy5zZWxlY3RBbGwoJyNzYW5rZXkgLm5vZGUnKSxcbiAgICAgICAgICAgIG5vZGVzX2lkICA9IFtdO1xuXG4gICAgICAgIGxldCBldmVudF9ub2RlID0gYWxsX25vZGVzLmZpbHRlcigoZCkgPT4gKGQuaWQgPT09IGcuaWQpKTtcbiAgICAgICAgZXZlbnRfbm9kZS5zZWxlY3QoJ3JlY3QnKVxuICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAnYmxhY2snKVxuICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJ2JsYWNrJyk7XG4gICAgICAgIGV2ZW50X25vZGUuc2VsZWN0KCd0ZXh0JylcbiAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLnN0eWxlKCdmaWxsJywgJ2JsYWNrJyk7XG5cbiAgICAgICAgbGV0IGZpbHRlcl9ub2RlcyA9IGFsbF9ub2Rlcy5maWx0ZXIoKGQpID0+IHtcbiAgICAgICAgICBsZXQgc3RhdGUgPSBmYWxzZTtcblxuICAgICAgICAgIG5vZGVzX2lkLmZvckVhY2goKGVsZW1lbnQpID0+IHsgaWYoZC5pZCA9PT0gZWxlbWVudCkgeyBzdGF0ZSA9IHRydWU7IH0gfSk7XG5cbiAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgIH0pO1xuICAgICAgICBmaWx0ZXJfbm9kZXMuc2VsZWN0KCdyZWN0JylcbiAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLnN0eWxlKCdmaWxsJywgJ2JsYWNrJylcbiAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsICdibGFjaycpO1xuICAgICAgICBmaWx0ZXJfbm9kZXMuc2VsZWN0KCd0ZXh0JylcbiAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLnN0eWxlKCdmaWxsJywgJ2JsYWNrJyk7XG5cbiAgICAgICAgbGV0IGZpbHRlcl9saW5rcyA9IGFsbF9saW5rcy5maWx0ZXIoKGQpID0+IHtcbiAgICAgICAgICBsZXQgc3RhdGUgPSB0cnVlO1xuXG4gICAgICAgICAgaWYgKGQuc291cmNlLmlkID09PSBnLmlkKSB7XG4gICAgICAgICAgICBub2Rlc19pZC5wdXNoKGQudGFyZ2V0LmlkKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGQudGFyZ2V0LmlkID09PSBnLmlkKSB7XG4gICAgICAgICAgICBub2Rlc19pZC5wdXNoKGQuc291cmNlLmlkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhdGUgPSBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICAgIH0pO1xuICAgICAgICBmaWx0ZXJfbGlua3MudHJhbnNpdGlvbigpXG4gICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCAnIzAwNzVDOScpXG4gICAgICAgICAgLnN0eWxlKCdzdHJva2Utb3BhY2l0eScsIDAuNSk7ICAgICAgICBcbiAgICAgIH07XG4gICAgICBjb25zdCBmYWRlT3V0ID0gKG9wYWNpdHkpID0+IChnLCBpKSA9PiB7XG5cbiAgICAgICAgbGV0IGlkX25vZGVzID0gW10sXG4gICAgICAgICAgICBsaW5rcyxcbiAgICAgICAgICAgIGxpbmtzRmlsdGVyLFxuICAgICAgICAgICAgbm9kZXMsXG4gICAgICAgICAgICBub2Rlc0ZpbHRlcjtcblxuICAgICAgICAvLyBhZGQgZXZlbnQgbm9kZVxuICAgICAgICBpZF9ub2Rlcy5wdXNoKGcuaWQpO1xuICAgICAgICAvLyBhZGQgc291cmNlTGlua3NcbiAgICAgICAgZy5zb3VyY2VMaW5rcy5mb3JFYWNoKChsaW5rKSA9PiB7IGlkX25vZGVzLnB1c2gobGluay50YXJnZXQuaWQpOyB9KTtcbiAgICAgICAgLy8gYWRkIHRhcmdldExpbmtzXG4gICAgICAgIGcudGFyZ2V0TGlua3MuZm9yRWFjaCgobGluaykgPT4geyBpZF9ub2Rlcy5wdXNoKGxpbmsuc291cmNlLmlkKTsgfSk7XG5cbiAgICAgICAgLy8gc2VsZWN0IGxpbmtzXG4gICAgICAgIGxpbmtzID0gZDMuc2VsZWN0QWxsKCcjc2Fua2V5IC5saW5rJyk7XG4gICAgICAgIC8vICBsaW5rcyBmb2N1c0luXG4gICAgICAgIC8vIGQzLnNlbGVjdEFsbCgnI3NhbmtleSAubGluaycpXG4gICAgICAgIC8vICAgLmZpbHRlcigoZCkgPT4gKGQuc291cmNlLmlkID09PSBnLmlkIHx8IGQudGFyZ2V0LmlkID09PSBnLmlkKSlcbiAgICAgICAgLy8gICAudHJhbnNpdGlvbigpLnN0eWxlKCdzdHJva2Utb3BhY2l0eScsIC43NSk7XG4gICAgICAgIC8vIGxpbmtzIGZvY3VzT3V0XG4gICAgICAgIGxpbmtzRmlsdGVyID0gbGlua3MuZmlsdGVyKChkKSA9PiAoZC5zb3VyY2UuaWQgIT09IGcuaWQgJiYgZC50YXJnZXQuaWQgIT09IGcuaWQpKTtcbiAgICAgICAgbGlua3NGaWx0ZXIudHJhbnNpdGlvbigpLnN0eWxlKCdzdHJva2Utb3BhY2l0eScsIDAuMjUpO1xuXG4gICAgICAgIC8vICBzZWxlY3Qgbm9kZXNcbiAgICAgICAgbm9kZXMgPSBkMy5zZWxlY3RBbGwoJyNzYW5rZXkgLm5vZGUnKTtcbiAgICAgICAgLy8gbm9kZXMgZm9jdXNJblxuICAgICAgICBub2Rlc0ZpbHRlciA9IG5vZGVzLmZpbHRlcigoZCkgPT4ge1xuICAgICAgICAgIGxldCBzdGF0dXNOb2RlID0gZmFsc2U7XG5cbiAgICAgICAgICBpZF9ub2Rlcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7IGlmIChlbGVtZW50ID09PSBkLmlkKSB7IHN0YXR1c05vZGUgPSB0cnVlOyB9IH0pO1xuXG4gICAgICAgICAgcmV0dXJuIHN0YXR1c05vZGU7XG4gICAgICAgIH0pO1xuICAgICAgICBub2Rlc0ZpbHRlci5zZWxlY3QoJ3JlY3QnKVxuICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAoZCkgPT4gJ3doaXRlJyk7XG4gICAgICAgICAgLy8gLnN0eWxlKCdmaWxsJywgKGQpID0+IGNvbG9yZXNbZC5wb3MgLSAxXSk7XG4gICAgICAgIG5vZGVzRmlsdGVyLnNlbGVjdCgndGV4dCcpXG4gICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdlbmQnKVxuICAgICAgICAgIC5hdHRyKCd5JywgKGQpID0+IChkLmR5IC8gMikpLmF0dHIoJ3gnLCAtMTApXG4gICAgICAgICAgLy8gLnRleHQoKGQpID0+IChkLm5hbWUubGVuZ3RoID4gOCkgPyAoZC5uYW1lLnN1YnN0cmluZygwLCA1KSArICcuLi4nKSA6IChkLm5hbWUpKVxuICAgICAgICAgIC5maWx0ZXIoKGQpID0+IChkLnggPCB3aWR0aCAvIDIpKVxuICAgICAgICAgICAgLmF0dHIoJ3gnLCAxMCArIHNhbmtleUNoYXJ0RDMubm9kZVdpZHRoKCkpXG4gICAgICAgICAgICAuYXR0cigndGV4dC1hbmNob3InLCAnc3RhcnQnKTtcbiAgICAgICAgLy8gbm9kZXMgZm9jdXNPdXRcbiAgICAgICAgbm9kZXNGaWx0ZXIgPSBub2Rlcy5maWx0ZXIoKGQpID0+IHtcbiAgICAgICAgICBsZXQgc3RhdHVzTm9kZSA9IHRydWU7XG5cbiAgICAgICAgICBpZF9ub2Rlcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7IGlmIChlbGVtZW50ID09PSBkLmlkKSB7IHN0YXR1c05vZGUgPSBmYWxzZTsgfSB9KTtcblxuICAgICAgICAgIHJldHVybiBzdGF0dXNOb2RlO1xuICAgICAgICB9KTtcbiAgICAgICAgbm9kZXNGaWx0ZXIudHJhbnNpdGlvbigpLnN0eWxlKCdvcGFjaXR5JywgMSk7XG4gICAgICB9O1xuICAgICAgLy8gY29uc3QgY29sYXBzYXJFeHBhbmRpck5vZG8gPSAobm9kbykgPT4ge1xuICAgICAgLy9cbiAgICAgIC8vICAgbm9kZXNPcmlbbm9kby5pZF0uZ3JvdXAgPSAobm9kZXNPcmlbbm9kby5pZF0uZ3JvdXApID8gKGZhbHNlKSA6ICh0cnVlKTtcbiAgICAgIC8vXG4gICAgICAvLyAgIHJldHVybiBub2Rlc09yaTtcbiAgICAgIC8vXG4gICAgICAvL1xuICAgICAgLy8gICAvLyBsZXQgb2xkTGlua3MgPSBkYXRhU2Fua2V5LmxpbmtzO1xuICAgICAgLy9cbiAgICAgIC8vICAgLy8gaWYgKG5vZG8ucGFyZW50ID09PSBmYWxzZSkge1xuICAgICAgLy8gICAvLyAgIGNvbnNvbGUubG9nKCdTZSBleHBhbmRlIG5vZG8nKTtcbiAgICAgIC8vICAgLy8gICBjbGF2ZXNOb2Rvcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7IGlmIChlbGVtZW50LmlkID09PSBub2RvLmlkICsgbW92ZUlkKSB7IGVsZW1lbnQuc3RhdGUgPSBmYWxzZTsgfSB9KTtcbiAgICAgIC8vICAgLy9cbiAgICAgIC8vICAgLy8gICBkYXRhU2Fua2V5Lm5vZGVzID0gbm9kb3NPcmlnaW5hbGVzO1xuICAgICAgLy8gICAvLyAgIGRhdGFTYW5rZXkubGlua3MgPSBsaW5rc09yaWdpbmFsZXM7XG4gICAgICAvLyAgIC8vXG4gICAgICAvLyAgIC8vICAgZGF0YVNhbmtleS5saW5rcyA9IGRlY2xhcmVHcm91cExpbmtzKGRhdGFTYW5rZXkubGlua3MsIHRydWUpO1xuICAgICAgLy8gICAvL1xuICAgICAgLy8gICAvLyAgIGRhdGFTYW5rZXkgPSBidXNjYXJOb2RlcyhkYXRhU2Fua2V5Lm5vZGVzLCBkYXRhU2Fua2V5LmxpbmtzKTtcbiAgICAgIC8vICAgLy8gICBtb3ZlSWQgPSAwO1xuICAgICAgLy8gICAvLyAgICQoJyNzYW5rZXknKS5lbXB0eSgpO1xuICAgICAgLy8gICAvLyAgIGRpYnVqYXJTYW5rZXkod2lkdGgsIGhlaWdodCwgZGF0YVNhbmtleSk7XG4gICAgICAvLyAgIC8vICAgLy8gYWN0dWFsaXphclNhbmtleSgkKCcjY29udGVudCcpLndpZHRoKCksICQoJyNjb250ZW50JykuaGVpZ2h0KCksIGRhdGFTYW5rZXksIG9sZExpbmtzKTtcbiAgICAgIC8vICAgLy8gfSBlbHNlIHtcbiAgICAgIC8vICAgLy8gICBjb25zb2xlLmxvZygnU2UgY29sYXBzYSBub2RvJyk7XG4gICAgICAvLyAgIC8vICAgLy8gbGV0IHBhcmVudCA9IGRhdGFTYW5rZXkubm9kZXMuZmlsdGVyKChlbGVtZW50KSA9PiAoZWxlbWVudC5uYW1lID09PSBub2RvLnBhcmVudCkpWzBdO1xuICAgICAgLy8gICAvLyAgIC8vIGNsYXZlc05vZG9zLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQuaWQgPT09IHBhcmVudC5pZCkpWzBdLnN0YXRlID0gdHJ1ZTtcbiAgICAgIC8vICAgLy8gICAvL1xuICAgICAgLy8gICAvLyAgIC8vIGRhdGFTYW5rZXkgPSBidXNjYXJOb2Rlcyhub2Rvc09yaWdpbmFsZXMsIGRhdGFTYW5rZXkubGlua3MgPSBkZWNsYXJlR3JvdXBMaW5rcyhsaW5rc09yaWdpbmFsZXMpKTtcbiAgICAgIC8vICAgLy8gICAvL1xuICAgICAgLy8gICAvLyAgIC8vICQoJyNzYW5rZXknKS5lbXB0eSgpO1xuICAgICAgLy8gICAvLyAgIC8vIGRpYnVqYXJTYW5rZXkod2lkdGgsIGhlaWdodCwgZGF0YVNhbmtleSk7XG4gICAgICAvLyAgIC8vICAgLy8gYWN0dWFsaXphclNhbmtleSgkKCcjY29udGVudCcpLndpZHRoKCksICQoJyNjb250ZW50JykuaGVpZ2h0KCksIGRhdGFTYW5rZXksIG9sZExpbmtzKTtcbiAgICAgIC8vICAgLy8gfVxuICAgICAgLy8gfTtcblxuICAgICAgY29uc3QgZGlidWphclNhbmtleSA9ICh3aWR0aCwgaGVpZ3RoLCBkYXRhKSA9PiB7XG5cbiAgICAgICAgLy8gU2UgdmFjaWEgY29udGVuZWRvclxuICAgICAgICAkKCcjc2Fua2V5JykuZW1wdHkoKTtcblxuICAgICAgICAvLyBTZSBkZWZpbmVuIHZhcmlhYmxlc1xuICAgICAgICBsZXQgbWFyZ2luID0ge1xuICAgICAgICAgIHRvcDogNDAsXG4gICAgICAgICAgcmlnaHQ6IDIwMCxcbiAgICAgICAgICBib3R0b206IDQwLFxuICAgICAgICAgIGxlZnQ6IDIwMCxcbiAgICAgICAgICBoZWFkZXI6IDIwXG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlclNpemUgPSAxOSxcbiAgICAgICAgc2l6ZSA9IHtcbiAgICAgICAgICB3aWR0aDogKCgod2lkdGggPCAxNDAwKT8od2lkdGgpOigxNDAwKSkgLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodCksXG4gICAgICAgICAgaGVpZ2h0OiAoaGVpZ3RoIC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b20gLSBtYXJnaW4uaGVhZGVyIC0gaGVhZGVyU2l6ZSlcbiAgICAgICAgfSxcbiAgICAgICAgc2VjY2lvbmVzID0gW1xuICAgICAgICAgICdFTkVSR8ONQVMgUFJJTUFSSUFTJyxcbiAgICAgICAgICAnUExBTlRBUyBERSBUUkFUQU1JRU5UTycsXG4gICAgICAgICAgJ0VORVJHw41BUyBTRUNVTkRBUklBUycsXG4gICAgICAgICAgJ0NPTlNVTU9TJ1xuICAgICAgICBdLFxuICAgICAgICBhbmNob05vZG8gPSAyMCxcbiAgICAgICAgc2VwYXJhY2lvbk5vZG8gPSAyMDtcblxuICAgICAgICAvLyBDcmVhY2nDs24gU1ZHXG4gICAgICAgIHN2ZyA9IGQzLnNlbGVjdCgnI3NhbmtleScpXG4gICAgICAgICAgLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAuYXR0cignd2lkdGgnLCBzaXplLndpZHRoICsgbWFyZ2luLnJpZ2h0ICsgbWFyZ2luLmxlZnQpXG4gICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIHNpemUuaGVpZ2h0ICsgbWFyZ2luLnRvcCArIG1hcmdpbi5ib3R0b20gKyBtYXJnaW4uaGVhZGVyICsgaGVhZGVyU2l6ZSk7XG5cbiAgICAgICAgLy8gQm9ycmFyXG4gICAgICAgIC8vIHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAvLyAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7IDAgfSwgJHsgMCB9KWApXG4gICAgICAgIC8vICAgLmFwcGVuZCgncmVjdCcpXG4gICAgICAgIC8vICAgLmF0dHIoJ3dpZHRoJywgYCR7IHNpemUud2lkdGggKyBtYXJnaW4ucmlnaHQgKyBtYXJnaW4ubGVmdCB9cHhgKVxuICAgICAgICAvLyAgIC5hdHRyKCdoZWlnaHQnLCBgJHsgbWFyZ2luLnRvcCB9cHhgKVxuICAgICAgICAvLyAgIC5zdHlsZSgnZmlsbCcsICdzaWx2ZXInKTtcbiAgICAgICAgLy8gQm9ycmFyXG4gICAgICAgIC8vIHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAvLyAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7IDAgfSwgJHsgaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSB9KWApXG4gICAgICAgIC8vICAgLmFwcGVuZCgncmVjdCcpXG4gICAgICAgIC8vICAgLmF0dHIoJ3dpZHRoJywgYCR7IHNpemUud2lkdGggKyBtYXJnaW4ucmlnaHQgKyBtYXJnaW4ubGVmdCB9cHhgKVxuICAgICAgICAvLyAgIC5hdHRyKCdoZWlnaHQnLCBgJHsgbWFyZ2luLnRvcCB9cHhgKVxuICAgICAgICAvLyAgIC5zdHlsZSgnZmlsbCcsICdzaWx2ZXInKTtcbiAgICAgICAgLy8gQm9ycmFyXG4gICAgICAgIC8vIHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAvLyAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7IDAgfSwgJHsgbWFyZ2luLnRvcCArIGhlYWRlclNpemUgfSlgKVxuICAgICAgICAvLyAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAvLyAgIC5hdHRyKCd3aWR0aCcsIGAkeyBzaXplLndpZHRoICsgbWFyZ2luLnJpZ2h0ICsgbWFyZ2luLmxlZnQgfXB4YClcbiAgICAgICAgLy8gICAuYXR0cignaGVpZ2h0JywgYCR7IG1hcmdpbi5oZWFkZXIgfXB4YClcbiAgICAgICAgLy8gICAuc3R5bGUoJ2ZpbGwnLCAnc2lsdmVyJyk7XG5cbiAgICAgICAgLy8gU2UgYWdyZWdhbiBlbmNhYmV6YWRvc1xuICAgICAgICBsZXQgZW5jYWJlemFkbyA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdpZCcsICdjaGFydC1lbmNhYmV6YWRvJylcbiAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgkeyBtYXJnaW4ubGVmdCB9LCAkeyBtYXJnaW4udG9wICsgMTUgfSlgKTtcbiAgICAgICAgc2VjY2lvbmVzLmZvckVhY2goKHYsIGspID0+IHtcbiAgICAgICAgICBsZXQgYW5jaG9Ub3RhbCA9IHNpemUud2lkdGggKyBtYXJnaW4ucmlnaHQ7XG5cbiAgICAgICAgICBlbmNhYmV6YWRvLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2hhcnQtZW5jYWJlemFkby1yaWdodCcpXG4gICAgICAgICAgICAuYXR0cigneCcsIChkKSA9PiAoKChhbmNob1RvdGFsIC8gNCkgKiBrKSArICgoYW5jaG9Ob2RvIC8gMikgKiBrKSArIGFuY2hvTm9kbyArIDEwKSlcbiAgICAgICAgICAgIC50ZXh0KHYpXG4gICAgICAgICAgICAuZmlsdGVyKChkKSA9PiAoayA9PT0gMCkpXG4gICAgICAgICAgICAuYXR0cigneCcsIChkKSA9PiAoKChhbmNob1RvdGFsIC8gNCkgKiBrKSArICgoYW5jaG9Ob2RvIC8gMikgKiBrKSAtIDEwKSlcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjaGFydC1lbmNhYmV6YWRvLWxlZnQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2UgY3JlYSBncmFmaWNvXG4gICAgICAgIGxldCBjaGFydCA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7IG1hcmdpbi5sZWZ0IH0sICR7IG1hcmdpbi50b3AgKyAkKCcjY2hhcnQtZW5jYWJlemFkbycpWzBdLmdldEJCb3goKS5oZWlnaHQgKyBtYXJnaW4uaGVhZGVyIH0pYCk7XG5cbiAgICAgICAgLy8gQ3JlYWNpw7NuIFNhbmtleVxuICAgICAgICBzYW5rZXlDaGFydEQzID0gZDMuc2Fua2V5KClcbiAgICAgICAgICAubm9kZVdpZHRoKGFuY2hvTm9kbylcbiAgICAgICAgICAubm9kZVBhZGRpbmcoc2VwYXJhY2lvbk5vZG8pXG4gICAgICAgICAgLnNpemUoW3NpemUud2lkdGgsIHNpemUuaGVpZ2h0XSlcbiAgICAgICAgICAubm9kZXMoZGF0YS5ub2RlcylcbiAgICAgICAgICAubGlua3MoZGF0YS5saW5rcylcbiAgICAgICAgICAubGF5b3V0KCk7XG5cbiAgICAgICAgLy8gQ3JlYWNpw7NuIGRlIExpbmtzXG4gICAgICAgIHBhdGggPSBzYW5rZXlDaGFydEQzLmxpbmsoKTtcblxuICAgICAgICAvLyAgU2UgY3JlYW4gbGlua3NcbiAgICAgICAgbGV0IGxpbmsgPSBjaGFydC5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdpZCcsICdsaW5rcycpXG4gICAgICAgICAgLnNlbGVjdEFsbCgnLmxpbmsnKVxuICAgICAgICAgIC5kYXRhKGRhdGEubGlua3MpXG4gICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAuYXR0cignZCcsIHBhdGgpXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xpbmsnKVxuICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgKGQpID0+IE1hdGgubWF4KDEsIGQuZHkpKVxuICAgICAgICAgIC8vIC5vbignbW91c2VvdmVyJywgKGQpID0+IHsgZDMuc2VsZWN0KGQzLmV2ZW50LnRhcmdldCkuc3R5bGUoJ3N0cm9rZS1vcGFjaXR5JywgMSk7IH0pXG4gICAgICAgICAgLy8gLm9uKCdtb3VzZW91dCcsIChkKSA9PiB7IGQzLnNlbGVjdChkMy5ldmVudC50YXJnZXQpLnN0eWxlKCdzdHJva2Utb3BhY2l0eScsIDAuNzUpOyB9KVxuICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiAoYi5keSAtIGEuZHkpKTtcblxuICAgICAgICAgIC8vIGxpbmsuZmlsdGVyKChlbGVtZW50KSA9PiAoZWxlbWVudC50YXJnZXQubmFtZSA9PT0gJ0VYUE9SVEFDSU9ORVMnIHx8IGVsZW1lbnQudGFyZ2V0Lm5hbWUgPT09ICdDT05TVU1PIFBST1BJTycgfHwgZWxlbWVudC50YXJnZXQubmFtZSA9PT0gJ1RSQU5TUE9SVEUnIHx8IGVsZW1lbnQudGFyZ2V0Lm5hbWUgPT09ICdQRVJESURBJykpXG4gICAgICAgICAgLy8gICAuc3R5bGUoJ3N0cm9rZScsICcjQkEzRjFEJyk7XG5cbiAgICAgICAgLy8gU2UgY3JlYW4gbm9kb3NcbiAgICAgICAgbGV0IG5vZGUgPSBjaGFydC5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdpZCcsICdub2RlcycpXG4gICAgICAgICAgLnNlbGVjdEFsbCgnLm5vZGUnKVxuICAgICAgICAgIC5kYXRhKGRhdGEubm9kZXMpXG4gICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAuYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCdpZCcsIChkKSA9PiBkLmlkKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ25vZGUnKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIChkKSA9PiBgdHJhbnNsYXRlKCR7IGQueCB9LCAkeyBkLnkgfSlgKTsgLy8gZXJyb3IgY29tcGF0aWJpbGlkYWRcbiAgICAgICAgICAgIC8vIC5jYWxsKGQzLmRyYWcoKS5vbignZHJhZycsIGRyYWdtb3ZlKSk7XG5cbiAgICAgICAgLy8gU2UgY3JlYW4gcmVjdGFuZ3Vsb3Mgbm9kb3NcbiAgICAgICAgbm9kZS5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgc2Fua2V5Q2hhcnREMy5ub2RlV2lkdGgoKSlcbiAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCAoZCkgPT4gTWF0aC5tYXgoNSwgZC5keSkpXG4gICAgICAgICAgICAub24oJ21vdXNlb3ZlcicsIGZhZGVJbigpKVxuICAgICAgICAgICAgLm9uKCdtb3VzZW91dCcsIGZhZGVPdXQoKSk7XG5cbiAgICAgICAgLy8gU2UgY3JlYW4gdGV4dG9zIG5vZG9zXG4gICAgICAgIG5vZGUuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAuYXR0cignY2xhc3MnLCAnbm9kZS10ZXh0JylcbiAgICAgICAgICAuYXR0cigneCcsIDEwICsgc2Fua2V5Q2hhcnREMy5ub2RlV2lkdGgoKSlcbiAgICAgICAgICAuYXR0cigneScsIChkKSA9PiAoZC5keSAvIDIpKVxuICAgICAgICAgIC5hdHRyKCdkeScsICcwLjM1ZW0nKVxuICAgICAgICAgIC50ZXh0KChkKSA9PiAoZC5uYW1lKSlcbiAgICAgICAgICAuZmlsdGVyKChkKSA9PiAoZC50YXJnZXRMaW5rcy5sZW5ndGggPT09IDApKVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdub2RlLXRleHQtc3RhcnQnKVxuICAgICAgICAgIC5hdHRyKCd4JywgLTEwKTtcblxuICAgICAgICAvLyBTZSBhZ3JlZ2EgdGV4dG8gcmVmZXJlbmNpYSBob3ZlciBsaW5rXG4gICAgICAgIGxpbmsuYXBwZW5kKCd0aXRsZScpLnRleHQoKGQpID0+IGAkeyBkLnNvdXJjZS5uYW1lIH0gKCR7IGQuc291cmNlLmlkIH0pIOKGkiAkeyBkLnRhcmdldC5uYW1lIH0gKCR7IGQudGFyZ2V0LmlkIH0pIOKGkiAkeyBkLnZhbHVlIH1gKTtcbiAgICAgICAgLy8gU2UgYWdyZWdhIHRleHRvIHJlZmVyZW5jaWEgaG92ZXIgbm9kZVxuICAgICAgICAvLyBub2RlLmFwcGVuZCgndGl0bGUnKS50ZXh0KChkKSA9PiBgJHsgZC5uYW1lIH0gKCR7IGQuaWQgfSlgKTtcblxuICAgICAgICAvLyB0aGUgZnVuY3Rpb24gZm9yIG1vdmluZyB0aGUgbm9kZXNcbiAgICAgICAgZnVuY3Rpb24gZHJhZ21vdmUoZCkge1xuICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7IGQueCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHNpemUud2lkdGggLSBkLmR4LCBkMy5ldmVudC54KSkgfSwgJHsgZC55ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oc2l6ZS5oZWlnaHQgLSBkLmR5LCBkMy5ldmVudC55KSkgfSlgKTtcbiAgICAgICAgICBzYW5rZXlDaGFydEQzLnJlbGF5b3V0KCk7XG4gICAgICAgICAgbGluay5hdHRyKCdkJywgcGF0aCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGFjdHVhbGl6YXJTYW5rZXkgPSAod2lkdGgsIGhlaWd0aCwgZGF0YSwgb2xkTGlua3MpID0+IHtcbiAgICAgICAgY29uc3QgbGlua3NEaWZmID0gKGxpbmtzX29sZCwgbGlua3NfbmV3KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2cobGlua3Nfb2xkKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhsaW5rc19uZXcpO1xuICAgICAgICAgIGxldCBsaW5rcyA9IFtdLFxuICAgICAgICAgICAgICBzb3VyY2UsXG4gICAgICAgICAgICAgIHRhcmdldDtcblxuICAgICAgICAgIGxpbmtzX25ldy5mb3JFYWNoKCh2LCBrKSA9PiB7XG4gICAgICAgICAgICBzb3VyY2UgID0gdi5zb3VyY2U7XG4gICAgICAgICAgICB0YXJnZXQgID0gdi50YXJnZXQ7XG5cbiAgICAgICAgICAgIGxpbmtzX29sZC5mb3JFYWNoKCh2LCBrKSA9PiB7IGlmICgoc291cmNlICE9PSB2LnNvdXJjZS5pZCkgfHwgKHRhcmdldCAhPT0gdi50YXJnZXQuaWQpKSB7IGxpbmtzLnB1c2godik7IH0gfSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm4gbGlua3M7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gbGV0IG5ld05vZGVzID0gbm9kZXNEaWZmKGRhdGEsIHNhbmtleURhdGEpO1xuICAgICAgICAvLyBsZXQgbmV3TGlua3MgPSBsaW5rc0RpZmYob2xkTGlua3MsIGRhdGEubGlua3MpO1xuXG4gICAgICAgIC8vIFBhcmFtZXRyb3NcbiAgICAgICAgbGV0IG1hcmdpbiA9IHtcbiAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgcmlnaHQ6IDAsXG4gICAgICAgICAgYm90dG9tOiAwLFxuICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IHNpemUgPSB7XG4gICAgICAgICAgd2lkdGg6IHdpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQsXG4gICAgICAgICAgaGVpZ2h0OiBoZWlndGggLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIENyZWFjacOzbiBTYW5rZXlcbiAgICAgICAgc2Fua2V5Q2hhcnREMyA9IGQzLnNhbmtleSgpXG4gICAgICAgICAgLm5vZGVXaWR0aCgyMCkgLy8gQW5jaG8gbm9kb1xuICAgICAgICAgIC5zaXplKFtzaXplLndpZHRoLCBzaXplLmhlaWdodF0pXG4gICAgICAgICAgLm5vZGVzKGRhdGEubm9kZXMpXG4gICAgICAgICAgLmxpbmtzKGRhdGEubGlua3MpXG4gICAgICAgICAgLmxheW91dCgzMik7XG5cbiAgICAgICAgc2Fua2V5Q2hhcnREMy5yZWxheW91dCgpO1xuXG4gICAgICAgIC8vIENyZWFjacOzbiBkZSBMaW5rc1xuICAgICAgICBwYXRoID0gc2Fua2V5Q2hhcnREMy5saW5rKCk7XG4gICAgICAgICQoJyNsaW5rcycpLmVtcHR5KCk7XG5cbiAgICAgICAgbGV0IGxpbmtzID0gZDMuc2VsZWN0KCcjbGlua3MnKVxuICAgICAgICAgIC5zZWxlY3RBbGwoJy5saW5rJylcbiAgICAgICAgICAuZGF0YShkYXRhLmxpbmtzKVxuICAgICAgICAgIC5lbnRlcigpO1xuXG4gICAgICAgIGxpbmtzLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnbGluaycpXG4gICAgICAgICAgICAuYXR0cignZCcsIChkKSA9PiBwYXRoKGQpKVxuICAgICAgICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAoZCkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gZC5keTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsICdncmF5JylcbiAgICAgICAgICAgIC5vbignbW91c2VvdmVyJywgKGQpID0+IHtcbiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZDMuZXZlbnQpO1xuICAgICAgICAgICAgICBkMy5zZWxlY3QoZDMuZXZlbnQudGFyZ2V0KS5zdHlsZSgnc3Ryb2tlJywgJ3JlZCcpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCAoZCkgPT4ge1xuICAgICAgICAgICAgICBkMy5zZWxlY3QoZDMuZXZlbnQudGFyZ2V0KS5zdHlsZSgnc3Ryb2tlJywgJ2dyYXknKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGQzLnNlbGVjdEFsbCgnLmxpbmsnKVxuICAgICAgICAvLyAgIC5kYXRhKGRhdGEubGlua3MpXG4gICAgICAgIC8vICAgLmF0dHIoJ2QnLCAoZCkgPT4gcGF0aChkKSk7XG4gICAgICAgIGQzLnNlbGVjdEFsbCgnLm5vZGUnKVxuICAgICAgICAgIC5kYXRhKGRhdGEubm9kZXMpXG4gICAgICAgICAgLy8gLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAoZCkgPT4gYHRyYW5zbGF0ZSgkeyBkLnggfSwgJHsgZC55IH0pYCk7XG4gICAgICAgIGQzLnNlbGVjdEFsbCgncmVjdCcpXG4gICAgICAgICAgLmRhdGEoZGF0YS5ub2RlcylcbiAgICAgICAgICAuc3R5bGUoJ29wYWNpdHknLCAwKVxuICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHNhbmtleUNoYXJ0RDMubm9kZVdpZHRoKCkpXG4gICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIChkKSA9PiBkLmR5KVxuICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuc3R5bGUoJ29wYWNpdHknLCAxKTtcblxuICAgICAgICAvLyBDcmVhdGUgRGlmZXJlbmNlXG4gICAgICAgIC8vIG5ld0xpbmtzLmZvckVhY2goKHYsIGspID0+IHtcbiAgICAgICAgLy8gICBsZXQgbGluayA9IGQzLnNlbGVjdCgnI2xpbmtzJylcbiAgICAgICAgLy8gICAgIC5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAvLyAgICAgICAuYXR0cignY2xhc3MnLCAnbGluaycpXG4gICAgICAgIC8vICAgICAgIC5hdHRyKCdkJywgKCkgPT4gcGF0aCh2KSlcbiAgICAgICAgLy8gICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAoKSA9PiBNYXRoLm1heCgxLCB2LmR5KSlcbiAgICAgICAgLy8gICAgICAgLnN0eWxlKCdzdHJva2UnLCAoKSA9PiBzY2FsZUNvbG9yKHYuc291cmNlLm5hbWUucmVwbGFjZSgnICcsICcnKSkpXG4gICAgICAgIC8vICAgICAgIC5zb3J0KChhLCBiKSA9PiAoYi5keSAtIGEuZHkpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICBsaW5rLmFwcGVuZCgndGl0bGUnKS50ZXh0KCgpID0+IGAkeyB2LnNvdXJjZS5uYW1lIH0g4oaSICR7IHYudGFyZ2V0Lm5hbWUgfSBcXG4gJHsgZm9ybWF0b051bWVybyh2LnZhbHVlKSB9YCk7XG4gICAgICAgIC8vIH0pO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IG1heFBhcmVudCA9IChub2RvKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKG5vZG8pO1xuICAgICAgICBsZXQgcGFyZW50Tm9kZSA9IG5vZGVzR2xvLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQuaWQgPT09IG5vZG8ucGFyZW50KSlbMF07XG5cbiAgICAgICAgaWYgKG5vZG8ucGFyZW50ICE9PSBmYWxzZSkge1xuICAgICAgICAgIGlmICh0eXBlb2YocGFyZW50Tm9kZSkgIT09ICd1bmRlZmluZWQnICYmIHBhcmVudE5vZGUuZ3JvdXAgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXhQYXJlbnQobm9kZXNHbG8uZmlsdGVyKChlbGVtZW50KSA9PiAoZWxlbWVudC5pZCA9PT0gbm9kby5wYXJlbnQpKVswXSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBub2RvO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gbm9kbztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGRlbGV0ZUVtcHR5Tm9kZXMgPSAoKSA9PiB7XG4gICAgICAgIGxldCBkZWwgPSAwLFxuICAgICAgICAgICAgbm9kZXNEZWxldGUgPSBbXSxcbiAgICAgICAgICAgIHN0YXR1cztcblxuICAgICAgICAvLyBtb3ZlSWQgPSAwO1xuXG4gICAgICAgIG5vZGVzR2xvLmZvckVhY2goKG5vZGUsIG5vZGVJKSA9PiB7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ25vZG86ICcgKyBub2RlSSArICcgKCBpZDogJyArIG5vZGUuaWQgKyAnKScpO1xuICAgICAgICAgIHN0YXR1cyA9IGZhbHNlO1xuXG4gICAgICAgICAgLy8gQ29uc3VsdG8gc2kgZWwgbm9kbyBzZSB1dGlsaXphIGVuIGFsZ3VuIGxpbmtcbiAgICAgICAgICBsaW5rc0dsby5mb3JFYWNoKChsaW5rLCBsaW5rSSkgPT4ge1xuICAgICAgICAgICAgaWYgKG5vZGUuaWQgPT09IGxpbmsuc291cmNlKSB7XG4gICAgICAgICAgICAgIHN0YXR1cyA9IHRydWU7XG4gICAgICAgICAgICAgIGxpbmsuc291cmNlID0gbGluay5zb3VyY2UgLSBkZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9kZS5pZCA9PT0gbGluay50YXJnZXQpIHtcbiAgICAgICAgICAgICAgc3RhdHVzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgbGluay50YXJnZXQgPSBsaW5rLnRhcmdldCAtIGRlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIC8vIE1vZGlmaWNhciBlbCBJRCByZXN0YW5kbyBsYSBjYW50aWRhZCBkZSBlbGVtZW50b3MgYm9ycmFkb3NcbiAgICAgICAgICAvLyBub2RlLmlkID0gbm9kZS5pZCAtIGRlbDtcblxuICAgICAgICAgIGlmICghc3RhdHVzKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQm9ycmFyJyk7XG4gICAgICAgICAgICBub2Rlc0RlbGV0ZS5wdXNoKG5vZGVJKTtcbiAgICAgICAgICAgIGRlbCsrO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAvLyAgIC8vIGNvbnNvbGUubG9nKCdub2RvOiAnICsgbm9kZUkgKyAnICggaWQ6ICcgKyBub2RlLmlkICsgJyk8LScpO1xuICAgICAgICAgIC8vIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbm9kZXNEZWxldGUucmV2ZXJzZSgpLmZvckVhY2goKG5vZGUpID0+IHsgbm9kZXNHbG8uc3BsaWNlKG5vZGUsIDEpOyB9KTtcblxuICAgICAgICAvLyBtb3ZlSWQgPSBkZWw7XG4gICAgICAgIC8vIG5vZGVzLmZvckVhY2goKG5vZGUsIG5vZGVJKSA9PiB7XG4gICAgICAgIC8vICAgY29uc29sZS5sb2coJ25vZG86ICcgKyBub2RlSSArICcgKCBpZDogJyArIG5vZGUuaWQgKyAnKScpO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICAvLyBjb25zb2xlLmxvZyhsaW5rcyk7XG4gICAgICAgIHJldHVybiBub2Rlc0dsbztcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRlY2xhcmVHcm91cExpbmtzID0gKGRlc2Fycm9sbG8gPSBmYWxzZSkgPT4ge1xuICAgICAgICBsZXQgbGlua3MgPSBbXSxcbiAgICAgICAgICAgIHNvdXJjZSwgcGFyZW50U291cmNlLCBzdGF0ZVNvdXJjZSxcbiAgICAgICAgICAgIHRhcmdldCwgcGFyZW50VGFyZ2V0LCBzdGF0ZVRhcmdldCxcbiAgICAgICAgICAgIG5vZG9FeGlzdGVudGUsXG4gICAgICAgICAgICBhZGRTb3VyY2UsXG4gICAgICAgICAgICBhZGRUYXJnZXQsXG4gICAgICAgICAgICBhZGRWYWx1ZTtcblxuICAgICAgICBsaW5rc0dsby5mb3JFYWNoKCh2LCBrKSA9PiB7XG4gICAgICAgICAgLy9TZSBvYnRpZW5lIHNvdXJjZSB5IHRhcmdldCBkZWwgZWxlbWVudG9cbiAgICAgICAgICBzb3VyY2UgPSBub2Rlc0dsby5maWx0ZXIoKGVsZW1lbnQpID0+IChlbGVtZW50LmlkID09PSBwYXJzZUludCh2LnNvdXJjZSkpKVswXTtcbiAgICAgICAgICB0YXJnZXQgPSBub2Rlc0dsby5maWx0ZXIoKGVsZW1lbnQpID0+IChlbGVtZW50LmlkID09PSBwYXJzZUludCh2LnRhcmdldCkpKVswXTtcbiAgICAgICAgICAvL1NlIGd1YXJkYSBzb3VyY2UtcGFkcmUgeSB0YXJnZXQtcGFkcmVcbiAgICAgICAgICBwYXJlbnRTb3VyY2UgPSBtYXhQYXJlbnQoc291cmNlKTtcbiAgICAgICAgICBwYXJlbnRUYXJnZXQgPSBtYXhQYXJlbnQodGFyZ2V0KTtcbiAgICAgICAgICAvL1NlIGd1YXJkYSBzb3VyY2Utc3RhdGUgeSB0YXJnZXQtc3RhdGVcbiAgICAgICAgICBzdGF0ZVNvdXJjZSA9IHBhcmVudFNvdXJjZS5ncm91cDtcbiAgICAgICAgICBzdGF0ZVRhcmdldCA9IHBhcmVudFRhcmdldC5ncm91cDtcbiAgICAgICAgICAvL1NlIGd1YXJkYSBzb3VyY2UgeSBsaW5rIGEgY3JlYXJcbiAgICAgICAgICBhZGRTb3VyY2UgPSAoc3RhdGVTb3VyY2UpID8gKHBhcmVudFNvdXJjZSkgOiAoc291cmNlKTtcbiAgICAgICAgICBhZGRUYXJnZXQgPSAoc3RhdGVUYXJnZXQpID8gKHBhcmVudFRhcmdldCkgOiAodGFyZ2V0KTtcbiAgICAgICAgICBhZGRWYWx1ZSAgPSBwYXJzZUludCh2LnZhbHVlKTtcbiAgICAgICAgICAvL1NlIGNvbnN1bHRhIHNpIGVsIG5vZG8gZXhpc3RlXG4gICAgICAgICAgbm9kb0V4aXN0ZW50ZSA9IGxpbmtzLmZpbHRlcigoZWxlbWVudCkgPT4gKGVsZW1lbnQuc291cmNlID09PSBhZGRTb3VyY2UuaWQgJiYgZWxlbWVudC50YXJnZXQgPT09IGFkZFRhcmdldC5pZCkpO1xuXG4gICAgICAgICAgaWYgIChub2RvRXhpc3RlbnRlLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgLy9TZSBzdW1hIHZhbG9yIGEgZHVwbGljYWRvXG4gICAgICAgICAgICBub2RvRXhpc3RlbnRlWzBdLnZhbHVlICs9IGFkZFZhbHVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL1NlIGNyZW8gbnVldm8gbGlua1xuICAgICAgICAgICAgbGlua3MucHVzaCh7XG4gICAgICAgICAgICAgICdzb3VyY2UnOiBhZGRTb3VyY2UuaWQsXG4gICAgICAgICAgICAgICd0YXJnZXQnOiBhZGRUYXJnZXQuaWQsXG4gICAgICAgICAgICAgICd2YWx1ZSc6ICBhZGRWYWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxpbmtzO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcHJlU2Fua2V5ID0gKCkgPT4ge1xuICAgICAgICBsaW5rc0dsbyA9ICQuZXh0ZW5kKHRydWUsIFtdLCBsaW5rc09yaSk7XG4gICAgICAgIG5vZGVzR2xvID0gJC5leHRlbmQodHJ1ZSwgW10sIG5vZGVzT3JpKTtcbiAgICAgICAgbGlua3NHbG8gPSBkZWNsYXJlR3JvdXBMaW5rcygpO1xuICAgICAgICBub2Rlc0dsbyA9IGRlbGV0ZUVtcHR5Tm9kZXMoKTtcblxuICAgICAgICBkaWJ1amFyU2Fua2V5KHdpZHRoLCBoZWlnaHQsIHsgJ25vZGVzJzogbm9kZXNHbG8sICdsaW5rcyc6IGxpbmtzR2xvIH0pO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgaW5pdCA9ICgpID0+IHtcblxuICAgICAgICBjb25zdCBkb3dubG9hZEZpbGUgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1NlIHNvbGljaXRhbiBhcmNoaXZvcycpOyAvLyBCb3JyYXJcblxuICAgICAgICAgIGNvbnN0IGZvcm1hdG9TYW5rZXkgICAgID0gKGVsZW1lbnRvLCBkYXRhKSA9PiB7XG4gICAgICAgICAgICBsZXQgcHJvY2Vzc0RhdGEgPSBbXTtcblxuICAgICAgICAgICAgc3dpdGNoIChlbGVtZW50bykge1xuICAgICAgICAgICAgICBjYXNlICdub2Rvcyc6XG4gICAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKCh2LCBrKSA9PiB7XG4gICAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgJ2lkJyAgICAgIDogcGFyc2VJbnQodi5pZCksXG4gICAgICAgICAgICAgICAgICAgICduYW1lJyAgICA6IHYubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgJ3BhcmVudCcgIDogKHYucGFyZW50ID09PSAnbnVsbCcpPyhmYWxzZSk6KHBhcnNlSW50KHYucGFyZW50KSksXG4gICAgICAgICAgICAgICAgICAgICdjYXRlZ29yeSc6IHYuY2F0ZWdvcnksXG4gICAgICAgICAgICAgICAgICAgICdwb3MnICAgICA6IHBhcnNlSW50KHYucG9zaXRpb24pLFxuICAgICAgICAgICAgICAgICAgICAnZ3JvdXAnICAgOiAodi5ncm91cCA9PT0gJ3RydWUnKT8odHJ1ZSk6KGZhbHNlKSxcbiAgICAgICAgICAgICAgICAgICAgJ2ltcCcgICAgIDogdi5pbXBvcnRhdGlvbi5zcGxpdCgnOycpLm1hcCgoZWxlbWVudCkgPT4gKHBhcnNlSW50KGVsZW1lbnQpKSksXG4gICAgICAgICAgICAgICAgICAgICdleHAnICAgICA6IHYuZXhwb3J0YXRpb24uc3BsaXQoJzsnKS5tYXAoKGVsZW1lbnQpID0+IChwYXJzZUludChlbGVtZW50KSkpLFxuICAgICAgICAgICAgICAgICAgICAncHJvZCcgICAgOiB2LnByb2R1Y3Rpb24uc3BsaXQoJzsnKS5tYXAoKGVsZW1lbnQpID0+IChwYXJzZUludChlbGVtZW50KSkpXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSAnbGlua3MnOlxuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgodiwgaykgPT4ge1xuICAgICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICdzb3VyY2UnOiBwYXJzZUludCh2LnNvdXJjZSksXG4gICAgICAgICAgICAgICAgICAgICd0YXJnZXQnOiBwYXJzZUludCh2LnRhcmdldCksXG4gICAgICAgICAgICAgICAgICAgICd2YWx1ZScgOiBwYXJzZUludCh2LnZhbHVlKSxcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzc0RhdGE7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoKHN1Y2Nlc3MpID0+IHtcbiAgICAgICAgICAgIGQzLmNzdigncHVibGljL3NyYy9ub2Rlcy5jc3YnLFxuICAgICAgICAgICAgICAobm9kb3MpID0+IHtcbiAgICAgICAgICAgICAgICBub2Rlc09yaSA9IGZvcm1hdG9TYW5rZXkoJ25vZG9zJywgbm9kb3MpO1xuXG4gICAgICAgICAgICAgICAgZDMuY3N2KCdwdWJsaWMvc3JjL2xpbmtzLmNzdicsXG4gICAgICAgICAgICAgICAgICAobGlua3MpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGlua3NPcmkgPSBmb3JtYXRvU2Fua2V5KCdsaW5rcycsIGxpbmtzKTtcblxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIGRvd25sb2FkRmlsZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHByZVNhbmtleSgpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgaW5pdCgpO1xufSk7XG4iXX0=
