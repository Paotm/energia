{"version":3,"sources":["app.js"],"names":["COLORES_GRADIENTE","GLOBAL_NODES","GLOBAL_LINKS","INTRO","nodes","nodes_description","GENERAR_GRADIENTES","colores","keys","forEach","v1","k1","v2","k2","BUSCAR_NODO","id","modificador","filter","element","$","height","width","nodesOri","linksOri","nodesGlo","linksGlo","sankeyChartD3","path","svg","fade","type","g","i","all_links","d3","selectAll","all_nodes","element_id","event_node","select","transition","style","position","d","source","target","removeAttr","intro","stage","state","action","link_dom","link","node_dom","node","intro_container","intro_buttons","button_last","button_next","node_on","node_off","link_on","next_node","link_off","append","attr","text","remove","name","on","length","tooltipIn","css","top","y","left","x","ketp","production","importation","exportation","consumo","losses","others","dibujarSankey","heigth","data","margin","right","bottom","header","headerSize","size","secciones","anchoNodo","separacionNodo","posColumnas","encabezado","chart","getBBox","sankey","nodeWidth","nodePadding","links","layout","key","eval","enter","Math","max","dy","sort","a","b","indexOf","push","targetLinks","v","k","downloadFile","promise","Promise","success","json","nodos","then"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEJ,MAAME,eAAe,SAAfA,YAAe,GAAM;AACzB,QAAIC,UAAU,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AACrCxF,SAAGyF,IAAH,CAAQ,uBAAR,EAAiC,UAACC,KAAD,EAAW;AAC1C3H,uBAAe2H,KAAf;;AAEA1F,WAAGyF,IAAH,CAAQ,uBAAR,EAAiC,UAACpB,KAAD,EAAW;AACxCrG,yBAAeqG,KAAf;;AAEAmB;AACD,SAJH;AAMD,OATD;AAUD,KAXa,CAAd;;AAaA,WAAOF,OAAP;AACD,GAfD;;AAiBAD,iBAAeM,IAAf,CAAoB,YAAM;;AAExB1H,UAAMC,KAAN,CAAYK,OAAZ,CAAoB,UAAC4G,CAAD,EAAIC,CAAJ,EAAU;AAAEnH,YAAMC,KAAN,CAAYkH,CAAZ,IAAiBxG,YAAYuG,CAAZ,CAAjB;AAAkC,KAAlE;;AAEAjC,kBAAc/D,KAAd,EAAqBD,MAArB,EAA6B,EAAE,SAASnB,YAAX,EAAyB,SAASC,YAAlC,EAA7B;;AAEA6C,UAAM,CAAN,EAAS,QAAT,EAAmB,MAAnB;AAED,GARD;AASD,CArkBD","file":"app.js","sourcesContent":["// VARIABLES\nlet COLORES_GRADIENTE = [ '#206aab', '#0075c9', '#009dda', '#4dcbec', '#7fdaf1', '#b2e9f7' ],\n    GLOBAL_NODES,\n    GLOBAL_LINKS,\n    INTRO = {\n      nodes: [\n        3,\n        28,\n        15,\n        26,\n        12,\n        31\n      ],\n      nodes_description: [\n        'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.',\n        'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.',\n        'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.',\n        'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.',\n        'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.',\n        'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'\n      ]\n    };\n\n// FUNCIONES\nconst GENERAR_GRADIENTES = (colores) => {\n  let keys = {};\n\n  colores.forEach((v1, k1) => { colores.forEach((v2, k2) => { keys[`${ k1 + 1 }${ k2 + 1 }`] = [v1, v2]; }); });\n\n  return keys;\n};\nconst BUSCAR_NODO = (id, modificador = 0) => (GLOBAL_NODES.filter((element) => element.id === id + modificador)[0]);\n\n$(() => {\n\n  let height      = $('#sankey').height(),\n      width       = $('#sankey').width(),\n      nodesOri, linksOri,\n      nodesGlo, linksGlo,\n      sankeyChartD3, path, svg;\n\n  const fade = (type = null, id = null) => (g, i) => {\n    if (type !== null) {\n      let all_links   = d3.selectAll('#sankey .link'),\n          all_nodes   = d3.selectAll('#sankey .node'),\n          element_id  = (id === null)?(g.id):(id),\n          event_node;\n\n      switch (type) {\n        case 'fadeIn':\n          // Estilos aplicados al nodo seleccionado\n          event_node = d3.select(`#node_${ element_id }`);\n            event_node.select('rect')\n              .transition()\n              .style('fill', COLORES_GRADIENTE[g.position - 1])\n              .style('stroke', 'white');\n            event_node.select('text')\n              .transition()\n              .style('fill', 'transparent');\n\n          // Estilos aplicados a los links relacionados\n          all_links.filter((d) => ((d.source.id === element_id && d.target.id !== 42) || (d.target.id === element_id && d.target.id !== 42)))\n            .transition()\n            .style('stroke', (d) => (`url(#key_${ d.source.position }${ d.target.position })`))\n            .style('stroke-opacity', 0.5);\n          all_links.filter((d) => ((d.source.id === element_id && d.target.id === 42) || (d.target.id === element_id && d.target.id === 42)))\n            .transition()\n            .style('stroke', 'red')\n            .style('stroke-opacity', 0.5);\n          break;\n        case 'fadeOut':\n          // Estilos aplicados al nodo seleccionado\n          event_node = d3.select(`#node_${ element_id }`);\n            event_node.select('rect')\n              .transition()\n              .style('fill', null)\n              .style('stroke', null);\n            event_node.select('text')\n              .transition()\n              .style('fill', null);\n\n          // Estilos aplicados a los links relacionados\n          all_links.style('stroke', null).style('stroke-opacity', null);\n\n          $('#tooltip').removeAttr('style');\n          break;\n      }\n    }\n  };\n  const intro = (stage, state = 'normal', action = 'none') => {\n    let link_dom = d3.selectAll('#sankey .link').filter((link) => (link.source.id === INTRO.nodes[stage].id && link.target.id === INTRO.nodes[(stage + 1)].id)),\n        node_dom = d3.selectAll('#sankey .node').filter((node) => (node.id === INTRO.nodes[stage].id)),\n        intro_container, intro_buttons,\n        button_last, button_next;\n\n    const node_on = (node) => {\n      node_dom.select('rect').transition().style('fill', COLORES_GRADIENTE[node.position - 1]).style('stroke', 'white');\n      node_dom.select('text').transition().style('fill', 'black');\n    };\n    const node_off = (node) => {\n      node_dom.select('rect').transition().style('fill', null).style('stroke', null);\n      node_dom.select('text').transition().style('fill', null);\n    };\n    const link_on = (node, next_node) => {\n      link_dom.transition().style('stroke', (d) => (`url(#key_${ d.source.position }${ d.target.position })`)).style('stroke-opacity', 0.5);\n    };\n    const link_off = (node, next_node) => {\n      link_dom.transition().style('stroke', null).style('stroke-opacity', null);\n    };\n\n    switch (state) {\n      case 'create':\n        d3.select('#content').append('div').attr('id', 'intro_screen').style('top', '0px').style('left', '0px');\n        intro_container = d3.select('#content').append('div').attr('id', 'tooltip_intro').style('bottom', '20px').style('right', '20px');\n          intro_container.append('h2').attr('class', 'tooltip_name');\n          intro_container.append('p').attr('class', 'tooltip_production');\n        intro_buttons   = intro_container.append('div').attr('class', 'flex flex_justify_between');\n        button_last     = intro_buttons.append('button').attr('id', 'last').text('Anterior');\n        button_next     = intro_buttons.append('button').attr('id', 'next').text('Siguiente');\n        break;\n      case 'delete':\n        d3.select('#tooltip_intro').remove();\n        d3.select('#intro_screen').remove();\n        d3.selectAll('#sankey .node rect').transition().style('fill', null).style('stroke', null);\n        d3.selectAll('#sankey .node text').transition().style('fill', null);\n        d3.selectAll('#sankey .link').transition().style('stroke', null).style('stroke-opacity', null);\n        return false;\n      case 'normal':\n        intro_container = d3.select('#tooltip_intro');\n        intro_buttons   = intro_container.select('div');\n        button_last     = intro_buttons.select('#last');\n        button_next     = intro_buttons.select('#next');\n        break;\n    }\n    switch (action) {\n      case 'next':\n        node_on(INTRO.nodes[stage]);\n        link_on(INTRO.nodes[stage], INTRO.nodes[stage + 1]);\n        break;\n      case 'back':\n        node_off(INTRO.nodes[stage + 1]);\n        link_off(INTRO.nodes[stage + 1], INTRO.nodes[stage + 2]);\n        break;\n    }\n\n    intro_container.select('h2').text(INTRO.nodes[stage].name);\n    intro_container.select('p').text(INTRO.nodes_description[stage]);\n\n    if (stage === 0) {\n      button_last.attr('class', 'btn btn-default btn-xs disabled').on('click', () => { intro(stage, 'normal', 'none'); });\n      button_next.attr('class', 'btn btn-default btn-xs').on('click', () => { intro(stage + 1, 'normal', 'next'); });\n    } else if (stage === (INTRO.nodes.length - 1)) {\n      button_last.attr('class', 'btn btn-default btn-xs').on('click', () => { intro(stage - 1, 'normal', 'back'); });\n      button_next.attr('class', 'btn btn-primary btn-xs').text('Comenzar').on('click', () => { intro(stage, 'delete', 'none'); });\n    } else {\n      button_last.attr('class', 'btn btn-default btn-xs').on('click', () => { intro(stage - 1, 'normal', 'back'); });\n      button_next.attr('class', 'btn btn-default btn-xs').on('click', () => { intro(stage + 1, 'normal', 'next'); });\n    }\n  };\n\n      const tooltipIn = (d) => {\n\n        $('#tooltip').css({ top: $('#sankey svg').position().top + d.y + 7 - 20, left: $('#sankey svg').position().left + d.x + 210 });\n\n        if (d.position === 1 || d.position === 3 || d.position === 5) {\n          $('.tooltip_name').text(d.name);\n          $('.tooltip_ktep').css({'display': 'none'}).text(d.ketp);\n          $('.tooltip_production').removeAttr('style').text(`Producción: ${ d.production }`);\n          $('.tooltip_importation').removeAttr('style').text(`Importación: ${ d.importation }`);\n          $('.tooltip_exportation').removeAttr('style').text(`Exportación: ${ d.exportation }`);\n          $('.tooltip_consumo').css({'display': 'none'}).text(`Consumo: ${ d.consumo }`);\n          $('.tooltip_losses').removeAttr('style').text(`Pérdida: ${ d.losses }`);\n          $('.tooltip_others').removeAttr('style').text(`Otros: ${ d.others }`);\n        } else if (d.position === 2 || d.position === 4) {\n          $('.tooltip_name').text(d.name);\n          $('.tooltip_ktep').removeAttr('style').text(d.ketp);\n          $('.tooltip_production').removeAttr('style').text(`Producción: ${ d.production }`);\n          $('.tooltip_importation').css({'display': 'none'}).text(`Importación: ${ d.importation }`);\n          $('.tooltip_exportation').css({'display': 'none'}).text(`Exportación: ${ d.exportation }`);\n          $('.tooltip_consumo').removeAttr('style').text(`Consumo: ${ d.consumo }`);\n          $('.tooltip_losses').removeAttr('style').text(`Pérdida: ${ d.losses }`);\n          $('.tooltip_others').css({'display': 'none'}).text(`Otros: ${ d.others }`);\n        } else {\n          $('.tooltip_name').text(d.name);\n          $('.tooltip_ktep').removeAttr('style').text(d.ketp);\n          $('.tooltip_production').css({'display': 'none'}).text(`Producción: ${ d.production }`);\n          $('.tooltip_importation').css({'display': 'none'}).text(`Importación: ${ d.importation }`);\n          $('.tooltip_exportation').css({'display': 'none'}).text(`Exportación: ${ d.exportation }`);\n          $('.tooltip_consumo').css({'display': 'none'}).text(`Consumo: ${ d.consumo }`);\n          $('.tooltip_losses').css({'display': 'none'}).text(`Pérdida: ${ d.losses }`);\n          $('.tooltip_others').css({'display': 'none'}).text(`Otros: ${ d.others }`);\n        }\n      };\n\n\n\n      // const colapsarExpandirNodo = (nodo) => {\n      //\n      //   nodesOri[nodo.id].group = (nodesOri[nodo.id].group) ? (false) : (true);\n      //\n      //   return nodesOri;\n      //\n      //\n      //   // let oldLinks = dataSankey.links;\n      //\n      //   // if (nodo.parent === false) {\n      //   //   console.log('Se expande nodo');\n      //   //   clavesNodos.forEach((element) => { if (element.id === nodo.id + moveId) { element.state = false; } });\n      //   //\n      //   //   dataSankey.nodes = nodosOriginales;\n      //   //   dataSankey.links = linksOriginales;\n      //   //\n      //   //   dataSankey.links = declareGroupLinks(dataSankey.links, true);\n      //   //\n      //   //   dataSankey = buscarNodes(dataSankey.nodes, dataSankey.links);\n      //   //   moveId = 0;\n      //   //   $('#sankey').empty();\n      //   //   dibujarSankey(width, height, dataSankey);\n      //   //   // actualizarSankey($('#content').width(), $('#content').height(), dataSankey, oldLinks);\n      //   // } else {\n      //   //   console.log('Se colapsa nodo');\n      //   //   // let parent = dataSankey.nodes.filter((element) => (element.name === nodo.parent))[0];\n      //   //   // clavesNodos.filter((element) => (element.id === parent.id))[0].state = true;\n      //   //   //\n      //   //   // dataSankey = buscarNodes(nodosOriginales, dataSankey.links = declareGroupLinks(linksOriginales));\n      //   //   //\n      //   //   // $('#sankey').empty();\n      //   //   // dibujarSankey(width, height, dataSankey);\n      //   //   // actualizarSankey($('#content').width(), $('#content').height(), dataSankey, oldLinks);\n      //   // }\n      // };\n\n      const dibujarSankey = (width, heigth, data) => {\n\n        // Se definen variables\n        let margin      = { top: 40, right: 200, bottom: 40, left: 200, header: 20 },\n        headerSize      = 19,\n        size            = { width: 1400 - margin.left - margin.right, height: heigth - margin.top - margin.bottom - margin.header - headerSize },\n        secciones       = [\n          'Energías primarias',\n          'Centros de transformación',\n          'Energías secundarias',\n          'Centros de transformación',\n          'Energías terciarias',\n          'Consumos',\n          'No aprovechables'\n        ],\n        anchoNodo       = 20,\n        separacionNodo  = 20,\n        posColumnas     = [];\n\n        // Creación SVG\n        svg = d3.select('#sankey')\n          .append('svg')\n          .attr('width', size.width + margin.right + margin.left)\n          .attr('height', size.height + margin.top + margin.bottom + margin.header + headerSize)\n          .attr('preserveAspectRatio', 'xMidYMid meet');\n\n        // Se agregan encabezados\n        let encabezado = svg.append('g')\n          .attr('id', 'chart-encabezado')\n          .attr('transform', `translate(${ margin.left }, ${ margin.top + 15 })`);\n        encabezado.append('text')\n          .attr('class', 'chart-encabezado-left')\n          .attr('x', -10)\n          .text(secciones[0]);\n\n        // Se crea grafico\n        let chart = svg.append('g')\n          .attr('transform', `translate(${ margin.left }, ${ margin.top + $('#chart-encabezado')[0].getBBox().height + margin.header })`);\n\n        // Creación Sankey\n        sankeyChartD3 = d3.sankey()\n          .nodeWidth(anchoNodo)\n          .nodePadding(separacionNodo)\n          .size([size.width, size.height])\n          .nodes(data.nodes)\n          .links(data.links)\n          .layout();\n\n        let keys = GENERAR_GRADIENTES(COLORES_GRADIENTE);\n\n        for (let key in keys) {\n          eval(`let key_${ key } = svg.append('defs')\n          .append('linearGradient')\n          .attr('id', 'key_${ key }')\n          .attr('x1', '0%')\n          .attr('x2', '100%')\n          .attr('spreadMethod', 'pad');\n          key_${ key }.append('stop')\n          .attr('offset', '0%')\n          .attr('stop-color', '${ keys[key][0] }')\n          .attr('stop-opacity', 1);\n          key_${ key }.append('stop')\n          .attr('offset', '100%')\n          .attr('stop-color', '${ keys[key][1] }')\n          .attr('stop-opacity', 1);`);\n        }\n\n        // Creación de Links\n        path = sankeyChartD3.link();\n\n        //  Se crean links\n        let link = chart.append('g')\n          .attr('id', 'links')\n          .selectAll('.link')\n          .data(data.links)\n          .enter()\n          .append('path')\n          .attr('d', path)\n          .attr('class', 'link')\n          .style('stroke-width', (d) => Math.max(1, d.dy))\n          // .on('mouseover', (d) => { d3.select(d3.event.target).style('stroke-opacity', 1); })\n          // .on('mouseout', (d) => { d3.select(d3.event.target).style('stroke-opacity', 0.75); })\n          .sort((a, b) => (b.dy - a.dy));\n\n          // link.filter((element) => (element.target.name === 'EXPORTACIONES' || element.target.name === 'CONSUMO PROPIO' || element.target.name === 'TRANSPORTE' || element.target.name === 'PERDIDA'))\n          //   .style('stroke', '#BA3F1D');\n\n        // Se crean nodos\n        let node = chart.append('g')\n          .attr('id', 'nodes')\n          .selectAll('.node')\n          .data(data.nodes)\n          .enter()\n          .append('g')\n            .attr('id', (d) => `node_${ d.id }`)\n            .attr('class', 'node')\n            .attr('transform', (d) => {\n\n              if (posColumnas.indexOf(d.x) === -1) {\n                posColumnas.push(d.x);\n              }\n\n              return `translate(${ d.x }, ${ d.y })`;\n            }); // error compatibilidad\n            // .call(d3.drag().on('drag', dragmove));\n\n        // Se crean rectangulos nodos\n        node.filter((element) => (element.name !== 'borrar')).append('rect')\n            .attr('width', sankeyChartD3.nodeWidth())\n            .attr('height', (d) => (Math.max(5, d.dy)))\n            .on('mouseover',  fade('fadeIn', null))\n            .on('mouseout',   fade('fadeOut', null))\n            .on('mousemove', tooltipIn);\n\n        // Se crean textos nodos\n        node.filter((element) => (element.name !== 'borrar')).append('text')\n          .attr('class', 'node-text')\n          .attr('x', 10 + sankeyChartD3.nodeWidth())\n          .attr('y', (d) => (d.dy / 2))\n          .attr('dy', '0.35em')\n          .text((d) => (d.name))\n          .filter((d) => (d.targetLinks.length === 0))\n          .attr('class', 'node-text-start')\n          .attr('x', -10);\n\n        // Se agrega texto referencia hover link\n        // link.append('title').text((d) => `${ d.source.name } (${ d.source.id }) → ${ d.target.name } (${ d.target.id }) → ${ d.value }`);\n\n        // Se agrega texto referencia hover node\n        // node.append('title').text((d) => `${ d.name } (${ d.id })`);\n\n        // Se agregan encabezados\n        posColumnas.sort((a, b) => (a - b)); // Se ordena posicion de columnas\n\n        secciones.forEach((v, k) => {\n          encabezado.append('text')\n            .filter((d) => (k > 0))\n            .attr('class', 'chart-encabezado-right')\n            .attr('x', (d) => (posColumnas[k] + anchoNodo + 10))\n            .text(v);\n        });\n\n        // the function for moving the nodes\n        // function dragmove(d) {\n        //   d3.select(this).attr('transform', `translate(${ d.x = Math.max(0, Math.min(size.width - d.dx, d3.event.x)) }, ${ d.y = Math.max(0, Math.min(size.height - d.dy, d3.event.y)) })`);\n        //   sankeyChartD3.relayout();\n        //   link.attr('d', path);\n        // }\n      };\n\n      // const actualizarSankey = (width, heigth, data, oldLinks) => {\n      //   const linksDiff = (links_old, links_new) => {\n      //     console.log(links_old);\n      //     console.log(links_new);\n      //     let links = [],\n      //         source,\n      //         target;\n      //\n      //     links_new.forEach((v, k) => {\n      //       source  = v.source;\n      //       target  = v.target;\n      //\n      //       links_old.forEach((v, k) => { if ((source !== v.source.id) || (target !== v.target.id)) { links.push(v); } });\n      //     });\n      //\n      //     return links;\n      //   };\n      //\n      //   // let newNodes = nodesDiff(data, sankeyData);\n      //   // let newLinks = linksDiff(oldLinks, data.links);\n      //\n      //   // Parametros\n      //   let margin = {\n      //     top: 0,\n      //     right: 0,\n      //     bottom: 0,\n      //     left: 0\n      //   };\n      //   let size = {\n      //     width: width - margin.left - margin.right,\n      //     height: heigth - margin.top - margin.bottom\n      //   };\n      //\n      //   // Creación Sankey\n      //   sankeyChartD3 = d3.sankey()\n      //     .nodeWidth(20) // Ancho nodo\n      //     .size([size.width, size.height])\n      //     .nodes(data.nodes)\n      //     .links(data.links)\n      //     .layout(32);\n      //\n      //   sankeyChartD3.relayout();\n      //\n      //   // Creación de Links\n      //   path = sankeyChartD3.link();\n      //   $('#links').empty();\n      //\n      //   let links = d3.select('#links')\n      //     .selectAll('.link')\n      //     .data(data.links)\n      //     .enter();\n      //\n      //   links.append('path')\n      //       .attr('class', 'link')\n      //       .attr('d', (d) => path(d))\n      //       .style('stroke-width', (d) => {\n      //         return d.dy;\n      //       })\n      //       .style('stroke', 'gray')\n      //       .on('mouseover', (d) => {\n      //         // console.log(d3.event);\n      //         d3.select(d3.event.target).style('stroke', 'red');\n      //       })\n      //       .on('mouseout', (d) => {\n      //         d3.select(d3.event.target).style('stroke', 'gray');\n      //       });\n      //\n      //   // d3.selectAll('.link')\n      //   //   .data(data.links)\n      //   //   .attr('d', (d) => path(d));\n      //   d3.selectAll('.node')\n      //     .data(data.nodes)\n      //     // .transition()\n      //     .attr('transform', (d) => `translate(${ d.x }, ${ d.y })`);\n      //   d3.selectAll('rect')\n      //     .data(data.nodes)\n      //     .style('opacity', 0)\n      //     .attr('width', sankeyChartD3.nodeWidth())\n      //     .attr('height', (d) => d.dy)\n      //     .transition()\n      //     .style('opacity', 1);\n      //\n      //   // Create Diference\n      //   // newLinks.forEach((v, k) => {\n      //   //   let link = d3.select('#links')\n      //   //     .append('path')\n      //   //       .attr('class', 'link')\n      //   //       .attr('d', () => path(v))\n      //   //       .style('stroke-width', () => Math.max(1, v.dy))\n      //   //       .style('stroke', () => scaleColor(v.source.name.replace(' ', '')))\n      //   //       .sort((a, b) => (b.dy - a.dy));\n      //   //\n      //   //   link.append('title').text(() => `${ v.source.name } → ${ v.target.name } \\n ${ formatoNumero(v.value) }`);\n      //   // });\n      // };\n      // const maxParent = (nodo) => {\n      //   // console.log(nodo);\n      //   let parentNode = nodesGlo.filter((element) => (element.id === nodo.parent))[0];\n      //\n      //   if (nodo.parent !== false) {\n      //     if (typeof(parentNode) !== 'undefined' && parentNode.group === true) {\n      //       return maxParent(nodesGlo.filter((element) => (element.id === nodo.parent))[0]);\n      //     } else {\n      //       return nodo;\n      //     }\n      //   } else {\n      //     return nodo;\n      //   }\n      // };\n      // const deleteEmptyNodes = () => {\n      //   let del = 0,\n      //       nodesDelete = [],\n      //       status;\n      //\n      //   // moveId = 0;\n      //\n      //   nodesGlo.forEach((node, nodeI) => {\n      //\n      //     // console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')');\n      //     status = false;\n      //\n      //     // Consulto si el nodo se utiliza en algun link\n      //     linksGlo.forEach((link, linkI) => {\n      //       if (node.id === link.source) {\n      //         status = true;\n      //         link.source = link.source - del;\n      //       }\n      //       if (node.id === link.target) {\n      //         status = true;\n      //         link.target = link.target - del;\n      //       }\n      //     });\n      //\n      //     // // Modificar el ID restando la cantidad de elementos borrados\n      //     // node.id = node.id - del;\n      //\n      //     if (!status) {\n      //       // console.log('Borrar');\n      //       nodesDelete.push(nodeI);\n      //       del++;\n      //     }\n      //     // else {\n      //     //   // console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')<-');\n      //     // }\n      //   });\n      //\n      //   nodesDelete.reverse().forEach((node) => { nodesGlo.splice(node, 1); });\n      //\n      //   // moveId = del;\n      //   // nodes.forEach((node, nodeI) => {\n      //   //   console.log('nodo: ' + nodeI + ' ( id: ' + node.id + ')');\n      //   // });\n      //\n      //   // console.log(links);\n      //   return nodesGlo;\n      // };\n      // const declareGroupLinks = () => {\n      //   let links = [],\n      //       source, parentSource, stateSource,\n      //       target, parentTarget, stateTarget,\n      //       nodoExistente,\n      //       addSource,\n      //       addTarget,\n      //       addValue;\n      //\n      //   linksGlo.forEach((v, k) => {\n      //\n      //     //Se obtiene source y target del elemento\n      //     source = nodesGlo.filter((element) => (element.id === parseInt(v.source)))[0];\n      //     target = nodesGlo.filter((element) => (element.id === parseInt(v.target)))[0];\n      //     //Se guarda source-padre y target-padre\n      //     parentSource = maxParent(source);\n      //     parentTarget = maxParent(target);\n      //     //Se guarda source-state y target-state\n      //     stateSource = parentSource.group;\n      //     stateTarget = parentTarget.group;\n      //     //Se guarda source y link a crear\n      //     addSource = (stateSource) ? (parentSource) : (source);\n      //     addTarget = (stateTarget) ? (parentTarget) : (target);\n      //     addValue  = parseInt(v.value);\n      //     //Se consulta si el nodo existe\n      //     nodoExistente = links.filter((element) => (element.source === addSource.id && element.target === addTarget.id));\n      //\n      //     if (nodoExistente.length !== 0) {\n      //       //Se suma valor a duplicado\n      //       nodoExistente[0].value += addValue;\n      //     } else {\n      //       //Se creo nuevo link\n      //       links.push({\n      //         'source': addSource.id,\n      //         'target': addTarget.id,\n      //         'value':  addValue\n      //       });\n      //     }\n      //   });\n      //   return links;\n      // };\n      // const preSankey = () => {\n      //   linksGlo = $.extend(true, [], linksOri);\n      //   nodesGlo = $.extend(true, [], nodesOri);\n      //   linksGlo = declareGroupLinks();\n      //   nodesGlo = deleteEmptyNodes();\n      //\n      //   dibujarSankey(width, height, { 'nodes': nodesGlo, 'links': linksGlo });\n      // };\n\n  const downloadFile = () => {\n    let promise = new Promise((success) => {\n      d3.json('public/src/nodes.json', (nodos) => {\n        GLOBAL_NODES = nodos;\n\n        d3.json('public/src/links.json', (links) => {\n            GLOBAL_LINKS = links;\n\n            success();\n          }\n        );\n      });\n    });\n\n    return promise;\n  };\n\n  downloadFile().then(() => {\n\n    INTRO.nodes.forEach((v, k) => { INTRO.nodes[k] = BUSCAR_NODO(v); });\n\n    dibujarSankey(width, height, { 'nodes': GLOBAL_NODES, 'links': GLOBAL_LINKS });\n\n    intro(0, 'create', 'next');\n\n  });\n});\n"]}