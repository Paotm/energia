"use strict";

d3.biHiSankey = function () {

  var biHiSankey = {},
      nodeWidth = 24,
      nodeSpacing = 8,
      linkSpacing = 5,
      arrowheadScaleFactor = 0,
      // Specifies the proportion of a link's stroke width to be allowed for the marker at the end of the link.
  size = [1, 1],
      // default to one pixel by one pixel
  nodes = [],
      nodeMap = {},
      parentNodes = [],
      leafNodes = [],
      links = [],
      xScaleFactor = 1,
      yScaleFactor = 1,
      defaultLinkCurvature = 0.5;

  function center(node) {
    return node.y + node.height / 2;
  }

  function value(link) {
    return link.value;
  }

  function initializeNodeArrayProperties(node) {
    node.sourceLinks = [];
    node.rightLinks = [];
    node.targetLinks = [];
    node.leftLinks = [];
    node.connectedNodes = [];
    node.children = [];
    node.ancestors = [];
  }
  // generates the nodeMap {"1": <node1>, "2": <node2>}
  // and initializes the array properties of each node
  function initializeNodeMap() {
    nodes.forEach(function (node) {
      nodeMap[node.id] = node;
      initializeNodeArrayProperties(node);
    });
  }

  function computeLeafNodes() {
    leafNodes = nodes.filter(function (node) {
      return !node.children.length;
    });
  }

  function computeParentNodes() {
    parentNodes = nodes.filter(function (node) {
      return node.children.length;
    });
  }

  function addAncestorsToChildren(node) {
    node.children.forEach(function (child) {
      child.ancestors = child.ancestors.concat(this.ancestors.concat([this]));
      addAncestorsToChildren(child);
    }, node);
  }

  // generate hierarchical connections between parent and child nodes
  function computeNodeHierarchy() {
    var parent,
        rootNodes = [];

    nodes.forEach(function (node) {
      parent = nodeMap[node.parent];
      if (parent) {
        node.parent = parent;
        parent.children.push(node);
      } else {
        node.parent = null;
        rootNodes.push(node);
      }
    });

    computeLeafNodes();
    computeParentNodes();

    rootNodes.forEach(function (rNode) {
      addAncestorsToChildren(rNode);
    });
  }

  // Populate the sourceLinks and targetLinks for each node.
  function computeNodeLinks() {
    var sourceNode, targetNode;
    links.forEach(function (link) {
      sourceNode = nodeMap[link.source] || link.source;
      targetNode = nodeMap[link.target] || link.target;
      link.id = link.source + '-' + link.target;
      link.source = sourceNode;
      link.target = targetNode;
      sourceNode.sourceLinks.push(link);
      targetNode.targetLinks.push(link);
    });
  }

  function visible(linkCollection) {
    return linkCollection.filter(function (link) {
      return link.source.state === "collapsed" && link.target.state === "collapsed";
    });
  }

  // When child nodes are collapsed into their parents (or higher ancestors)
  // the links between the child nodes should be represented by links
  // between the containing ancestors. This function adds those extra links.
  function computeAncestorLinks() {
    // Leaf nodes are never parents of other nodes
    // Duplicate source and target links between a leaf node and another leaf node
    // and add to the leaf nodes' parents
    leafNodes.forEach(function (leafNode) {
      leafNode.sourceLinks.forEach(function (sourceLink) {
        var ancestorTargets,
            target = sourceLink.target;
        if (leafNodes.indexOf(target) >= 0) {
          ancestorTargets = target.ancestors.filter(function (tAncestor) {
            return leafNode.ancestors.indexOf(tAncestor) < 0;
          });
          ancestorTargets.forEach(function (ancestorTarget) {
            var ancestorLink = { source: leafNode,
              target: ancestorTarget,
              value: sourceLink.value,
              id: leafNode.id + "-" + ancestorTarget.id };

            leafNode.sourceLinks.push(ancestorLink);
            ancestorTarget.targetLinks.push(ancestorLink);
            links.push(ancestorLink);
          });
        }
      });

      leafNode.targetLinks.forEach(function (targetLink) {
        var ancestorSources,
            source = targetLink.source;
        if (leafNodes.indexOf(source) >= 0) {
          ancestorSources = source.ancestors.filter(function (sAncestor) {
            return leafNode.ancestors.indexOf(sAncestor) < 0;
          });
          ancestorSources.forEach(function (ancestorSource) {
            var ancestorLink = { source: ancestorSource,
              target: leafNode,
              value: targetLink.value,
              id: ancestorSource.id + "-" + leafNode.id };
            ancestorSource.sourceLinks.push(ancestorLink);
            leafNode.targetLinks.push(ancestorLink);
            links.push(ancestorLink);
          });
        }
      });
    });

    // Add links between parents (for when both parents are in collapsed state)
    parentNodes.forEach(function (parentNode) {
      parentNode.sourceLinks.forEach(function (sourceLink) {
        var ancestorTargets,
            target = sourceLink.target;
        if (leafNodes.indexOf(target) >= 0) {
          ancestorTargets = target.ancestors.filter(function (tAncestor) {
            return parentNode.ancestors.indexOf(tAncestor) < 0;
          });
          ancestorTargets.forEach(function (ancestorTarget) {
            var ancestorLink = { source: parentNode,
              target: ancestorTarget,
              value: sourceLink.value,
              id: parentNode.id + "-" + ancestorTarget.id };

            parentNode.sourceLinks.push(ancestorLink);
            ancestorTarget.targetLinks.push(ancestorLink);
            links.push(ancestorLink);
          });
        }
      });
    });
  }

  // To reduce clutter in the diagram merge links that are from the
  // same source to the same target by creating a new link
  // with a value equal to the sum of the values of the merged links
  function mergeLinks() {
    var linkGroups = d3.nest().key(function (link) {
      return link.source.id + "->" + link.target.id;
    }).entries(links).map(function (object) {
      return object.values;
    });

    links = linkGroups.map(function (linkGroup) {
      return linkGroup.reduce(function (previousLink, currentLink) {
        return {
          "source": previousLink.source,
          "target": previousLink.target,
          "id": d3.min([previousLink.id, currentLink.id]),
          "value": previousLink.value + currentLink.value
        };
      });
    });
  }

  function nodeHeight(sideLinks) {
    var spacing = Math.max(sideLinks.length - 1, 0) * linkSpacing,
        scaledValueSum = d3.sum(sideLinks, value) * yScaleFactor;
    return scaledValueSum + spacing;
  }

  // Compute the value of each node by summing the associated links.
  // Compute the number of spaces between the links
  // Compute the number of source links for later decrementing
  function computeNodeValues() {
    nodes.forEach(function (node) {
      node.value = Math.max(d3.sum(node.leftLinks, value), d3.sum(node.rightLinks, value));
      node.netFlow = d3.sum(visible(node.targetLinks), value) - d3.sum(visible(node.sourceLinks), value);
      node.height = Math.max(nodeHeight(visible(node.leftLinks)), nodeHeight(visible(node.rightLinks)));
      node.linkSpaceCount = Math.max(Math.max(node.leftLinks.length, node.rightLinks.length) - 1, 0);
    });
  }

  function computeConnectedNodes() {
    var sourceNode, targetNode;
    links.forEach(function (link) {
      sourceNode = link.source;
      targetNode = link.target;
      if (sourceNode.connectedNodes.indexOf(targetNode) < 0) {
        sourceNode.connectedNodes.push(targetNode);
      }
      if (targetNode.connectedNodes.indexOf(sourceNode) < 0) {
        targetNode.connectedNodes.push(sourceNode);
      }
    });
  }

  function sourceAndTargetNodesWithSameX() {
    var nodeArray = [];
    links.filter(function (link) {
      return link.target.x === link.source.x;
    }).forEach(function (link) {
      if (nodeArray.indexOf(link.target) < 0) {
        nodeArray.push(link.target);
      }
    });
    return nodeArray;
  }

  function compressInXDirection() {
    var connectedNodesXPositions,
        nodesByXPosition = d3.nest().key(function (node) {
      return node.x;
    }).sortKeys(d3.ascending).entries(nodes).map(function (object) {
      return object.values;
    });

    nodesByXPosition.forEach(function (xnodes) {
      xnodes.forEach(function (node) {
        connectedNodesXPositions = node.connectedNodes.map(function (connectedNode) {
          return connectedNode.x;
        });
        // keep decrementing the x value of the node
        // unless it would have the same x value as one of its source or target nodes
        // or node.x is already 0
        while (node.x > 0 && connectedNodesXPositions.indexOf(node.x - 1) < 0) {
          node.x -= 1;
        }
      });
    });
  }

  function scaleNodeXPositions() {
    var minX = d3.min(nodes, function (node) {
      return node.x;
    }),
        maxX = d3.max(nodes, function (node) {
      return node.x;
    }) - minX;
    xScaleFactor = (size[0] - nodeWidth) / maxX;

    nodes.forEach(function (node) {
      node.x *= xScaleFactor;
    });
  }

  function computeNodeXPositions() {
    var remainingNodes = nodes,
        nextNodes,
        x = 0,
        addToNextNodes = function addToNextNodes(link) {
      if (nextNodes.indexOf(link.target) < 0 && link.target.x === this.x) {
        nextNodes.push(link.target);
      }
    },
        setValues = function setValues(node) {
      node.x = x;
      node.width = nodeWidth;
      node.sourceLinks.forEach(addToNextNodes, node);
    };

    while (remainingNodes.length) {
      nextNodes = [];
      remainingNodes.forEach(setValues);
      if (nextNodes.length) {
        remainingNodes = nextNodes;
      } else {
        remainingNodes = sourceAndTargetNodesWithSameX();
      }
      x += 1;
    }

    compressInXDirection();
    scaleNodeXPositions();
  }

  function computeLeftAndRightLinks() {
    var source, target;
    nodes.forEach(function (node) {
      node.rightLinks = [];
      node.leftLinks = [];
    });
    links.forEach(function (link) {
      source = link.source;
      target = link.target;
      if (source.x < target.x) {
        source.rightLinks.push(link);
        target.leftLinks.push(link);
        link.direction = 1;
      } else {
        source.leftLinks.push(link);
        target.rightLinks.push(link);
        link.direction = -1;
      }
    });
  }

  function adjustTop(adjustment) {
    nodes.forEach(function (node) {
      node.y -= adjustment;
    });
  }

  function computeNodeYPositions(iterations) {
    var minY,
        alpha,
        nodesByXPosition = d3.nest().key(function (node) {
      return node.x;
    }).sortKeys(d3.ascending).entries(nodes).map(function (object) {
      return object.values;
    });

    function calculateYScaleFactor() {
      var linkSpacesCount, nodeValueSum, discretionaryY;
      yScaleFactor = d3.min(nodesByXPosition, function (nodes) {
        linkSpacesCount = d3.sum(nodes, function (node) {
          return node.linkSpaceCount;
        });
        nodeValueSum = d3.sum(nodes, function (node) {
          return node.value;
        });
        discretionaryY = size[1] - (nodes.length - 1) * nodeSpacing - linkSpacesCount * linkSpacing;

        return discretionaryY / nodeValueSum;
      });

      // Fat links are those with lengths less than about 4 times their heights
      // Fat links don't bend well
      // Test that yScaleFactor is not so big that it causes "fat" links; adjust yScaleFactor accordingly
      links.forEach(function (link) {
        var linkLength = Math.abs(link.source.x - link.target.x),
            linkHeight = link.value * yScaleFactor;
        if (linkLength / linkHeight < 4) {
          yScaleFactor = 0.25 * linkLength / link.value;
        }
      });
    }

    function initializeNodeYPosition() {
      nodesByXPosition.forEach(function (nodes) {
        nodes.forEach(function (node, i) {
          node.y = i;
          node.heightAllowance = node.value * yScaleFactor + linkSpacing * node.linkSpaceCount;
        });
      });
    }

    function calculateLinkThickness() {
      links.forEach(function (link) {
        link.thickness = link.value * yScaleFactor;
      });
    }

    function relaxLeftToRight(alpha) {
      function weightedSource(link) {
        return center(link.source) * link.value;
      }

      nodesByXPosition.forEach(function (nodes) {
        nodes.forEach(function (node) {
          if (node.rightLinks.length) {
            var y = d3.sum(node.rightLinks, weightedSource) / d3.sum(node.rightLinks, value);
            node.y += (y - center(node)) * alpha;
          }
        });
      });
    }

    function relaxRightToLeft(alpha) {
      function weightedTarget(link) {
        return center(link.target) * link.value;
      }

      nodesByXPosition.slice().reverse().forEach(function (nodes) {
        nodes.forEach(function (node) {
          if (node.leftLinks.length) {
            var y = d3.sum(node.leftLinks, weightedTarget) / d3.sum(node.leftLinks, value);
            node.y += (y - center(node)) * alpha;
          }
        });
      });
    }

    function resolveCollisions() {
      function ascendingYPosition(a, b) {
        return a.y - b.y;
      }

      nodesByXPosition.forEach(function (nodes) {
        var node,
            dy,
            y0 = 0,
            n = nodes.length,
            i;

        nodes.sort(ascendingYPosition);

        // Push any overlapping nodes down.
        for (i = 0; i < n; ++i) {
          node = nodes[i];
          dy = y0 - node.y;
          if (dy > 0) {
            node.y += dy;
          }
          y0 = node.y + node.heightAllowance + nodeSpacing;
        }

        // If the bottommost node goes outside the bounds, push it back up.
        dy = y0 - nodeSpacing - size[1];
        if (dy > 0) {
          node.y -= dy;
          y0 = node.y;

          // Push any overlapping nodes back up.
          for (i = n - 2; i >= 0; --i) {
            node = nodes[i];
            dy = node.y + node.heightAllowance + nodeSpacing - y0;
            if (dy > 0) {
              node.y -= dy;
            }
            y0 = node.y;
          }
        }
      });
    }

    calculateYScaleFactor();
    initializeNodeYPosition();
    calculateLinkThickness();
    resolveCollisions();

    for (alpha = 1; iterations > 0; --iterations) {
      alpha *= 0.99;
      relaxRightToLeft(alpha);
      resolveCollisions();
      relaxLeftToRight(alpha);
      resolveCollisions();
    }

    minY = d3.min(nodes, function (node) {
      return node.y;
    });
    adjustTop(minY);
  }

  function computeLinkYPositions() {

    function ascendingLeftNodeYPosition(a, b) {
      var aLeftNode = a.direction > 0 ? a.source : a.target,
          bLeftNode = b.direction > 0 ? b.source : b.target;
      return aLeftNode.y - bLeftNode.y;
    }

    function ascendingRightNodeYPosition(a, b) {
      var aRightNode = a.direction > 0 ? a.target : a.source,
          bRightNode = b.direction > 0 ? b.target : b.source;
      return aRightNode.y - bRightNode.y;
    }

    nodes.forEach(function (node) {
      node.rightLinks.sort(ascendingRightNodeYPosition);
      node.leftLinks.sort(ascendingLeftNodeYPosition);
    });

    nodes.forEach(function (node) {
      var rightY = 0,
          leftY = 0;

      node.rightLinks.forEach(function (link) {
        if (link.direction > 0) {
          link.sourceY = rightY;
          if (link.target.state === "collapsed") {
            rightY += link.thickness + linkSpacing;
          }
        } else {
          link.targetY = rightY;
          if (link.source.state === "collapsed") {
            rightY += link.thickness + linkSpacing;
          }
        }
      });

      node.leftLinks.forEach(function (link) {
        if (link.direction < 0) {
          link.sourceY = leftY;
          if (link.target.state === "collapsed") {
            leftY += link.thickness + linkSpacing;
          }
        } else {
          link.targetY = leftY;
          if (link.source.state === "collapsed") {
            leftY += link.thickness + linkSpacing;
          }
        }
      });
    });
  }

  biHiSankey.arrowheadScaleFactor = function (_) {
    if (!arguments.length) {
      return arrowheadScaleFactor;
    }
    arrowheadScaleFactor = +_;
    return biHiSankey;
  };

  biHiSankey.collapsedNodes = function () {
    return nodes.filter(function (node) {
      return node.state === "collapsed";
    });
  };

  biHiSankey.connected = function (nodeA, nodeB) {
    return nodeA.connectedNodes.indexOf(nodeB) >= 0;
  };

  biHiSankey.expandedNodes = function () {
    return nodes.filter(function (node) {
      return node.state === "expanded";
    });
  };

  biHiSankey.layout = function (iterations) {
    computeNodeXPositions();
    computeLeftAndRightLinks();
    computeNodeValues();
    computeNodeYPositions(iterations);
    computeNodeValues();
    computeLinkYPositions();
    return biHiSankey;
  };

  biHiSankey.link = function () {
    var curvature = defaultLinkCurvature;

    function leftToRightLink(link) {
      var arrowHeadLength = link.thickness * arrowheadScaleFactor,
          straightSectionLength = 3 * link.thickness / 4 - arrowHeadLength,
          x0 = link.source.x + link.source.width,
          x1 = x0 + arrowHeadLength / 2,
          x4 = link.target.x - straightSectionLength - arrowHeadLength,
          xi = d3.interpolateNumber(x0, x4),
          x2 = xi(curvature),
          x3 = xi(1 - curvature),
          y0 = link.source.y + link.sourceY + link.thickness / 2,
          y1 = link.target.y + link.targetY + link.thickness / 2;
      return "M" + x0 + "," + y0 + "L" + x1 + "," + y0 + "C" + x2 + "," + y0 + " " + x3 + "," + y1 + " " + x4 + "," + y1 + "L" + (x4 + straightSectionLength) + "," + y1;
    }

    function rightToLeftLink(link) {
      var arrowHeadLength = link.thickness * arrowheadScaleFactor,
          straightSectionLength = link.thickness / 4,
          x0 = link.source.x,
          x1 = x0 - arrowHeadLength / 2,
          x4 = link.target.x + link.target.width + straightSectionLength + arrowHeadLength,
          xi = d3.interpolateNumber(x0, x4),
          x2 = xi(curvature),
          x3 = xi(1 - curvature),
          y0 = link.source.y + link.sourceY + link.thickness / 2,
          y1 = link.target.y + link.targetY + link.thickness / 2;
      return "M" + x0 + "," + y0 + "L" + x1 + "," + y0 + "C" + x2 + "," + y0 + " " + x3 + "," + y1 + " " + x4 + "," + y1 + "L" + (x4 - straightSectionLength) + "," + y1;
    }

    function link(d) {
      if (d.source.x < d.target.x) {
        return leftToRightLink(d);
      }
      return rightToLeftLink(d);
    }

    link.curvature = function (_) {
      if (!arguments.length) {
        return curvature;
      }
      curvature = +_;
      return link;
    };

    return link;
  };

  biHiSankey.links = function (_) {
    if (!arguments.length) {
      return links;
    }
    links = _.filter(function (link) {
      return link.source !== link.target; // filter out links that go nowhere
    });
    return biHiSankey;
  };

  biHiSankey.linkSpacing = function (_) {
    if (!arguments.length) {
      return linkSpacing;
    }
    linkSpacing = +_;
    return biHiSankey;
  };

  biHiSankey.nodes = function (_) {
    if (!arguments.length) {
      return nodes;
    }
    nodes = _;
    return biHiSankey;
  };

  biHiSankey.nodeWidth = function (_) {
    if (!arguments.length) {
      return nodeWidth;
    }
    nodeWidth = +_;
    return biHiSankey;
  };

  biHiSankey.nodeSpacing = function (_) {
    if (!arguments.length) {
      return nodeSpacing;
    }
    nodeSpacing = +_;
    return biHiSankey;
  };

  biHiSankey.relayout = function () {
    computeLeftAndRightLinks();
    computeNodeValues();
    computeLinkYPositions();
    return biHiSankey;
  };

  biHiSankey.size = function (_) {
    if (!arguments.length) {
      return size;
    }
    size = _;
    return biHiSankey;
  };

  biHiSankey.visibleLinks = function () {
    return visible(links);
  };

  biHiSankey.initializeNodes = function (callback) {
    initializeNodeMap();
    computeNodeHierarchy();
    computeNodeLinks();
    computeAncestorLinks();
    mergeLinks();
    computeConnectedNodes();
    nodes.forEach(callback);
    return biHiSankey;
  };

  return biHiSankey;
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImQzLXNhbmtleUJpLmpzIl0sIm5hbWVzIjpbImQzIiwiYmlIaVNhbmtleSIsIm5vZGVXaWR0aCIsIm5vZGVTcGFjaW5nIiwibGlua1NwYWNpbmciLCJhcnJvd2hlYWRTY2FsZUZhY3RvciIsInNpemUiLCJub2RlcyIsIm5vZGVNYXAiLCJwYXJlbnROb2RlcyIsImxlYWZOb2RlcyIsImxpbmtzIiwieFNjYWxlRmFjdG9yIiwieVNjYWxlRmFjdG9yIiwiZGVmYXVsdExpbmtDdXJ2YXR1cmUiLCJjZW50ZXIiLCJub2RlIiwieSIsImhlaWdodCIsInZhbHVlIiwibGluayIsImluaXRpYWxpemVOb2RlQXJyYXlQcm9wZXJ0aWVzIiwic291cmNlTGlua3MiLCJyaWdodExpbmtzIiwidGFyZ2V0TGlua3MiLCJsZWZ0TGlua3MiLCJjb25uZWN0ZWROb2RlcyIsImNoaWxkcmVuIiwiYW5jZXN0b3JzIiwiaW5pdGlhbGl6ZU5vZGVNYXAiLCJmb3JFYWNoIiwiaWQiLCJjb21wdXRlTGVhZk5vZGVzIiwiZmlsdGVyIiwibGVuZ3RoIiwiY29tcHV0ZVBhcmVudE5vZGVzIiwiYWRkQW5jZXN0b3JzVG9DaGlsZHJlbiIsImNoaWxkIiwiY29uY2F0IiwiY29tcHV0ZU5vZGVIaWVyYXJjaHkiLCJwYXJlbnQiLCJyb290Tm9kZXMiLCJwdXNoIiwick5vZGUiLCJjb21wdXRlTm9kZUxpbmtzIiwic291cmNlTm9kZSIsInRhcmdldE5vZGUiLCJzb3VyY2UiLCJ0YXJnZXQiLCJ2aXNpYmxlIiwibGlua0NvbGxlY3Rpb24iLCJzdGF0ZSIsImNvbXB1dGVBbmNlc3RvckxpbmtzIiwibGVhZk5vZGUiLCJzb3VyY2VMaW5rIiwiYW5jZXN0b3JUYXJnZXRzIiwiaW5kZXhPZiIsInRBbmNlc3RvciIsImFuY2VzdG9yVGFyZ2V0IiwiYW5jZXN0b3JMaW5rIiwidGFyZ2V0TGluayIsImFuY2VzdG9yU291cmNlcyIsInNBbmNlc3RvciIsImFuY2VzdG9yU291cmNlIiwicGFyZW50Tm9kZSIsIm1lcmdlTGlua3MiLCJsaW5rR3JvdXBzIiwibmVzdCIsImtleSIsImVudHJpZXMiLCJtYXAiLCJvYmplY3QiLCJ2YWx1ZXMiLCJsaW5rR3JvdXAiLCJyZWR1Y2UiLCJwcmV2aW91c0xpbmsiLCJjdXJyZW50TGluayIsIm1pbiIsIm5vZGVIZWlnaHQiLCJzaWRlTGlua3MiLCJzcGFjaW5nIiwiTWF0aCIsIm1heCIsInNjYWxlZFZhbHVlU3VtIiwic3VtIiwiY29tcHV0ZU5vZGVWYWx1ZXMiLCJuZXRGbG93IiwibGlua1NwYWNlQ291bnQiLCJjb21wdXRlQ29ubmVjdGVkTm9kZXMiLCJzb3VyY2VBbmRUYXJnZXROb2Rlc1dpdGhTYW1lWCIsIm5vZGVBcnJheSIsIngiLCJjb21wcmVzc0luWERpcmVjdGlvbiIsImNvbm5lY3RlZE5vZGVzWFBvc2l0aW9ucyIsIm5vZGVzQnlYUG9zaXRpb24iLCJzb3J0S2V5cyIsImFzY2VuZGluZyIsInhub2RlcyIsImNvbm5lY3RlZE5vZGUiLCJzY2FsZU5vZGVYUG9zaXRpb25zIiwibWluWCIsIm1heFgiLCJjb21wdXRlTm9kZVhQb3NpdGlvbnMiLCJyZW1haW5pbmdOb2RlcyIsIm5leHROb2RlcyIsImFkZFRvTmV4dE5vZGVzIiwic2V0VmFsdWVzIiwid2lkdGgiLCJjb21wdXRlTGVmdEFuZFJpZ2h0TGlua3MiLCJkaXJlY3Rpb24iLCJhZGp1c3RUb3AiLCJhZGp1c3RtZW50IiwiY29tcHV0ZU5vZGVZUG9zaXRpb25zIiwiaXRlcmF0aW9ucyIsIm1pblkiLCJhbHBoYSIsImNhbGN1bGF0ZVlTY2FsZUZhY3RvciIsImxpbmtTcGFjZXNDb3VudCIsIm5vZGVWYWx1ZVN1bSIsImRpc2NyZXRpb25hcnlZIiwibGlua0xlbmd0aCIsImFicyIsImxpbmtIZWlnaHQiLCJpbml0aWFsaXplTm9kZVlQb3NpdGlvbiIsImkiLCJoZWlnaHRBbGxvd2FuY2UiLCJjYWxjdWxhdGVMaW5rVGhpY2tuZXNzIiwidGhpY2tuZXNzIiwicmVsYXhMZWZ0VG9SaWdodCIsIndlaWdodGVkU291cmNlIiwicmVsYXhSaWdodFRvTGVmdCIsIndlaWdodGVkVGFyZ2V0Iiwic2xpY2UiLCJyZXZlcnNlIiwicmVzb2x2ZUNvbGxpc2lvbnMiLCJhc2NlbmRpbmdZUG9zaXRpb24iLCJhIiwiYiIsImR5IiwieTAiLCJuIiwic29ydCIsImNvbXB1dGVMaW5rWVBvc2l0aW9ucyIsImFzY2VuZGluZ0xlZnROb2RlWVBvc2l0aW9uIiwiYUxlZnROb2RlIiwiYkxlZnROb2RlIiwiYXNjZW5kaW5nUmlnaHROb2RlWVBvc2l0aW9uIiwiYVJpZ2h0Tm9kZSIsImJSaWdodE5vZGUiLCJyaWdodFkiLCJsZWZ0WSIsInNvdXJjZVkiLCJ0YXJnZXRZIiwiXyIsImFyZ3VtZW50cyIsImNvbGxhcHNlZE5vZGVzIiwiY29ubmVjdGVkIiwibm9kZUEiLCJub2RlQiIsImV4cGFuZGVkTm9kZXMiLCJsYXlvdXQiLCJjdXJ2YXR1cmUiLCJsZWZ0VG9SaWdodExpbmsiLCJhcnJvd0hlYWRMZW5ndGgiLCJzdHJhaWdodFNlY3Rpb25MZW5ndGgiLCJ4MCIsIngxIiwieDQiLCJ4aSIsImludGVycG9sYXRlTnVtYmVyIiwieDIiLCJ4MyIsInkxIiwicmlnaHRUb0xlZnRMaW5rIiwiZCIsInJlbGF5b3V0IiwidmlzaWJsZUxpbmtzIiwiaW5pdGlhbGl6ZU5vZGVzIiwiY2FsbGJhY2siXSwibWFwcGluZ3MiOiI7O0FBQUFBLEdBQUdDLFVBQUgsR0FBZ0IsWUFBWTs7QUFFMUIsTUFBSUEsYUFBYSxFQUFqQjtBQUFBLE1BQ0VDLFlBQVksRUFEZDtBQUFBLE1BRUVDLGNBQWMsQ0FGaEI7QUFBQSxNQUdFQyxjQUFjLENBSGhCO0FBQUEsTUFJRUMsdUJBQXVCLENBSnpCO0FBQUEsTUFJNEI7QUFDMUJDLFNBQU8sQ0FBQyxDQUFELEVBQUksQ0FBSixDQUxUO0FBQUEsTUFLaUI7QUFDZkMsVUFBUSxFQU5WO0FBQUEsTUFPRUMsVUFBVSxFQVBaO0FBQUEsTUFRRUMsY0FBYyxFQVJoQjtBQUFBLE1BU0VDLFlBQVksRUFUZDtBQUFBLE1BVUVDLFFBQVEsRUFW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UDtBQUNELEdBSkQ7O0FBTUFBLGFBQVdFLFdBQVgsR0FBeUIsVUFBVXNKLENBQVYsRUFBYTtBQUNwQyxRQUFJLENBQUNDLFVBQVV4SCxNQUFmLEVBQXVCO0FBQUUsYUFBTy9CLFdBQVA7QUFBcUI7QUFDOUNBLGtCQUFjLENBQUNzSixDQUFmO0FBQ0EsV0FBT3hKLFVBQVA7QUFDRCxHQUpEOztBQU1BQSxhQUFXOEssUUFBWCxHQUFzQixZQUFZO0FBQ2hDbkU7QUFDQXZCO0FBQ0F5RDtBQUNBLFdBQU83SSxVQUFQO0FBQ0QsR0FMRDs7QUFPQUEsYUFBV0ssSUFBWCxHQUFrQixVQUFVbUosQ0FBVixFQUFhO0FBQzdCLFFBQUksQ0FBQ0MsVUFBVXhILE1BQWYsRUFBdUI7QUFBRSxhQUFPNUIsSUFBUDtBQUFjO0FBQ3ZDQSxXQUFPbUosQ0FBUDtBQUNBLFdBQU94SixVQUFQO0FBQ0QsR0FKRDs7QUFNQUEsYUFBVytLLFlBQVgsR0FBMEIsWUFBWTtBQUNwQyxXQUFPL0gsUUFBUXRDLEtBQVIsQ0FBUDtBQUNELEdBRkQ7O0FBSUFWLGFBQVdnTCxlQUFYLEdBQTZCLFVBQVVDLFFBQVYsRUFBb0I7QUFDL0NySjtBQUNBVTtBQUNBSztBQUNBUTtBQUNBYTtBQUNBdUI7QUFDQWpGLFVBQU11QixPQUFOLENBQWNvSixRQUFkO0FBQ0EsV0FBT2pMLFVBQVA7QUFDRCxHQVREOztBQVdBLFNBQU9BLFVBQVA7QUFDRCxDQXRxQkQiLCJmaWxlIjoiZDMtc2Fua2V5QmkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJkMy5iaUhpU2Fua2V5ID0gZnVuY3Rpb24gKCkge1xuXG4gIHZhciBiaUhpU2Fua2V5ID0ge30sXG4gICAgbm9kZVdpZHRoID0gMjQsXG4gICAgbm9kZVNwYWNpbmcgPSA4LFxuICAgIGxpbmtTcGFjaW5nID0gNSxcbiAgICBhcnJvd2hlYWRTY2FsZUZhY3RvciA9IDAsIC8vIFNwZWNpZmllcyB0aGUgcHJvcG9ydGlvbiBvZiBhIGxpbmsncyBzdHJva2Ugd2lkdGggdG8gYmUgYWxsb3dlZCBmb3IgdGhlIG1hcmtlciBhdCB0aGUgZW5kIG9mIHRoZSBsaW5rLlxuICAgIHNpemUgPSBbMSwgMV0sIC8vIGRlZmF1bHQgdG8gb25lIHBpeGVsIGJ5IG9uZSBwaXhlbFxuICAgIG5vZGVzID0gW10sXG4gICAgbm9kZU1hcCA9IHt9LFxuICAgIHBhcmVudE5vZGVzID0gW10sXG4gICAgbGVhZk5vZGVzID0gW10sXG4gICAgbGlua3MgPSBbXSxcbiAgICB4U2NhbGVGYWN0b3IgPSAxLFxuICAgIHlTY2FsZUZhY3RvciA9IDEsXG4gICAgZGVmYXVsdExpbmtDdXJ2YXR1cmUgPSAwLjU7XG5cbiAgZnVuY3Rpb24gY2VudGVyKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS55ICsgbm9kZS5oZWlnaHQgLyAyO1xuICB9XG5cbiAgZnVuY3Rpb24gdmFsdWUobGluaykge1xuICAgIHJldHVybiBsaW5rLnZhbHVlO1xuICB9XG5cbiAgZnVuY3Rpb24gaW5pdGlhbGl6ZU5vZGVBcnJheVByb3BlcnRpZXMobm9kZSkge1xuICAgIG5vZGUuc291cmNlTGlua3MgPSBbXTtcbiAgICBub2RlLnJpZ2h0TGlua3MgPSBbXTtcbiAgICBub2RlLnRhcmdldExpbmtzID0gW107XG4gICAgbm9kZS5sZWZ0TGlua3MgPSBbXTtcbiAgICBub2RlLmNvbm5lY3RlZE5vZGVzID0gW107XG4gICAgbm9kZS5jaGlsZHJlbiA9IFtdO1xuICAgIG5vZGUuYW5jZXN0b3JzID0gW107XG4gIH1cbiAgLy8gZ2VuZXJhdGVzIHRoZSBub2RlTWFwIHtcIjFcIjogPG5vZGUxPiwgXCIyXCI6IDxub2RlMj59XG4gIC8vIGFuZCBpbml0aWFsaXplcyB0aGUgYXJyYXkgcHJvcGVydGllcyBvZiBlYWNoIG5vZGVcbiAgZnVuY3Rpb24gaW5pdGlhbGl6ZU5vZGVNYXAoKSB7XG4gICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgbm9kZU1hcFtub2RlLmlkXSA9IG5vZGU7XG4gICAgICBpbml0aWFsaXplTm9kZUFycmF5UHJvcGVydGllcyhub2RlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXB1dGVMZWFmTm9kZXMoKSB7XG4gICAgbGVhZk5vZGVzID0gbm9kZXMuZmlsdGVyKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICByZXR1cm4gIW5vZGUuY2hpbGRyZW4ubGVuZ3RoO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gY29tcHV0ZVBhcmVudE5vZGVzKCkge1xuICAgIHBhcmVudE5vZGVzID0gbm9kZXMuZmlsdGVyKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICByZXR1cm4gbm9kZS5jaGlsZHJlbi5sZW5ndGg7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBhZGRBbmNlc3RvcnNUb0NoaWxkcmVuKG5vZGUpIHtcbiAgICBub2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICBjaGlsZC5hbmNlc3RvcnMgPSBjaGlsZC5hbmNlc3RvcnMuY29uY2F0KHRoaXMuYW5jZXN0b3JzLmNvbmNhdChbdGhpc10pKTtcbiAgICAgIGFkZEFuY2VzdG9yc1RvQ2hpbGRyZW4oY2hpbGQpO1xuICAgIH0sIG5vZGUpO1xuICB9XG5cbiAgLy8gZ2VuZXJhdGUgaGllcmFyY2hpY2FsIGNvbm5lY3Rpb25zIGJldHdlZW4gcGFyZW50IGFuZCBjaGlsZCBub2Rlc1xuICBmdW5jdGlvbiBjb21wdXRlTm9kZUhpZXJhcmNoeSgpIHtcbiAgICB2YXIgcGFyZW50LFxuICAgICAgICByb290Tm9kZXMgPSBbXTtcblxuICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIHBhcmVudCA9IG5vZGVNYXBbbm9kZS5wYXJlbnRdO1xuICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICBub2RlLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgcGFyZW50LmNoaWxkcmVuLnB1c2gobm9kZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlLnBhcmVudCA9IG51bGw7XG4gICAgICAgIHJvb3ROb2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29tcHV0ZUxlYWZOb2RlcygpO1xuICAgIGNvbXB1dGVQYXJlbnROb2RlcygpO1xuXG4gICAgcm9vdE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKHJOb2RlKSB7XG4gICAgICBhZGRBbmNlc3RvcnNUb0NoaWxkcmVuKHJOb2RlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFBvcHVsYXRlIHRoZSBzb3VyY2VMaW5rcyBhbmQgdGFyZ2V0TGlua3MgZm9yIGVhY2ggbm9kZS5cbiAgZnVuY3Rpb24gY29tcHV0ZU5vZGVMaW5rcygpIHtcbiAgICB2YXIgc291cmNlTm9kZSwgdGFyZ2V0Tm9kZTtcbiAgICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICBzb3VyY2VOb2RlID0gbm9kZU1hcFtsaW5rLnNvdXJjZV0gfHwgbGluay5zb3VyY2U7XG4gICAgICB0YXJnZXROb2RlID0gbm9kZU1hcFtsaW5rLnRhcmdldF0gfHwgbGluay50YXJnZXQ7XG4gICAgICBsaW5rLmlkID0gbGluay5zb3VyY2UgKyAnLScgKyBsaW5rLnRhcmdldDtcbiAgICAgIGxpbmsuc291cmNlID0gc291cmNlTm9kZTtcbiAgICAgIGxpbmsudGFyZ2V0ID0gdGFyZ2V0Tm9kZTtcbiAgICAgIHNvdXJjZU5vZGUuc291cmNlTGlua3MucHVzaChsaW5rKTtcbiAgICAgIHRhcmdldE5vZGUudGFyZ2V0TGlua3MucHVzaChsaW5rKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHZpc2libGUobGlua0NvbGxlY3Rpb24pIHtcbiAgICByZXR1cm4gbGlua0NvbGxlY3Rpb24uZmlsdGVyKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICByZXR1cm4gbGluay5zb3VyY2Uuc3RhdGUgPT09IFwiY29sbGFwc2VkXCIgJiYgbGluay50YXJnZXQuc3RhdGUgPT09IFwiY29sbGFwc2VkXCI7XG4gICAgfSk7XG4gIH1cblxuICAvLyBXaGVuIGNoaWxkIG5vZGVzIGFyZSBjb2xsYXBzZWQgaW50byB0aGVpciBwYXJlbnRzIChvciBoaWdoZXIgYW5jZXN0b3JzKVxuICAvLyB0aGUgbGlua3MgYmV0d2VlbiB0aGUgY2hpbGQgbm9kZXMgc2hvdWxkIGJlIHJlcHJlc2VudGVkIGJ5IGxpbmtzXG4gIC8vIGJldHdlZW4gdGhlIGNvbnRhaW5pbmcgYW5jZXN0b3JzLiBUaGlzIGZ1bmN0aW9uIGFkZHMgdGhvc2UgZXh0cmEgbGlua3MuXG4gIGZ1bmN0aW9uIGNvbXB1dGVBbmNlc3RvckxpbmtzKCkge1xuICAgIC8vIExlYWYgbm9kZXMgYXJlIG5ldmVyIHBhcmVudHMgb2Ygb3RoZXIgbm9kZXNcbiAgICAvLyBEdXBsaWNhdGUgc291cmNlIGFuZCB0YXJnZXQgbGlua3MgYmV0d2VlbiBhIGxlYWYgbm9kZSBhbmQgYW5vdGhlciBsZWFmIG5vZGVcbiAgICAvLyBhbmQgYWRkIHRvIHRoZSBsZWFmIG5vZGVzJyBwYXJlbnRzXG4gICAgbGVhZk5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGxlYWZOb2RlKSB7XG4gICAgICBsZWFmTm9kZS5zb3VyY2VMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2VMaW5rKSB7XG4gICAgICAgIHZhciBhbmNlc3RvclRhcmdldHMsXG4gICAgICAgIHRhcmdldCA9IHNvdXJjZUxpbmsudGFyZ2V0O1xuICAgICAgICBpZiAobGVhZk5vZGVzLmluZGV4T2YodGFyZ2V0KSA+PSAwKSB7XG4gICAgICAgICAgYW5jZXN0b3JUYXJnZXRzID0gdGFyZ2V0LmFuY2VzdG9ycy5maWx0ZXIoZnVuY3Rpb24gKHRBbmNlc3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIGxlYWZOb2RlLmFuY2VzdG9ycy5pbmRleE9mKHRBbmNlc3RvcikgPCAwO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFuY2VzdG9yVGFyZ2V0cy5mb3JFYWNoKGZ1bmN0aW9uIChhbmNlc3RvclRhcmdldCkge1xuICAgICAgICAgICAgdmFyIGFuY2VzdG9yTGluayA9IHsgc291cmNlOiBsZWFmTm9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmNlc3RvclRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNvdXJjZUxpbmsudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBsZWFmTm9kZS5pZCArIFwiLVwiICsgYW5jZXN0b3JUYXJnZXQuaWQgfTtcblxuICAgICAgICAgICAgbGVhZk5vZGUuc291cmNlTGlua3MucHVzaChhbmNlc3RvckxpbmspO1xuICAgICAgICAgICAgYW5jZXN0b3JUYXJnZXQudGFyZ2V0TGlua3MucHVzaChhbmNlc3RvckxpbmspO1xuICAgICAgICAgICAgbGlua3MucHVzaChhbmNlc3RvckxpbmspO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgbGVhZk5vZGUudGFyZ2V0TGlua3MuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0TGluaykge1xuICAgICAgICB2YXIgYW5jZXN0b3JTb3VyY2VzLCBzb3VyY2UgPSB0YXJnZXRMaW5rLnNvdXJjZTtcbiAgICAgICAgaWYgKGxlYWZOb2Rlcy5pbmRleE9mKHNvdXJjZSkgPj0gMCkge1xuICAgICAgICAgIGFuY2VzdG9yU291cmNlcyA9IHNvdXJjZS5hbmNlc3RvcnMuZmlsdGVyKGZ1bmN0aW9uIChzQW5jZXN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBsZWFmTm9kZS5hbmNlc3RvcnMuaW5kZXhPZihzQW5jZXN0b3IpIDwgMDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhbmNlc3RvclNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoYW5jZXN0b3JTb3VyY2UpIHtcbiAgICAgICAgICAgIHZhciBhbmNlc3RvckxpbmsgPSB7IHNvdXJjZTogYW5jZXN0b3JTb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogbGVhZk5vZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0YXJnZXRMaW5rLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogYW5jZXN0b3JTb3VyY2UuaWQgKyBcIi1cIiArIGxlYWZOb2RlLmlkIH07XG4gICAgICAgICAgICBhbmNlc3RvclNvdXJjZS5zb3VyY2VMaW5rcy5wdXNoKGFuY2VzdG9yTGluayk7XG4gICAgICAgICAgICBsZWFmTm9kZS50YXJnZXRMaW5rcy5wdXNoKGFuY2VzdG9yTGluayk7XG4gICAgICAgICAgICBsaW5rcy5wdXNoKGFuY2VzdG9yTGluayk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gQWRkIGxpbmtzIGJldHdlZW4gcGFyZW50cyAoZm9yIHdoZW4gYm90aCBwYXJlbnRzIGFyZSBpbiBjb2xsYXBzZWQgc3RhdGUpXG4gICAgcGFyZW50Tm9kZXMuZm9yRWFjaChmdW5jdGlvbiAocGFyZW50Tm9kZSkge1xuICAgICAgcGFyZW50Tm9kZS5zb3VyY2VMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2VMaW5rKSB7XG4gICAgICAgIHZhciBhbmNlc3RvclRhcmdldHMsIHRhcmdldCA9IHNvdXJjZUxpbmsudGFyZ2V0O1xuICAgICAgICBpZiAobGVhZk5vZGVzLmluZGV4T2YodGFyZ2V0KSA+PSAwKSB7XG4gICAgICAgICAgYW5jZXN0b3JUYXJnZXRzID0gdGFyZ2V0LmFuY2VzdG9ycy5maWx0ZXIoZnVuY3Rpb24gKHRBbmNlc3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIHBhcmVudE5vZGUuYW5jZXN0b3JzLmluZGV4T2YodEFuY2VzdG9yKSA8IDA7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYW5jZXN0b3JUYXJnZXRzLmZvckVhY2goZnVuY3Rpb24gKGFuY2VzdG9yVGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgYW5jZXN0b3JMaW5rID0geyBzb3VyY2U6IHBhcmVudE5vZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogYW5jZXN0b3JUYXJnZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzb3VyY2VMaW5rLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcGFyZW50Tm9kZS5pZCArIFwiLVwiICsgYW5jZXN0b3JUYXJnZXQuaWQgfTtcblxuICAgICAgICAgICAgcGFyZW50Tm9kZS5zb3VyY2VMaW5rcy5wdXNoKGFuY2VzdG9yTGluayk7XG4gICAgICAgICAgICBhbmNlc3RvclRhcmdldC50YXJnZXRMaW5rcy5wdXNoKGFuY2VzdG9yTGluayk7XG4gICAgICAgICAgICBsaW5rcy5wdXNoKGFuY2VzdG9yTGluayk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gVG8gcmVkdWNlIGNsdXR0ZXIgaW4gdGhlIGRpYWdyYW0gbWVyZ2UgbGlua3MgdGhhdCBhcmUgZnJvbSB0aGVcbiAgLy8gc2FtZSBzb3VyY2UgdG8gdGhlIHNhbWUgdGFyZ2V0IGJ5IGNyZWF0aW5nIGEgbmV3IGxpbmtcbiAgLy8gd2l0aCBhIHZhbHVlIGVxdWFsIHRvIHRoZSBzdW0gb2YgdGhlIHZhbHVlcyBvZiB0aGUgbWVyZ2VkIGxpbmtzXG4gIGZ1bmN0aW9uIG1lcmdlTGlua3MoKSB7XG4gICAgdmFyIGxpbmtHcm91cHMgPSBkMy5uZXN0KClcbiAgICAgIC5rZXkoZnVuY3Rpb24gKGxpbmspIHsgcmV0dXJuIGxpbmsuc291cmNlLmlkICsgXCItPlwiICsgbGluay50YXJnZXQuaWQ7IH0pXG4gICAgICAuZW50cmllcyhsaW5rcylcbiAgICAgIC5tYXAoZnVuY3Rpb24gKG9iamVjdCkgeyByZXR1cm4gb2JqZWN0LnZhbHVlczsgfSk7XG5cbiAgICBsaW5rcyA9IGxpbmtHcm91cHMubWFwKGZ1bmN0aW9uIChsaW5rR3JvdXApIHtcbiAgICAgIHJldHVybiBsaW5rR3JvdXAucmVkdWNlKGZ1bmN0aW9uIChwcmV2aW91c0xpbmssIGN1cnJlbnRMaW5rKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgXCJzb3VyY2VcIjogcHJldmlvdXNMaW5rLnNvdXJjZSxcbiAgICAgICAgICBcInRhcmdldFwiOiBwcmV2aW91c0xpbmsudGFyZ2V0LFxuICAgICAgICAgIFwiaWRcIjogZDMubWluKFtwcmV2aW91c0xpbmsuaWQsIGN1cnJlbnRMaW5rLmlkXSksXG4gICAgICAgICAgXCJ2YWx1ZVwiOiBwcmV2aW91c0xpbmsudmFsdWUgKyBjdXJyZW50TGluay52YWx1ZVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBub2RlSGVpZ2h0KHNpZGVMaW5rcykge1xuICAgIHZhciBzcGFjaW5nID0gTWF0aC5tYXgoc2lkZUxpbmtzLmxlbmd0aCAtIDEsIDApICogbGlua1NwYWNpbmcsXG4gICAgICAgIHNjYWxlZFZhbHVlU3VtID0gZDMuc3VtKHNpZGVMaW5rcywgdmFsdWUpICogeVNjYWxlRmFjdG9yO1xuICAgIHJldHVybiBzY2FsZWRWYWx1ZVN1bSArIHNwYWNpbmc7XG4gIH1cblxuICAvLyBDb21wdXRlIHRoZSB2YWx1ZSBvZiBlYWNoIG5vZGUgYnkgc3VtbWluZyB0aGUgYXNzb2NpYXRlZCBsaW5rcy5cbiAgLy8gQ29tcHV0ZSB0aGUgbnVtYmVyIG9mIHNwYWNlcyBiZXR3ZWVuIHRoZSBsaW5rc1xuICAvLyBDb21wdXRlIHRoZSBudW1iZXIgb2Ygc291cmNlIGxpbmtzIGZvciBsYXRlciBkZWNyZW1lbnRpbmdcbiAgZnVuY3Rpb24gY29tcHV0ZU5vZGVWYWx1ZXMoKSB7XG4gICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgbm9kZS52YWx1ZSA9IE1hdGgubWF4KFxuICAgICAgICBkMy5zdW0obm9kZS5sZWZ0TGlua3MsIHZhbHVlKSxcbiAgICAgICAgZDMuc3VtKG5vZGUucmlnaHRMaW5rcywgdmFsdWUpXG4gICAgICApO1xuICAgICAgbm9kZS5uZXRGbG93ID0gZDMuc3VtKHZpc2libGUobm9kZS50YXJnZXRMaW5rcyksIHZhbHVlKSAtIGQzLnN1bSh2aXNpYmxlKG5vZGUuc291cmNlTGlua3MpLCB2YWx1ZSk7XG4gICAgICBub2RlLmhlaWdodCA9IE1hdGgubWF4KG5vZGVIZWlnaHQodmlzaWJsZShub2RlLmxlZnRMaW5rcykpLCBub2RlSGVpZ2h0KHZpc2libGUobm9kZS5yaWdodExpbmtzKSkpO1xuICAgICAgbm9kZS5saW5rU3BhY2VDb3VudCA9IE1hdGgubWF4KE1hdGgubWF4KG5vZGUubGVmdExpbmtzLmxlbmd0aCwgbm9kZS5yaWdodExpbmtzLmxlbmd0aCkgLSAxLCAwKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXB1dGVDb25uZWN0ZWROb2RlcygpIHtcbiAgICB2YXIgc291cmNlTm9kZSwgdGFyZ2V0Tm9kZTtcbiAgICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICBzb3VyY2VOb2RlID0gbGluay5zb3VyY2U7XG4gICAgICB0YXJnZXROb2RlID0gbGluay50YXJnZXQ7XG4gICAgICBpZiAoc291cmNlTm9kZS5jb25uZWN0ZWROb2Rlcy5pbmRleE9mKHRhcmdldE5vZGUpIDwgMCkge1xuICAgICAgICBzb3VyY2VOb2RlLmNvbm5lY3RlZE5vZGVzLnB1c2godGFyZ2V0Tm9kZSk7XG4gICAgICB9XG4gICAgICBpZiAodGFyZ2V0Tm9kZS5jb25uZWN0ZWROb2Rlcy5pbmRleE9mKHNvdXJjZU5vZGUpIDwgMCkge1xuICAgICAgICB0YXJnZXROb2RlLmNvbm5lY3RlZE5vZGVzLnB1c2goc291cmNlTm9kZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBzb3VyY2VBbmRUYXJnZXROb2Rlc1dpdGhTYW1lWCgpIHtcbiAgICB2YXIgbm9kZUFycmF5ID0gW107XG4gICAgbGlua3MuZmlsdGVyKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICByZXR1cm4gbGluay50YXJnZXQueCA9PT0gbGluay5zb3VyY2UueDtcbiAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICBpZiAobm9kZUFycmF5LmluZGV4T2YobGluay50YXJnZXQpIDwgMCkge1xuICAgICAgICBub2RlQXJyYXkucHVzaChsaW5rLnRhcmdldCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG5vZGVBcnJheTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXByZXNzSW5YRGlyZWN0aW9uKCkge1xuICAgIHZhciBjb25uZWN0ZWROb2Rlc1hQb3NpdGlvbnMsXG4gICAgICAgIG5vZGVzQnlYUG9zaXRpb24gPSBkMy5uZXN0KClcbiAgICAgICAgICAua2V5KGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLng7IH0pXG4gICAgICAgICAgLnNvcnRLZXlzKGQzLmFzY2VuZGluZylcbiAgICAgICAgICAuZW50cmllcyhub2RlcylcbiAgICAgICAgICAubWFwKGZ1bmN0aW9uIChvYmplY3QpIHsgcmV0dXJuIG9iamVjdC52YWx1ZXM7IH0pO1xuXG4gICAgbm9kZXNCeVhQb3NpdGlvbi5mb3JFYWNoKGZ1bmN0aW9uICh4bm9kZXMpIHtcbiAgICAgIHhub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIGNvbm5lY3RlZE5vZGVzWFBvc2l0aW9ucyA9IG5vZGUuY29ubmVjdGVkTm9kZXMubWFwKGZ1bmN0aW9uIChjb25uZWN0ZWROb2RlKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbm5lY3RlZE5vZGUueDtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGtlZXAgZGVjcmVtZW50aW5nIHRoZSB4IHZhbHVlIG9mIHRoZSBub2RlXG4gICAgICAgIC8vIHVubGVzcyBpdCB3b3VsZCBoYXZlIHRoZSBzYW1lIHggdmFsdWUgYXMgb25lIG9mIGl0cyBzb3VyY2Ugb3IgdGFyZ2V0IG5vZGVzXG4gICAgICAgIC8vIG9yIG5vZGUueCBpcyBhbHJlYWR5IDBcbiAgICAgICAgd2hpbGUgKG5vZGUueCA+IDAgJiYgY29ubmVjdGVkTm9kZXNYUG9zaXRpb25zLmluZGV4T2Yobm9kZS54IC0gMSkgPCAwKSB7XG4gICAgICAgICAgbm9kZS54IC09IDE7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2NhbGVOb2RlWFBvc2l0aW9ucygpIHtcbiAgICB2YXIgbWluWCA9IGQzLm1pbihub2RlcywgZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUueDsgfSksXG4gICAgICAgIG1heFggPSBkMy5tYXgobm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLng7IH0pIC0gbWluWDtcbiAgICB4U2NhbGVGYWN0b3IgPSAoc2l6ZVswXSAtIG5vZGVXaWR0aCkgLyBtYXhYO1xuXG4gICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgbm9kZS54ICo9IHhTY2FsZUZhY3RvcjtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXB1dGVOb2RlWFBvc2l0aW9ucygpIHtcbiAgICB2YXIgcmVtYWluaW5nTm9kZXMgPSBub2RlcyxcbiAgICAgICAgbmV4dE5vZGVzLFxuICAgICAgICB4ID0gMCxcbiAgICAgICAgYWRkVG9OZXh0Tm9kZXMgPSBmdW5jdGlvbiAobGluaykge1xuICAgICAgICAgIGlmIChuZXh0Tm9kZXMuaW5kZXhPZihsaW5rLnRhcmdldCkgPCAwICYmIGxpbmsudGFyZ2V0LnggPT09IHRoaXMueCkge1xuICAgICAgICAgICAgbmV4dE5vZGVzLnB1c2gobGluay50YXJnZXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc2V0VmFsdWVzID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICBub2RlLnggPSB4O1xuICAgICAgICAgIG5vZGUud2lkdGggPSBub2RlV2lkdGg7XG4gICAgICAgICAgbm9kZS5zb3VyY2VMaW5rcy5mb3JFYWNoKGFkZFRvTmV4dE5vZGVzLCBub2RlKTtcbiAgICAgICAgfTtcblxuICAgIHdoaWxlIChyZW1haW5pbmdOb2Rlcy5sZW5ndGgpIHtcbiAgICAgIG5leHROb2RlcyA9IFtdO1xuICAgICAgcmVtYWluaW5nTm9kZXMuZm9yRWFjaChzZXRWYWx1ZXMpO1xuICAgICAgaWYgKG5leHROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgcmVtYWluaW5nTm9kZXMgPSBuZXh0Tm9kZXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZW1haW5pbmdOb2RlcyA9IHNvdXJjZUFuZFRhcmdldE5vZGVzV2l0aFNhbWVYKCk7XG4gICAgICB9XG4gICAgICB4ICs9IDE7XG4gICAgfVxuXG4gICAgY29tcHJlc3NJblhEaXJlY3Rpb24oKTtcbiAgICBzY2FsZU5vZGVYUG9zaXRpb25zKCk7XG4gIH1cblxuICBmdW5jdGlvbiBjb21wdXRlTGVmdEFuZFJpZ2h0TGlua3MoKSB7XG4gICAgdmFyIHNvdXJjZSwgdGFyZ2V0O1xuICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIG5vZGUucmlnaHRMaW5rcyA9IFtdO1xuICAgICAgbm9kZS5sZWZ0TGlua3MgPSBbXTtcbiAgICB9KTtcbiAgICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICBzb3VyY2UgPSBsaW5rLnNvdXJjZTtcbiAgICAgIHRhcmdldCA9IGxpbmsudGFyZ2V0O1xuICAgICAgaWYgKHNvdXJjZS54IDwgdGFyZ2V0LngpIHtcbiAgICAgICAgc291cmNlLnJpZ2h0TGlua3MucHVzaChsaW5rKTtcbiAgICAgICAgdGFyZ2V0LmxlZnRMaW5rcy5wdXNoKGxpbmspO1xuICAgICAgICBsaW5rLmRpcmVjdGlvbiA9IDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzb3VyY2UubGVmdExpbmtzLnB1c2gobGluayk7XG4gICAgICAgIHRhcmdldC5yaWdodExpbmtzLnB1c2gobGluayk7XG4gICAgICAgIGxpbmsuZGlyZWN0aW9uID0gLTE7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBhZGp1c3RUb3AoYWRqdXN0bWVudCkge1xuICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIG5vZGUueSAtPSBhZGp1c3RtZW50O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gY29tcHV0ZU5vZGVZUG9zaXRpb25zKGl0ZXJhdGlvbnMpIHtcbiAgICB2YXIgbWluWSxcbiAgICAgICAgYWxwaGEsXG4gICAgICAgIG5vZGVzQnlYUG9zaXRpb24gPSBkMy5uZXN0KClcbiAgICAgICAgICAua2V5KGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLng7IH0pXG4gICAgICAgICAgLnNvcnRLZXlzKGQzLmFzY2VuZGluZylcbiAgICAgICAgICAuZW50cmllcyhub2RlcylcbiAgICAgICAgICAubWFwKGZ1bmN0aW9uIChvYmplY3QpIHsgcmV0dXJuIG9iamVjdC52YWx1ZXM7IH0pO1xuXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlWVNjYWxlRmFjdG9yKCkge1xuICAgICAgdmFyIGxpbmtTcGFjZXNDb3VudCwgbm9kZVZhbHVlU3VtLCBkaXNjcmV0aW9uYXJ5WTtcbiAgICAgIHlTY2FsZUZhY3RvciA9IGQzLm1pbihub2Rlc0J5WFBvc2l0aW9uLCBmdW5jdGlvbiAobm9kZXMpIHtcbiAgICAgICAgbGlua1NwYWNlc0NvdW50ID0gZDMuc3VtKG5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgIHJldHVybiBub2RlLmxpbmtTcGFjZUNvdW50O1xuICAgICAgICB9KTtcbiAgICAgICAgbm9kZVZhbHVlU3VtID0gZDMuc3VtKG5vZGVzLCBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgIHJldHVybiBub2RlLnZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgZGlzY3JldGlvbmFyeVkgPSAoc2l6ZVsxXVxuICAgICAgICAgICAgICAgICAgICAgICAgLSAobm9kZXMubGVuZ3RoIC0gMSkgKiBub2RlU3BhY2luZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLSBsaW5rU3BhY2VzQ291bnQgKiBsaW5rU3BhY2luZyk7XG5cbiAgICAgICAgcmV0dXJuICBkaXNjcmV0aW9uYXJ5WSAvIG5vZGVWYWx1ZVN1bTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGYXQgbGlua3MgYXJlIHRob3NlIHdpdGggbGVuZ3RocyBsZXNzIHRoYW4gYWJvdXQgNCB0aW1lcyB0aGVpciBoZWlnaHRzXG4gICAgICAvLyBGYXQgbGlua3MgZG9uJ3QgYmVuZCB3ZWxsXG4gICAgICAvLyBUZXN0IHRoYXQgeVNjYWxlRmFjdG9yIGlzIG5vdCBzbyBiaWcgdGhhdCBpdCBjYXVzZXMgXCJmYXRcIiBsaW5rczsgYWRqdXN0IHlTY2FsZUZhY3RvciBhY2NvcmRpbmdseVxuICAgICAgbGlua3MuZm9yRWFjaChmdW5jdGlvbiAobGluaykge1xuICAgICAgICB2YXIgbGlua0xlbmd0aCA9IE1hdGguYWJzKGxpbmsuc291cmNlLnggLSBsaW5rLnRhcmdldC54KSxcbiAgICAgICAgICAgIGxpbmtIZWlnaHQgPSBsaW5rLnZhbHVlICogeVNjYWxlRmFjdG9yO1xuICAgICAgICBpZiAobGlua0xlbmd0aCAvIGxpbmtIZWlnaHQgPCA0KSB7XG4gICAgICAgICAgeVNjYWxlRmFjdG9yID0gMC4yNSAqIGxpbmtMZW5ndGggLyBsaW5rLnZhbHVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0aWFsaXplTm9kZVlQb3NpdGlvbigpIHtcbiAgICAgIG5vZGVzQnlYUG9zaXRpb24uZm9yRWFjaChmdW5jdGlvbiAobm9kZXMpIHtcbiAgICAgICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSwgaSkge1xuICAgICAgICAgIG5vZGUueSA9IGk7XG4gICAgICAgICAgbm9kZS5oZWlnaHRBbGxvd2FuY2UgPSBub2RlLnZhbHVlICogeVNjYWxlRmFjdG9yICsgbGlua1NwYWNpbmcgKiBub2RlLmxpbmtTcGFjZUNvdW50O1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUxpbmtUaGlja25lc3MoKSB7XG4gICAgICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgIGxpbmsudGhpY2tuZXNzID0gbGluay52YWx1ZSAqIHlTY2FsZUZhY3RvcjtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbGF4TGVmdFRvUmlnaHQoYWxwaGEpIHtcbiAgICAgIGZ1bmN0aW9uIHdlaWdodGVkU291cmNlKGxpbmspIHtcbiAgICAgICAgcmV0dXJuIGNlbnRlcihsaW5rLnNvdXJjZSkgKiBsaW5rLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICBub2Rlc0J5WFBvc2l0aW9uLmZvckVhY2goZnVuY3Rpb24gKG5vZGVzKSB7XG4gICAgICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICBpZiAobm9kZS5yaWdodExpbmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIHkgPSBkMy5zdW0obm9kZS5yaWdodExpbmtzLCB3ZWlnaHRlZFNvdXJjZSkgLyBkMy5zdW0obm9kZS5yaWdodExpbmtzLCB2YWx1ZSk7XG4gICAgICAgICAgICBub2RlLnkgKz0gKHkgLSBjZW50ZXIobm9kZSkpICogYWxwaGE7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbGF4UmlnaHRUb0xlZnQoYWxwaGEpIHtcbiAgICAgIGZ1bmN0aW9uIHdlaWdodGVkVGFyZ2V0KGxpbmspIHtcbiAgICAgICAgcmV0dXJuIGNlbnRlcihsaW5rLnRhcmdldCkgKiBsaW5rLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICBub2Rlc0J5WFBvc2l0aW9uLnNsaWNlKCkucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24gKG5vZGVzKSB7XG4gICAgICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICBpZiAobm9kZS5sZWZ0TGlua3MubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgeSA9IGQzLnN1bShub2RlLmxlZnRMaW5rcywgd2VpZ2h0ZWRUYXJnZXQpIC8gZDMuc3VtKG5vZGUubGVmdExpbmtzLCB2YWx1ZSk7XG4gICAgICAgICAgICBub2RlLnkgKz0gKHkgLSBjZW50ZXIobm9kZSkpICogYWxwaGE7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc29sdmVDb2xsaXNpb25zKCkge1xuICAgICAgZnVuY3Rpb24gYXNjZW5kaW5nWVBvc2l0aW9uKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEueSAtIGIueTtcbiAgICAgIH1cblxuICAgICAgbm9kZXNCeVhQb3NpdGlvbi5mb3JFYWNoKGZ1bmN0aW9uIChub2Rlcykge1xuICAgICAgICB2YXIgbm9kZSxcbiAgICAgICAgICAgIGR5LFxuICAgICAgICAgICAgeTAgPSAwLFxuICAgICAgICAgICAgbiA9IG5vZGVzLmxlbmd0aCxcbiAgICAgICAgICAgIGk7XG5cbiAgICAgICAgbm9kZXMuc29ydChhc2NlbmRpbmdZUG9zaXRpb24pO1xuXG4gICAgICAgIC8vIFB1c2ggYW55IG92ZXJsYXBwaW5nIG5vZGVzIGRvd24uXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgICAgICBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgZHkgPSB5MCAtIG5vZGUueTtcbiAgICAgICAgICBpZiAoZHkgPiAwKSB7XG4gICAgICAgICAgICBub2RlLnkgKz0gZHk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHkwID0gbm9kZS55ICsgbm9kZS5oZWlnaHRBbGxvd2FuY2UgKyBub2RlU3BhY2luZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRoZSBib3R0b21tb3N0IG5vZGUgZ29lcyBvdXRzaWRlIHRoZSBib3VuZHMsIHB1c2ggaXQgYmFjayB1cC5cbiAgICAgICAgZHkgPSB5MCAtIG5vZGVTcGFjaW5nIC0gc2l6ZVsxXTtcbiAgICAgICAgaWYgKGR5ID4gMCkge1xuICAgICAgICAgIG5vZGUueSAtPSBkeTtcbiAgICAgICAgICB5MCA9IG5vZGUueTtcblxuICAgICAgICAgIC8vIFB1c2ggYW55IG92ZXJsYXBwaW5nIG5vZGVzIGJhY2sgdXAuXG4gICAgICAgICAgZm9yIChpID0gbiAtIDI7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgICAgICBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgICBkeSA9IG5vZGUueSArIG5vZGUuaGVpZ2h0QWxsb3dhbmNlICsgbm9kZVNwYWNpbmcgLSB5MDtcbiAgICAgICAgICAgIGlmIChkeSA+IDApIHtcbiAgICAgICAgICAgICAgbm9kZS55IC09IGR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeTAgPSBub2RlLnk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjYWxjdWxhdGVZU2NhbGVGYWN0b3IoKTtcbiAgICBpbml0aWFsaXplTm9kZVlQb3NpdGlvbigpO1xuICAgIGNhbGN1bGF0ZUxpbmtUaGlja25lc3MoKTtcbiAgICByZXNvbHZlQ29sbGlzaW9ucygpO1xuXG4gICAgZm9yIChhbHBoYSA9IDE7IGl0ZXJhdGlvbnMgPiAwOyAtLWl0ZXJhdGlvbnMpIHtcbiAgICAgIGFscGhhICo9IDAuOTk7XG4gICAgICByZWxheFJpZ2h0VG9MZWZ0KGFscGhhKTtcbiAgICAgIHJlc29sdmVDb2xsaXNpb25zKCk7XG4gICAgICByZWxheExlZnRUb1JpZ2h0KGFscGhhKTtcbiAgICAgIHJlc29sdmVDb2xsaXNpb25zKCk7XG4gICAgfVxuXG4gICAgbWluWSA9IGQzLm1pbihub2RlcywgZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUueTsgfSk7XG4gICAgYWRqdXN0VG9wKG1pblkpO1xuICB9XG5cbiAgZnVuY3Rpb24gY29tcHV0ZUxpbmtZUG9zaXRpb25zKCkge1xuXG4gICAgZnVuY3Rpb24gYXNjZW5kaW5nTGVmdE5vZGVZUG9zaXRpb24oYSwgYikge1xuICAgICAgdmFyIGFMZWZ0Tm9kZSA9IChhLmRpcmVjdGlvbiA+IDApID8gYS5zb3VyY2UgOiBhLnRhcmdldCxcbiAgICAgICAgICBiTGVmdE5vZGUgPSAoYi5kaXJlY3Rpb24gPiAwKSA/IGIuc291cmNlIDogYi50YXJnZXQ7XG4gICAgICByZXR1cm4gYUxlZnROb2RlLnkgLSBiTGVmdE5vZGUueTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhc2NlbmRpbmdSaWdodE5vZGVZUG9zaXRpb24oYSwgYikge1xuICAgICAgdmFyIGFSaWdodE5vZGUgPSAoYS5kaXJlY3Rpb24gPiAwKSA/IGEudGFyZ2V0IDogYS5zb3VyY2UsXG4gICAgICAgICAgYlJpZ2h0Tm9kZSA9IChiLmRpcmVjdGlvbiA+IDApID8gYi50YXJnZXQgOiBiLnNvdXJjZTtcbiAgICAgIHJldHVybiBhUmlnaHROb2RlLnkgLSBiUmlnaHROb2RlLnk7XG4gICAgfVxuXG4gICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgbm9kZS5yaWdodExpbmtzLnNvcnQoYXNjZW5kaW5nUmlnaHROb2RlWVBvc2l0aW9uKTtcbiAgICAgIG5vZGUubGVmdExpbmtzLnNvcnQoYXNjZW5kaW5nTGVmdE5vZGVZUG9zaXRpb24pO1xuICAgIH0pO1xuXG4gICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgdmFyIHJpZ2h0WSA9IDAsIGxlZnRZID0gMDtcblxuICAgICAgbm9kZS5yaWdodExpbmtzLmZvckVhY2goZnVuY3Rpb24gKGxpbmspIHtcbiAgICAgICAgaWYgKGxpbmsuZGlyZWN0aW9uID4gMCkge1xuICAgICAgICAgIGxpbmsuc291cmNlWSA9IHJpZ2h0WTtcbiAgICAgICAgICBpZiAobGluay50YXJnZXQuc3RhdGUgPT09IFwiY29sbGFwc2VkXCIpIHtcbiAgICAgICAgICAgIHJpZ2h0WSArPSBsaW5rLnRoaWNrbmVzcyArIGxpbmtTcGFjaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBsaW5rLnRhcmdldFkgPSByaWdodFk7XG4gICAgICAgICAgaWYgKGxpbmsuc291cmNlLnN0YXRlID09PSBcImNvbGxhcHNlZFwiKSB7XG4gICAgICAgICAgICByaWdodFkgKz0gbGluay50aGlja25lc3MgKyBsaW5rU3BhY2luZztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBub2RlLmxlZnRMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgIGlmIChsaW5rLmRpcmVjdGlvbiA8IDApIHtcbiAgICAgICAgICBsaW5rLnNvdXJjZVkgPSBsZWZ0WTtcbiAgICAgICAgICBpZiAobGluay50YXJnZXQuc3RhdGUgPT09IFwiY29sbGFwc2VkXCIpIHtcbiAgICAgICAgICAgIGxlZnRZICs9IGxpbmsudGhpY2tuZXNzICsgbGlua1NwYWNpbmc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGxpbmsudGFyZ2V0WSA9IGxlZnRZO1xuICAgICAgICAgIGlmIChsaW5rLnNvdXJjZS5zdGF0ZSA9PT0gXCJjb2xsYXBzZWRcIikge1xuICAgICAgICAgICAgbGVmdFkgKz0gbGluay50aGlja25lc3MgKyBsaW5rU3BhY2luZztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgfSk7XG4gIH1cblxuXG4gIGJpSGlTYW5rZXkuYXJyb3doZWFkU2NhbGVGYWN0b3IgPSBmdW5jdGlvbiAoXykge1xuICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgeyByZXR1cm4gYXJyb3doZWFkU2NhbGVGYWN0b3I7IH1cbiAgICBhcnJvd2hlYWRTY2FsZUZhY3RvciA9ICtfO1xuICAgIHJldHVybiBiaUhpU2Fua2V5O1xuICB9O1xuXG4gIGJpSGlTYW5rZXkuY29sbGFwc2VkTm9kZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5vZGVzLmZpbHRlcihmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gbm9kZS5zdGF0ZSA9PT0gXCJjb2xsYXBzZWRcIjsgfSk7XG4gIH07XG5cbiAgYmlIaVNhbmtleS5jb25uZWN0ZWQgPSBmdW5jdGlvbiAobm9kZUEsIG5vZGVCKSB7XG4gICAgcmV0dXJuIG5vZGVBLmNvbm5lY3RlZE5vZGVzLmluZGV4T2Yobm9kZUIpID49IDA7XG4gIH07XG5cbiAgYmlIaVNhbmtleS5leHBhbmRlZE5vZGVzID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBub2Rlcy5maWx0ZXIoZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUuc3RhdGUgPT09IFwiZXhwYW5kZWRcIjsgfSk7XG4gIH07XG5cbiAgYmlIaVNhbmtleS5sYXlvdXQgPSBmdW5jdGlvbiAoaXRlcmF0aW9ucykge1xuICAgIGNvbXB1dGVOb2RlWFBvc2l0aW9ucygpO1xuICAgIGNvbXB1dGVMZWZ0QW5kUmlnaHRMaW5rcygpO1xuICAgIGNvbXB1dGVOb2RlVmFsdWVzKCk7XG4gICAgY29tcHV0ZU5vZGVZUG9zaXRpb25zKGl0ZXJhdGlvbnMpO1xuICAgIGNvbXB1dGVOb2RlVmFsdWVzKCk7XG4gICAgY29tcHV0ZUxpbmtZUG9zaXRpb25zKCk7XG4gICAgcmV0dXJuIGJpSGlTYW5rZXk7XG4gIH07XG5cbiAgYmlIaVNhbmtleS5saW5rID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdXJ2YXR1cmUgPSBkZWZhdWx0TGlua0N1cnZhdHVyZTtcblxuICAgIGZ1bmN0aW9uIGxlZnRUb1JpZ2h0TGluayhsaW5rKSB7XG4gICAgICB2YXIgYXJyb3dIZWFkTGVuZ3RoID0gbGluay50aGlja25lc3MgKiBhcnJvd2hlYWRTY2FsZUZhY3RvcixcbiAgICAgICAgICBzdHJhaWdodFNlY3Rpb25MZW5ndGggPSAoMyAqIGxpbmsudGhpY2tuZXNzIC8gNCkgLSBhcnJvd0hlYWRMZW5ndGgsXG4gICAgICAgICAgeDAgPSBsaW5rLnNvdXJjZS54ICsgbGluay5zb3VyY2Uud2lkdGgsXG4gICAgICAgICAgeDEgPSB4MCArIGFycm93SGVhZExlbmd0aCAvIDIsXG4gICAgICAgICAgeDQgPSBsaW5rLnRhcmdldC54IC0gc3RyYWlnaHRTZWN0aW9uTGVuZ3RoIC0gYXJyb3dIZWFkTGVuZ3RoLFxuICAgICAgICAgIHhpID0gZDMuaW50ZXJwb2xhdGVOdW1iZXIoeDAsIHg0KSxcbiAgICAgICAgICB4MiA9IHhpKGN1cnZhdHVyZSksXG4gICAgICAgICAgeDMgPSB4aSgxIC0gY3VydmF0dXJlKSxcbiAgICAgICAgICB5MCA9IGxpbmsuc291cmNlLnkgKyBsaW5rLnNvdXJjZVkgKyBsaW5rLnRoaWNrbmVzcyAvIDIsXG4gICAgICAgICAgeTEgPSBsaW5rLnRhcmdldC55ICsgbGluay50YXJnZXRZICsgbGluay50aGlja25lc3MgLyAyO1xuICAgICAgcmV0dXJuIFwiTVwiICsgeDAgKyBcIixcIiArIHkwXG4gICAgICAgICAgICsgXCJMXCIgKyB4MSArIFwiLFwiICsgeTBcbiAgICAgICAgICAgKyBcIkNcIiArIHgyICsgXCIsXCIgKyB5MFxuICAgICAgICAgICArIFwiIFwiICsgeDMgKyBcIixcIiArIHkxXG4gICAgICAgICAgICsgXCIgXCIgKyB4NCArIFwiLFwiICsgeTFcbiAgICAgICAgICAgKyBcIkxcIiArICh4NCArIHN0cmFpZ2h0U2VjdGlvbkxlbmd0aCkgKyBcIixcIiArIHkxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJpZ2h0VG9MZWZ0TGluayhsaW5rKSB7XG4gICAgICB2YXIgYXJyb3dIZWFkTGVuZ3RoID0gbGluay50aGlja25lc3MgKiBhcnJvd2hlYWRTY2FsZUZhY3RvcixcbiAgICAgICAgICBzdHJhaWdodFNlY3Rpb25MZW5ndGggPSBsaW5rLnRoaWNrbmVzcyAvIDQsXG4gICAgICAgICAgeDAgPSBsaW5rLnNvdXJjZS54LFxuICAgICAgICAgIHgxID0geDAgLSBhcnJvd0hlYWRMZW5ndGggLyAyLFxuICAgICAgICAgIHg0ID0gbGluay50YXJnZXQueCArIGxpbmsudGFyZ2V0LndpZHRoICsgc3RyYWlnaHRTZWN0aW9uTGVuZ3RoICsgYXJyb3dIZWFkTGVuZ3RoLFxuICAgICAgICAgIHhpID0gZDMuaW50ZXJwb2xhdGVOdW1iZXIoeDAsIHg0KSxcbiAgICAgICAgICB4MiA9IHhpKGN1cnZhdHVyZSksXG4gICAgICAgICAgeDMgPSB4aSgxIC0gY3VydmF0dXJlKSxcbiAgICAgICAgICB5MCA9IGxpbmsuc291cmNlLnkgKyBsaW5rLnNvdXJjZVkgKyBsaW5rLnRoaWNrbmVzcyAvIDIsXG4gICAgICAgICAgeTEgPSBsaW5rLnRhcmdldC55ICsgbGluay50YXJnZXRZICsgbGluay50aGlja25lc3MgLyAyO1xuICAgICAgcmV0dXJuIFwiTVwiICsgeDAgKyBcIixcIiArIHkwXG4gICAgICAgICAgICsgXCJMXCIgKyB4MSArIFwiLFwiICsgeTBcbiAgICAgICAgICAgKyBcIkNcIiArIHgyICsgXCIsXCIgKyB5MFxuICAgICAgICAgICArIFwiIFwiICsgeDMgKyBcIixcIiArIHkxXG4gICAgICAgICAgICsgXCIgXCIgKyB4NCArIFwiLFwiICsgeTFcbiAgICAgICAgICAgKyBcIkxcIiArICh4NCAtIHN0cmFpZ2h0U2VjdGlvbkxlbmd0aCkgKyBcIixcIiArIHkxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpbmsoZCkge1xuICAgICAgaWYgKGQuc291cmNlLnggPCBkLnRhcmdldC54KSB7XG4gICAgICAgIHJldHVybiBsZWZ0VG9SaWdodExpbmsoZCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmlnaHRUb0xlZnRMaW5rKGQpO1xuICAgIH1cblxuICAgIGxpbmsuY3VydmF0dXJlID0gZnVuY3Rpb24gKF8pIHtcbiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgeyByZXR1cm4gY3VydmF0dXJlOyB9XG4gICAgICBjdXJ2YXR1cmUgPSArXztcbiAgICAgIHJldHVybiBsaW5rO1xuICAgIH07XG5cbiAgICByZXR1cm4gbGluaztcbiAgfTtcblxuICBiaUhpU2Fua2V5LmxpbmtzID0gZnVuY3Rpb24gKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsgcmV0dXJuIGxpbmtzOyB9XG4gICAgbGlua3MgPSBfLmZpbHRlcihmdW5jdGlvbiAobGluaykge1xuICAgICAgcmV0dXJuIGxpbmsuc291cmNlICE9PSBsaW5rLnRhcmdldDsgLy8gZmlsdGVyIG91dCBsaW5rcyB0aGF0IGdvIG5vd2hlcmVcbiAgICB9KTtcbiAgICByZXR1cm4gYmlIaVNhbmtleTtcbiAgfTtcblxuICBiaUhpU2Fua2V5LmxpbmtTcGFjaW5nID0gZnVuY3Rpb24gKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsgcmV0dXJuIGxpbmtTcGFjaW5nOyB9XG4gICAgbGlua1NwYWNpbmcgPSArXztcbiAgICByZXR1cm4gYmlIaVNhbmtleTtcbiAgfTtcblxuICBiaUhpU2Fua2V5Lm5vZGVzID0gZnVuY3Rpb24gKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsgcmV0dXJuIG5vZGVzOyB9XG4gICAgbm9kZXMgPSBfO1xuICAgIHJldHVybiBiaUhpU2Fua2V5O1xuICB9O1xuXG4gIGJpSGlTYW5rZXkubm9kZVdpZHRoID0gZnVuY3Rpb24gKF8pIHtcbiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsgcmV0dXJuIG5vZGVXaWR0aDsgfVxuICAgIG5vZGVXaWR0aCA9ICtfO1xuICAgIHJldHVybiBiaUhpU2Fua2V5O1xuICB9O1xuXG4gIGJpSGlTYW5rZXkubm9kZVNwYWNpbmcgPSBmdW5jdGlvbiAoXykge1xuICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgeyByZXR1cm4gbm9kZVNwYWNpbmc7IH1cbiAgICBub2RlU3BhY2luZyA9ICtfO1xuICAgIHJldHVybiBiaUhpU2Fua2V5O1xuICB9O1xuXG4gIGJpSGlTYW5rZXkucmVsYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29tcHV0ZUxlZnRBbmRSaWdodExpbmtzKCk7XG4gICAgY29tcHV0ZU5vZGVWYWx1ZXMoKTtcbiAgICBjb21wdXRlTGlua1lQb3NpdGlvbnMoKTtcbiAgICByZXR1cm4gYmlIaVNhbmtleTtcbiAgfTtcblxuICBiaUhpU2Fua2V5LnNpemUgPSBmdW5jdGlvbiAoXykge1xuICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgeyByZXR1cm4gc2l6ZTsgfVxuICAgIHNpemUgPSBfO1xuICAgIHJldHVybiBiaUhpU2Fua2V5O1xuICB9O1xuXG4gIGJpSGlTYW5rZXkudmlzaWJsZUxpbmtzID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB2aXNpYmxlKGxpbmtzKTtcbiAgfTtcblxuICBiaUhpU2Fua2V5LmluaXRpYWxpemVOb2RlcyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGluaXRpYWxpemVOb2RlTWFwKCk7XG4gICAgY29tcHV0ZU5vZGVIaWVyYXJjaHkoKTtcbiAgICBjb21wdXRlTm9kZUxpbmtzKCk7XG4gICAgY29tcHV0ZUFuY2VzdG9yTGlua3MoKTtcbiAgICBtZXJnZUxpbmtzKCk7XG4gICAgY29tcHV0ZUNvbm5lY3RlZE5vZGVzKCk7XG4gICAgbm9kZXMuZm9yRWFjaChjYWxsYmFjayk7XG4gICAgcmV0dXJuIGJpSGlTYW5rZXk7XG4gIH07XG5cbiAgcmV0dXJuIGJpSGlTYW5rZXk7XG59O1xuIl19
